//@version=5
indicator("Chande Momentum Oscillator, RSI and Histogram by leo", overlay=false,format=format.price, precision=2, timeframe="", timeframe_gaps=true)

// Input parameters
shortLength = input.int(5, title="Short Length")
longLength = input.int(13, title="Long Length")
signalLength = input.int(9, title="Signal Length")

// Calculate RSI values
RSIshort = ta.rsi(close, shortLength)
RSIlong = ta.rsi(close, longLength)

// Calculate additional values
value = RSIshort - RSIlong
signal = ta.sma(value, signalLength)
totalRSI = RSIshort + RSIlong
histogram = totalRSI > 100 ? totalRSI - 100 : totalRSI - 100

// Plot lines and histogram
plot(value, title="Value Line", color=#2195f300)
plot(signal, title="Signal Line", color=(signal > signal[1] ? #2195f300 : #ff525200))
plot(histogram, title="Histogram", color=(totalRSI > 100 ? color.green : totalRSI <= 100 ? color.red : color.gray), style=plot.style_histogram, linewidth=3)

//indicator(title="Chande Momentum Oscillator", shorttitle="ChandeMO", format=format.price, precision=2, timeframe="", timeframe_gaps=true)
length = input.int(10, minval=1)
src = input(close, "Source")
momm = ta.change(src)
f1(m) => m >= 0.0 ? m : 0.0
f2(m) => m >= 0.0 ? 0.0 : -m
m1 = f1(momm)
m2 = f2(momm)
sm1 = math.sum(m1, length)
sm2 = math.sum(m2, length)
percent(nom, div) => 100 * nom / div
chandeMO = percent(sm1-sm2, sm1+sm2)
plot(chandeMO, "Chande MO", color=#2962FF, linewidth = 2)
hline(0, color=#787B86, linestyle=hline.style_dashed, title="Zero Line")