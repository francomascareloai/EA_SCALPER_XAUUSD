# Simple Expert Advisor based on WPR, Bollinger Bands and ATR indicators - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/63916

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/63916) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Simple Expert Advisor based on WPR, Bollinger Bands and ATR indicators - expert for MetaTrader 5

[Artyom Trishkin](/en/users/artmedia70)  |
[English](javascript:void(false);)

[Русский](/ru/code/63916) [中文](/zh/code/63916) [Español](/es/code/63916) [Deutsch](/de/code/63916) [日本語](/ja/code/63916) [Português](/pt/code/63916) [한국어](/ko/code/63916) [Français](/fr/code/63916) [Italiano](/it/code/63916) [Türkçe](/tr/code/63916)

Views:
:   3321

Rating:
:   (8)

Published:
:   21 October 2025, 13:02
:   [ExpWPRBB.mq5](/en/code/download/63916/ExpWPRBB.mq5 "ExpWPRBB.mq5")
    (78.38 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/63916.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

ExpWPRBB Expert Advisor implements a simple trading strategy based on the signals of two indicators: Williams' Percent Range (WPR) and Bollinger Bands (BB). A position is opened only when the signals of both indicators coincide:

* **Buy**: WPR exits the oversold zone and the bar opening price is below the average BB line.
* **Sell**: WPR is coming out of the overbought zone and the bar opening price is above the average BB line.

The width of Bollinger Bands and ATR value are used to calculate Stop Loss and Take Profit levels. The Expert Advisor supports work only on hedging accounts. Additionally, it has a non-trading mode, where you can only put signal labels - to control signals in the visual mode of the strategy tester.

**Input parameters:**

**WPR (Williams' Percent Range)**

* **InpPeriodWPR** - WPR calculation period. Number of bars for calculating the indicator value;
* **InpOverboughtWPR** - WPR overbought level. The value above which it is considered that the market is overbought (usually from -20 to 0);
* **InpOversoldWPR** - WPR oversold level. The value below which the market is considered oversold (usually from -80 to -100).

**BB (Bollinger Bands)**

* **InpPeriodBB** - Bollinger Bands calculation period. The number of bars for calculating the bands;
* **InpDeviationBB** - Deviation of Bollinger Bands. Standard deviation multiplier for calculating the width of the bands;
* **InpShiftBB** - Bollinger Bands**Shift** . Indicator shift relative to the current bar;
* **InpPriceBB** - Bollinger Bands calculation price. Type of price used for calculation.

**ATR (Average True Range)**

* **InpPeriodATR** - ATR calculation period. The number of bars for calculating the average true range.

**Trading**

* **InpSignalsOnly** - Do not trade, only set signal labels. If true, the Expert Advisor does not open trades, but only displays signals on the chart;
* **InpVolume** - Position volume. Lot size for opening a deal;
* **InpDeviation** - Slippage (in points). Maximum allowable price deviation when executing an order;
* **InpMagic** - Magic number. A unique identifier of EA positions for tracking them;
* **InpStopLoss** - Stop loss (in points). Stop loss level. 0 - is not set, -1 - is calculated as half of the Bollinger Bands width;
* **InpTakeProfit** - Take profit (in pips). Take Profit level. 0 - not set, -1 - calculated by ATR value;
* **InpSLMltp** - Multiplier of Stop loss size, if Stop loss == -1. Allows increasing or decreasing the automatically calculated Stop Loss;
* **InpTPMltp** - Multiplier of Take profit size, if Take profit == -1. Allows increasing or decreasing the automatically calculated Take Profit.

The default values for the input parameters of the Expert Advisor are optimised for testing on the H4 chart period.

Test result in "All ticks" mode for the last year on H4 with default parameters:

![](https://c.mql5.com/18/168/terminal64_OHFPbVn67p.png)

![](https://c.mql5.com/18/168/terminal64_syA438nTxF.png)

![](https://c.mql5.com/18/168/terminal64_g8IaeWGklH.png)

![](https://c.mql5.com/18/168/terminal64_CRsCkTHXQk.png)

![](https://c.mql5.com/18/168/terminal64_xrLSvNUtsr.png)

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/63916](/ru/code/63916)

![Bollinger Bands Squeeze](https://c.mql5.com/i/code/indicator.png)
[Bollinger Bands Squeeze](/en/code/65117)

It signals a period of low market volatility that is about to end, foreshadowing a significant price move.

![ConvertServerTime](https://c.mql5.com/i/code/library.png)
[ConvertServerTime](/en/code/65102)

Function to convert server time from one broker's time zone to another.

![ExpPinBar - Expert Advisor for Pin Bar Price Action patterns](https://c.mql5.com/i/code/expert.png)
[ExpPinBar - Expert Advisor for Pin Bar Price Action patterns](/en/code/63971)

Expert Advisor based on iPinBar Pin Bar Finder + several different trailing indicators

![ATR without iATR() with smoothing Wilder by William210.mq5](https://c.mql5.com/i/code/indicator.png)
[ATR without iATR() with smoothing Wilder by William210.mq5](/en/code/50547)

The goal is to show a code that shows the calculation of the ATR with Wilder smoothing