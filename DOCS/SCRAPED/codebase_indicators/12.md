# Average True Range (ATR) - indicator for MetaTrader 5

Source: https://www.mql5.com/en/code/12

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/12) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# Average True Range (ATR) - indicator for MetaTrader 5

[MetaQuotes](/en/users/metaquotes)  |
[English](javascript:void(false);)

[Русский](/ru/code/12) [中文](/zh/code/12) [Español](/es/code/12) [Deutsch](/de/code/12) [日本語](/ja/code/12) [Português](/pt/code/12) [한국어](/ko/code/12) [Français](/fr/code/12) [Italiano](/it/code/12) [Türkçe](/tr/code/12)

Views:
:   37889

Rating:
:   (57)

Published:
:   8 January 2010, 14:17

Updated:
:   22 November 2016, 07:32
:   [atr.mq5](/en/code/download/12/atr.mq5 "atr.mq5")
    (3.86 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/12.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

[Average True Range](https://www.metatrader5.com/en/terminal/help/indicators/oscillators/atr "https://www.metatrader5.com/en/terminal/help/indicators/oscillators/atr") (ATR) is a technical indicator that shows market volatility.

It was introduced by Welles Wilder in his book ["New concepts in technical trading systems"](/go?link=https://www.amazon.com/New-Concepts-Technical-Trading-Systems/dp/0894590278 "http://www.amazon.com/New-Concepts-Technical-Trading-Systems/dp/0894590278"). This indicator has been used as a component of numerous other indicators and trading systems ever since.

Average True Range can often reach a high value at the bottom of the market after a sheer fall in prices occasioned by panic selling. Low values of the indicator are typical for the periods of sideways movement of long duration which happen at the top of the market and during consolidation.

Average True Range can be interpreted according to the same principles as other volatility indicators. The principle of forecasting based on this indicator can be worded the following way: the higher the value of the indicator, the higher the probability of a trend change; the lower the indicator’s value, the weaker the trend’s movement is.

![](https://c.mql5.com/18/0/atr.png "Average True Range")

**Calculation:**

True Range is the greatest of the following three values:

* Difference between the current maximum and minimum (high and low);
* Difference between the previous closing price and the current maximum;
* Difference between the previous closing price and the current minimum.

The indicator of Average True Range is a [moving average](https://www.metatrader5.com/en/terminal/help/indicators/trend_indicators/ma "https://www.metatrader5.com/en/terminal/help/indicators/trend_indicators/ma") of values of the true range.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/12](/ru/code/12)

**Last comments |
[Go to discussion](/en/forum/213)**
(10)

![TheXpert](https://c.mql5.com/avatar/2016/7/5783C6E7-AEEE.png "TheXpert")

**[TheXpert](/en/users/thexpert)**
|
9 Feb 2013 at 20:36

**Hekler:**  
 Well each indicator has its own scale, how do I align the scale of these indicators, in order to first of all visually determine the position of the indicator? That is, I want the location of the indicators to correspond to their values. Is this possible?

Write an indicator that combines two ATRs, or fix the scale, i.e. set the same minimums maximums for both indicators.

![Hekler](https://c.mql5.com/avatar/avatar_na2.png "Hekler")

**[Hekler](/en/users/hekler)**
|
9 Feb 2013 at 21:24

**TheXpert:**  
 Write an indicator that combines the two ATRs, or fix the scale, ie set the same minimums maximums for both indicators.

Yes, thank you very much.

![Sergey Golubev](https://c.mql5.com/avatar/2012/12/50D09349-3D90.jpg "Sergey Golubev")

**[Sergey Golubev](/en/users/newdigital)**
|
29 Aug 2013 at 09:18

[Average True Range (ATR) Technical Indicator](/go?link=http://www.tradeforextrading.com/index.php/atr-technical-indicator "http://www.tradeforextrading.com/index.php/atr-technical-indicator")

![CipherPips](https://c.mql5.com/avatar/avatar_na2.png "CipherPips")

**[CipherPips](/en/users/cipherpips)**
|
9 Feb 2016 at 15:35

I'm in the process of building an Expert Adviser.  This has brought me to this ATR indicator so that I can verify the iATR() results.

Much to my surprise, the results were sometimes 50, sometimes more than 250 basis points off.

Has anyone else experienced this?

CipherPips

![](https://c.mql5.com/avatar/avatar_na2.png)

**[Deleted]**
|
12 Dec 2016 at 20:36

The  loop seems to work without this line ExtATRBuffer[i]=0.0; of the code.

//--- first AtrPeriod values of the indicator are not calculated  
      double firstValue=0.0;  
      for(i=1;i<=ExtPeriodATR;i++)  
        {  
         ExtATRBuffer[i]=0.0;  
         firstValue+=ExtTRBuffer[i];  
        }  
      //--- calculating the first value of the indicator

  
![Chart USDJPY, M5, 2016.12.12 19:37 UTC, MetaQuotes Software Corp., MetaTrader 5, Demo](https://charts.mql5.com/13/446/usdjpy-m5-metaquotes-software-corp.png "Chart USDJPY, M5, 2016.12.12 19:37 UTC, MetaQuotes Software Corp., MetaTrader 5, Demo")

![Accumulation Swing Index (ASI)](https://c.mql5.com/i/code/indicator.png)
[Accumulation Swing Index (ASI)](/en/code/11)

ASI was created by Wales Wilder as an ordinary fluctuations indicator that gets signals from previous maximums and minimums of price.

![Adaptive Moving Average (AMA)](https://c.mql5.com/i/code/indicator.png)
[Adaptive Moving Average (AMA)](/en/code/10)

The Adaptive Moving Average Indicator is used for constructing a moving average with low sensitivity to price series noises and is characterized by the minimal lag for trend detection.

![Awesome Oscillator (AO)](https://c.mql5.com/i/code/indicator.png)
[Awesome Oscillator (AO)](/en/code/13)

Bill Williams's Awesome Oscillator Indicator (AO) is a 34-period simple moving average, plotted through the middle points of the bars (H+L)/2, which is subtracted from the 5-period simple moving average, built across the central points of the bars (H+L)/2. It shows us quite clearly what’s happening to the market driving force at the present moment.

![Plombiers - oscillator in the channel.](https://c.mql5.com/i/code/indicator.png)
[Plombiers - oscillator in the channel.](/en/code/64)

Sometimes this is useful - to observe the behavior of the oscillator in the channel. Greatly simplifies the evaluation of the situation.