# Stochastic Oscillator - indicator for MetaTrader 4

Source: https://www.mql5.com/en/code/7792

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/7792) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# Stochastic Oscillator - indicator for MetaTrader 4

[MetaQuotes](/en/users/metaquotes)  |
[English](javascript:void(false);)

[Русский](/ru/code/7792) [中文](/zh/code/7792) [Español](/es/code/7792) [Deutsch](/de/code/7792) [日本語](/ja/code/7792) [Português](/pt/code/7792) [한국어](/ko/code/7792) [Français](/fr/code/7792) [Italiano](/it/code/7792) [Türkçe](/tr/code/7792)

Views:
:   56308

Rating:
:   (19)

Published:
:   29 November 2005, 11:55

Updated:
:   22 November 2016, 07:32
:   [Stochastic.mq4](/en/code/download/7792/stochastic.mq4 "Stochastic.mq4")
    (5.04 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/7792.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The Stochastic Oscillator Technical Indicator compares where a security’s price closed relative to its price range over a given time period.

The Stochastic Oscillator is displayed as two lines. The main line is called %K. The second line, called %D, is a Moving Average of %K. The %K line is usually displayed as a solid line and the %D line is usually displayed as a dotted line.

There are several ways to interpret a Stochastic Oscillator. Three popular methods include:

* Buy when the Oscillator (either %K or %D) falls below a specific level (e.g., 20) and then rises above that level. Sell when the Oscillator rises above a specific level (e.g., 80) and then falls below that level;
* Buy when the %K line rises above the %D line and sell when the %K line falls below the %D line;
* Look for divergences. For instance: where prices are making a series of new highs and the Stochastic Oscillator is failing to surpass its previous highs.

**Calculation**

The Stochastic Oscillator has three variables:

* %K periods (Pk). This is the number of time periods used in %K calculation. By default is 5;
* %K Slowing Periods (Sk). This value controls the internal smoothing of %K. A value of 1 is considered a fast stochastic; a value of 3 is considered a slow stochastic. By default is 3;
* %D periods (Pd). This is the number of time periods used when calculating a moving average of %K. By default is 3;

    The formula for %K is:

%K = 100\*SUM (CLOSE - MIN (LOW, Pk), Sk) / SUM (MAX (HIGH, Pk) - MIN (LOW, Pk)), Sk)

Where:

* CLOSE — is today’s closing price;
* MIN (LOW, Pk) — is the lowest low in Pk periods;
* MAX (HIGH, Pk) — is the highest high in Pk periods;
* SUM (CLOSE - MIN (LOW, Pk), Sk) — amount composed CLOSE - MIN (LOW, Pk) for period Sk;
* SUM (MAX (HIGH, Pk) - MIN (LOW, Pk)), Sk) — amount composed HIGH (Pk)) - MIN (LOW, Pk) for period Sk.

The %D moving average is calculated according to the formula:

%D = SMA (%K, Pd)

where:

* Pd — is the smoothing period for %K;
* SMA — is the Simple Moving Average.

![Stochastic Oscillator](https://c.mql5.com/18/31/stochastic.png "Stochastic Oscillator")

**Technical Indicator Description**

Full description of Stochastic is available in the [Technical analysis: Stochastic Oscillator](https://www.metatrader5.com/en/terminal/help/indicators/oscillators/so)

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/7792](/ru/code/7792)

**Last comments |
[Go to discussion](/en/forum/24811)**
(3)

![](https://c.mql5.com/avatar/avatar_na2.png)

**[Deleted]**
|
5 Apr 2007 at 01:25

how does one smooth this like the dfault one in mt4 and how does one have it calculate
from ... (H+L+O+C)/4 ... ?

![Fab](https://c.mql5.com/avatar/avatar_na2.png "Fab")

**[Fab](/en/users/bit4life)**
|
9 Sep 2016 at 14:25

Sorry,

but is the definition of slow %K not the SMA(Sk) of (fast) %K? (see f.i.: http://stockcharts.com/school/doku.php?id=chart\_school:technical\_indicators:stochastic\_oscillator\_fast\_slow\_and\_full).

Now, the SMA over Sk periods of %K is SUM(%K1, %K2, ... %KSk) / Sk. Given for instance a Sk of 3 and a Pk of three (just to make the example short) this will be ((Close[0] - Min[0]) / (Max[0] - Min[0]) + (Close[1] - Min[1]) / (Max[1] - Min[1]) + (Close[3] - Min[3]) / (Max[3] - Min[3])) / 3.

If we want to simplify let's call

(Close[0] - Min[0]) = x

(Close[1] - Min[1]) = y

(Close[2] - Min[2]) = z

and

(Max[0] - Min[0]) = a

(Max[1] - Min[1]) = b

(Max[2] - Min[2]) = c.

Then the smoothing of %K through the SMA would be: 1/3 \* (x/a + y/b + z/c) [§1].

It is surely NOT SUM (CLOSE - MIN (LOW, Pk), Sk) / SUM (MAX (HIGH, Pk) - MIN (LOW, Pk)), Sk)

In fact, using the formalism of above, this smoothing is:

(x + y + z) / (a + b + c) [§2].

If I am not wrong, [§1] = [§2] just in the particular case that a = b = c. Isn't it?

The difference in the two ways of smoothing is subtle, because the Lowest Low and the Highest High are calculated along a sliding window, and therefore the likelihood of being in the particular case (i.e. identical results for the two smoothing forms) is quite high. But, if you compare the MetaTrader [stochastic](https://www.metatrader5.com/en/terminal/help/indicators/oscillators/so "MetaTrader 5 Help: Stochastic Oscillator Indicator") with other platforms (or another algorithm in mql) then the differences can be seen.

Nice to hear criticisms and comments...

![Tom Sasson](https://c.mql5.com/avatar/avatar_na2.png "Tom Sasson")

**[Tom Sasson](/en/users/fridayda13)**
|
14 Nov 2017 at 19:59

The %D moving average is calculated according to the formula:

%D = SMA (%K, Pd)

where:

* Pd — is the smoothing period for %K;
* SMA — is the Simple Moving Average.

-----------------------------------------------------------------------

Where are the smoothing parameters in the code?

This indicator does not [function](https://www.mql5.com/en/docs/constants/namedconstants/compilemacros "MQL5 documentation: Predefined Macrosubstitutions") as the default one in MT4, and it has less parameters.

![Relative Strength Index (RSI)](https://c.mql5.com/i/code/indicator.png)
[Relative Strength Index (RSI)](/en/code/7898)

The Relative Strength Index (RSI) technical indicator is a price-following oscillator that ranges between 0 and 100.

![Parabolic SAR, Parabolic](https://c.mql5.com/i/code/indicator.png)
[Parabolic SAR, Parabolic](/en/code/7892)

Parabolic SAR Indicator was developed for analyzing the trending markets.

![ZigZag](https://c.mql5.com/i/code/indicator.png)
[ZigZag](/en/code/7796)

ZigZag indicator tracks and connects extreme points of the chart, the distance between these points.

![Close](https://c.mql5.com/i/code/script.png)
[Close](/en/code/7913)

Close - script closing first market order if it is first in the list.