# Intrabar Volume Flow - indicator for MetaTrader 5

Source: https://www.mql5.com/en/code/55923

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/55923) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# Intrabar Volume Flow - indicator for MetaTrader 5

[Conor Mcnamara](/en/users/phade)  |
[English](javascript:void(false);)

[Русский](/ru/code/55923) [中文](/zh/code/55923) [Español](/es/code/55923) [Deutsch](/de/code/55923) [日本語](/ja/code/55923) [Português](/pt/code/55923) [한국어](/ko/code/55923) [Français](/fr/code/55923) [Italiano](/it/code/55923) [Türkçe](/tr/code/55923)

Views:
:   5507

Rating:
:   (2)

Published:
:   11 February 2025, 12:19

Updated:
:   11 February 2025, 13:33
:   [Intrabar Volume.mq5](/en/code/download/55923/intrabar_volume.mq5 "Intrabar Volume.mq5")
    (7.35 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/55923.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

It's possible to plot incoming volume rather than simply plotting a single volume histogram bar to describe volume in the bar.

Instead of just showing total volume per bar like a standard volume indicator, this indicator plots how volume evolves tick by tick.

This indicator therefore provides a real-time view of volume pressure. If a bar has high tick activity, the histogram will show an increasing trend and amplify in size.If the market has weaker volume, the histogram will reveal weaker peaks.

This creates a linear progression of tick volume in tick time, to visualize volume accumulating for a single bar in a different way.

It can be useful for:

Detecting sudden volume surges in real time.

Tracking microstructural changes in the market.

Understanding volume build-up during a bar's formation.

Spotting absorption or exhaustion (if volume spikes but price doesn't move much).

[![Intrabar volume](https://c.mql5.com/18/159/incoming_volume__1.PNG "Intrabar volume")](https://c.mql5.com/18/159/incoming_volume.PNG "https://c.mql5.com/18/159/incoming_volume.PNG")

**Last comments |
[Go to discussion](/en/forum/481267)**
(1)

![Conor Mcnamara](https://c.mql5.com/avatar/2025/9/68dab3ec-4506.png "Conor Mcnamara")

**[Conor Mcnamara](/en/users/phade)**
|
11 Feb 2025 at 14:47

I also coded a series version

the code styling is the "Mozilla" choice in MetaEditor

```mql5
#property indicator_separate_window
#property indicator_buffers 5
#property indicator_plots 1

#property indicator_color1 clrGreen, clrRed
#property indicator_type1 DRAW_COLOR_HISTOGRAM

double plot[];
double col[];
double incomingVolume[];
double ma[];
double closes[];

input bool grannularTrend = false; // Grannular trend

int period = 20;

//+------------------------------------------------------------------+
//| Custom indicator initialization function                         |
//+------------------------------------------------------------------+
int OnInit()
{
//--- indicator buffers mapping
  SetIndexBuffer(0, plot, INDICATOR_DATA);
  SetIndexBuffer(1, col,  INDICATOR_COLOR_INDEX);
  SetIndexBuffer(2, ma, INDICATOR_CALCULATIONS);
  SetIndexBuffer(3, incomingVolume, INDICATOR_CALCULATIONS);
  SetIndexBuffer(4, closes, INDICATOR_CALCULATIONS);

  ArraySetAsSeries(plot, true);
  ArraySetAsSeries(col, true);
  ArraySetAsSeries(ma, true);
  ArraySetAsSeries(incomingVolume, true);
  ArraySetAsSeries(closes, true);


  return(INIT_SUCCEEDED);
}

//+------------------------------------------------------------------+
//| Custom indicator iteration function                              |
//+------------------------------------------------------------------+
int OnCalculate(const int rates_total,
                const int prev_calculated,
                const datetime &time[],
                const double &open[],
                const double &high[],
                const double &low[],
                const double &close[],
                const long &tick_volume[],
                const long &volume[],
                const int &spread[])
{
  ArraySetAsSeries(close, false);
  ArrayCopy(incomingVolume, tick_volume, 0, rates_total-1);

  ArrayCopy(closes, close, 0, rates_total-1);

  int buffSize = ArraySize(incomingVolume);

  ArraySetAsSeries(close, true);

  if(prev_calculated == 0) { initialzeBuffers();
  }
  
  long volumeThreshold = 0;
  long sum = 0;

  for (int j = 0; j < period; j++) sum += tick_volume[j];
  volumeThreshold = sum / 20;

  int empty_data = rates_total - buffSize;


  for(int i = buffSize-1; i>=empty_data; i--) {
    plot[i] = incomingVolume[i];
    trend(period, i, ma, closes);

    if (i < buffSize - 1) {
      if (!grannularTrend) {
        col[i] = ma[0] > ma[1] ? 0 : 1;
      } else {
        col[i] = (ma[i] > ma[i+1]) ? 0 : 1;
      }
    }

  }
  for(int i = buffSize-2; i>=0; i--) {

    closes[i+1] = closes[i];
    incomingVolume[i+1] = incomingVolume[i];
  }


  return buffSize;
}

void initialzeBuffers(){

  ArrayInitialize(plot, EMPTY_VALUE); 
  ArrayInitialize(col, EMPTY_VALUE); 
  ArrayInitialize(ma, EMPTY_VALUE); 
  ArrayInitialize(incomingVolume, EMPTY_VALUE); 
  ArrayInitialize(closes, EMPTY_VALUE);
}

void trend(int per, int idx, double &arr[], const double &close[])
{
  double sum = 0.0;
  for(int k = 1; k < per && (idx + k) < ArraySize(close); k++) {
    sum += close[idx + k];
  }
  arr[idx] = sum / per;
}
```

![Calendar-Based Backtesting: an Event-Driven Trading EA](https://c.mql5.com/i/code/library.png)
[Calendar-Based Backtesting: an Event-Driven Trading EA](/en/code/55630)

This Script & EA enables coders to backtest their news based strategies which use the MQL5 Calendar.

![Smart Trend Follower](https://c.mql5.com/i/code/expert.png)
[Smart Trend Follower](/en/code/53022)

This EA is designed to automatically follow market trends using signals from the Moving Average and Stochastic Oscillator indicators. The EA detects buy and sell signals by utilizing MA crossovers and confirms the trend with Stochastic. Additionally, the EA includes automatic position management, such as setting Take Profit, Stop Loss, and lot size doubling to enhance trading effectiveness in trending markets.

![A 3 line script that tells you how many bars are on your chart](https://c.mql5.com/i/code/script.png)
[A 3 line script that tells you how many bars are on your chart](/en/code/55976)

A script which when dragged onto the chart will print out in the experts window the number of bars that are on that chart - like magic.

![Print massive information (PrintXYZ) from the terminal](https://c.mql5.com/i/code/library.png)
[Print massive information (PrintXYZ) from the terminal](/en/code/56055)

PrintXYZ() library to print massive information from the terminal.