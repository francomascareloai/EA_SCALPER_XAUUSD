# Self Optimized SMA - indicator for MetaTrader 5

Source: https://www.mql5.com/en/code/56289

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/56289) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# Self Optimized SMA - indicator for MetaTrader 5

[Yashar Seyyedin](/en/users/yashar.seyyedin)  |
[English](javascript:void(false);)

[Русский](/ru/code/56289) [中文](/zh/code/56289) [Español](/es/code/56289) [Deutsch](/de/code/56289) [日本語](/ja/code/56289) [Português](/pt/code/56289) [한국어](/ko/code/56289) [Français](/fr/code/56289) [Italiano](/it/code/56289) [Türkçe](/tr/code/56289)

Views:
:   4678

Rating:
:   (5)

Published:
:   21 February 2025, 09:07
:   [AMA.mq5](/en/code/download/56289/ama.mq5 "AMA.mq5")
    (6.23 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/56289.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

### The algorithm

> At every bar the indicator checks all SMA periods ranging from MIN\_PERIOD to MAX\_PERIOD to find which one caused the most recent bounce(either up or down). If nothing found it leaves that bar empty.

### What is the purpose?

> The indicator is meant to detect market momentum. Wherever you find both upper and lower line to be non-empty you expect range bound behaviour.

### Too much processing needed

> The indicator requires heavy processing. So choosing too wide ranges of MA period to be scanned for larger lookback bars or changing SMA to more sophisticated MA methods will cause the indicator to load too late. Anyway when loaded you will have to update latest bar only.
>
> [![SMA with optimized period](https://c.mql5.com/18/159/XAUEURH1__2.png "SMA with optimized period")](https://c.mql5.com/18/159/XAUEURH1__1.png "https://c.mql5.com/18/159/XAUEURH1__1.png")

**Last comments |
[Go to discussion](/en/forum/481855)**
(6)

![Lorentzos Roussos](https://c.mql5.com/avatar/2025/3/67c6d936-d959.jpg "Lorentzos Roussos")

**[Lorentzos Roussos](/en/users/lorio)**
|
21 Feb 2025 at 10:32

Nice idea

![Yashar Seyyedin](https://c.mql5.com/avatar/2022/8/630fdfde-bf46.jpg "Yashar Seyyedin")

**[Yashar Seyyedin](/en/users/yashar.seyyedin)**
|
21 Feb 2025 at 10:41

**fxsaber [#](/en/forum/481855#comment_55971965):**  
 [INDICATOR\_CALCULATIONS](/en/docs/constants/indicatorconstants/customindicatorproperties#enum_indexbuffer_type_enum)

Hello. Do you mean to use a separate buffer for each SMA period? If that is so let's leave it to other developers!

![Yashar Seyyedin](https://c.mql5.com/avatar/2022/8/630fdfde-bf46.jpg "Yashar Seyyedin")

**[Yashar Seyyedin](/en/users/yashar.seyyedin)**
|
21 Feb 2025 at 10:42

**Lorentzos Roussos [#](/en/forum/481855#comment_55972276):**  
 Nice idea

Hello. Thanks. I did not apply it in any EA but test results work pretty good for : XAUUSD-H1-Asian session.

![Tautvydas Vaitkus](https://c.mql5.com/avatar/2023/12/65722f5c-f3d6.png "Tautvydas Vaitkus")

**[Tautvydas Vaitkus](/en/users/tauv)**
|
1 Mar 2025 at 03:21

Just bravo! Hats off. It is simple and it just works in back-tester, and live.

![Muktar Usman](https://c.mql5.com/avatar/2025/2/67C21C2B-4AF3.png "Muktar Usman")

**[Muktar Usman](/en/users/muktarusman)**
|
1 Mar 2025 at 04:24

I am interested in this trading I don't understand how to use it

![Collect Data (Date, Time and Close Price)](https://c.mql5.com/i/code/script.png)
[Collect Data (Date, Time and Close Price)](/en/code/56064)

A simple starting-point script to collect data and send to a CSV in oldest-newest ordering. In this example only the close price data is collected.

![Print massive information (PrintXYZ) from the terminal](https://c.mql5.com/i/code/library.png)
[Print massive information (PrintXYZ) from the terminal](/en/code/56055)

PrintXYZ() library to print massive information from the terminal.

![Useful #define statements](https://c.mql5.com/i/code/script.png)
[Useful #define statements](/en/code/56149)

These are some #define statements that are useful to perform operations in your EA. You only need to assign the name of your variables at the beginning of the file, and then let the other #define statements do the work.
In order to use this file, add #include <DEFINE\_statements.mqh> to the first line in your EA file.

![Download all ticks of a symbol's history](https://c.mql5.com/i/code/expert.png)
[Download all ticks of a symbol's history](/en/code/56324)

Download all the ticks from your broker for all the symbols in the market watch.
Download all history or until a specific date in the past if available.