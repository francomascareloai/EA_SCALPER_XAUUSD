# Logging V2 for both MQL4 and MQL5 - library for MetaTrader 5

Source: https://www.mql5.com/en/code/52298

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/52298) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Libraries](https://c.mql5.com/i/code/library.png)

# Logging V2 for both MQL4 and MQL5 - library for MetaTrader 5

[Simone Lamanna](/en/users/stormwave)  |
[English](javascript:void(false);)

[Русский](/ru/code/52298) [中文](/zh/code/52298) [Español](/es/code/52298) [Deutsch](/de/code/52298) [日本語](/ja/code/52298) [Português](/pt/code/52298) [한국어](/ko/code/52298) [Français](/fr/code/52298) [Italiano](/it/code/52298) [Türkçe](/tr/code/52298)

Views:
:   4537

Rating:
:   (5)

Published:
:   22 September 2024, 13:12
:   \MQL5\Include\

    [Logging.mqh](/en/code/download/52298/logging.mqh "Logging.mqh")
    (52.65 KB)
    [view](# "view")

    \MQL5\Experts\

    [test\_logging.mq5](/en/code/download/52298/test_logging.mq5 "test_logging.mq5")
    (6.25 KB)
    [view](# "view")

    \MQL5\Scripts\

    [Logging.mq5](/en/code/download/52298/logging.mq5 "Logging.mq5")
    (9.08 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/52298.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

## CDebugLogger Class V2: A Comprehensive Logging Utility for MQL4/5

The **CDebugLogger** class is a powerful and flexible logging utility specifically designed for MQL4/5 environments. It is an essential tool for developers who need to monitor, debug, and track the behavior of their applications with precision.

In this new version of the [CDebugLogger class](/en/code/51817), I have introduced several improvements to enhance its functionality and versatility. These improvements include a debounce mechanism to prevent excessive logging in event-driven systems like OnTick, OnTimer, and OnChartEvent, as well as new filtering and silencing options to help developers focus on the most relevant log entries.

I've decided to release this updated version as a separate codebase to give users the freedom to choose the implementation that best fits their needs. Whether you prefer the original version or this enhanced one, you now have the option to select the logging tool that suits your workflow and project requirements.

Below, we explore the key features and capabilities of this enhanced class.

### Key Features

* **Multiple Log Levels:** The CDebugLogger class supports logging at different levels of importance, including *INFO*, *WARNING*, *ERROR*, and *DEBUG*. This allows developers to filter and focus on messages of particular significance.
* **Timestamp Inclusion:** Developers can choose to include timestamps in their log messages, with customizable formats. This feature is crucial for tracking the exact time of events and debugging time-sensitive issues.
* **File Logging:** The class provides robust support for logging to files. Developers can enable or disable file logging, specify the log file's path, and choose whether to save logs in a common folder. Additionally, logs can be saved in a CSV format, making them easy to parse and analyze.
* **Contextual Information:** To enhance the clarity of log messages, the CDebugLogger class allows the inclusion of function signatures, file names, and line numbers. This contextual information helps in pinpointing the exact location of issues within the code.
* **Silent Keywords:** A unique feature of this class is the ability to silence logs that contain specific keywords. This is particularly useful for preventing sensitive information, such as passwords or confidential data, from being logged.
* **Filter Keywords:** Another unique feature of this class is the ability to filter logs that contain specific keywords. This is particularly useful for debugging by focusing only on logs that are relevant to specific issues. Developers can narrow down the log output to include only messages containing certain terms, making it easier to identify and address problems related to those terms without being overwhelmed by unrelated log entries.
* **Debounce Logging for Events**: To prevent log spamming and excessive logging in event-driven systems (such as OnTick, OnTimer, and OnChartEvent), the CDebugLogger class includes a debouncing mechanism. This feature ensures that repeated log entries from the same event are temporarily suppressed, allowing only unique or significant changes to be logged. This is particularly useful for reducing noise in the logs and preventing performance degradation in high-frequency event environments.

### Example Usage

Below is an example of how to initialize and use the CDebugLogger class:

```mql5
// Initialize the logger with INFO level logging to a file
CDebugLogger logger(INFO, true, "log.txt", true, TIME_DATE | TIME_MINUTES, false, true, true, true);

// Log a simple message
logger.Log(INFO, "This is an info message");

// Silence a keyword
logger.AddSilentKeyword("password");

// Log a message that will be silenced
logger.Log(INFO, "User entered password: 1234");

// Enable file logging
logger.EnableFileLogging(true, "debug.log", false);

// Remove a silenced keyword
logger.RemoveSilentKeyword("password");

// Log a message after removing the keyword from the silence list
logger.Log(INFO, "User entered password: 1234");

// Add a keyword to filter logs
logger.AddFilterKeyword("success");

// Log a message that will be filtered out
logger.Log(INFO, "Operation failed");

// Log a message that will pass the filter
logger.Log(INFO, "Operation successful");

// Remove a keyword from the filter
logger.RemoveFilterKeyword("success");

// Initialize using the generic Log function
logging.Initialize(WARNING, true, "warnings.log", true, TIME_SECONDS, true, false, true, true);

// Log a warning using the generic Log function
Log(WARNING, "This is a warning message");
```

### Script Example

To utilize the CDebugLogger class in a script, simply include the necessary library at the beginning of your file, as shown below:

```mql5
//--- It is important to include this header file before all others
#include <Logging.mqh>  


//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
{
   //--- Initialize the logger with INFO level, logging to a file
   //--- Including timestamps and saving in CSV format
   int log_options = 0; // FILENAME | LINE | FUNCSIG;
   logging.Initialize(INFO, true, "example_log.txt", true, TIME_DATE | TIME_MINUTES | TIME_SECONDS, false, log_options, true);

   //--- Log a simple informational message
   Log(INFO, "Script started successfully.");

   //--- Log a warning message
   Log(WARNING, "This is a warning message.");

   //--- Log an error message
   Log(ERROR, "This is an error message.");

   //--- Log a debug message
   Log(DEBUG, "This is a debug message for debugging purposes.");

   //--- Add a keyword to silence logs containing 'password'
   logging.AddSilentKeyword("password");

   //--- Attempt to log a message containing the silenced keyword
   Log(INFO, "User entered password: 12348"); // This message will be silenced

   //--- Remove the silenced keyword
   logging.RemoveSilentKeyword("password");

   //--- Log the message again, now it will be logged
   Log(INFO, "User entered password: 1234");

   //--- Use the generic Log function to log a message
   Log(INFO, "This message is logged using the generic Log function.");

   //--- Use the Print macro to log a message at the INFO level
   Print("This message is logged using the Print macro.");

   //--- Demonstrate logging with different combinations of options
   logging.Initialize(INFO, true, "log_with_options.txt", true, TIME_DATE | TIME_MINUTES, false, FILENAME | LINE, true);
   Log(INFO, "This log includes only the file name and line number.");

   logging.Initialize(INFO, true, "log_with_funcsig.txt", true, TIME_DATE | TIME_MINUTES | TIME_SECONDS, false, FUNCSIG, true);
   Log(INFO, "This log includes only the function signature.");

   logging.Initialize(INFO, true, "log_custom_order.txt", true, TIME_MINUTES, false, LINE | FILENAME | FUNCSIG, true);
   Log(INFO, "This log includes line number, file name, and function signature in a custom order.");

   //--- Add a keyword to filter logs containing 'important'
   logging.AddFilterKeyword("important");

   //--- Log some messages to demonstrate the filter
   Log(INFO, "This is an important message."); // This message will be visible
   Log(INFO, "This is a regular message.");    // This message will not be visible

   //--- Remove the filter keyword to show all logs
   logging.RemoveFilterKeyword("important");

   //--- Log a final message indicating the end of the script
   Log(INFO, "Script execution completed.");
}
```

### Output CSV example:

```mql5
Timestamp,Level,Message
"2024.09.01 18:31:44","INFO","Script started successfully."
"2024.09.01 18:31:44","WARNING","This is a warning message."
"2024.09.01 18:31:44","ERROR","This is an error message."
"2024.09.01 18:31:44","DEBUG","This is a debug message for debugging purposes."
"2024.09.01 18:31:44","INFO","User entered password: 1234"
"2024.09.01 18:31:44","INFO","This message is logged using the generic Log function."
"2024.09.01 18:31:44","INFO","This message is logged using the Print macro."
```

```mql5
Timestamp,Level,Message,Filename,Line
"2024.09.01 18:31","INFO","This log includes only the file name and line number.","Logging.mq5","135"
```

```mql5
Timestamp,Level,Message,Funcsig
"2024.09.01 18:31:44","INFO","This log includes only the function signature.","void OnStart()"
```

```mql5
Timestamp,Level,Message,Filename,Line,Funcsig
"18:31","INFO","This log includes line number, file name, and function signature in a custom order.","Logging.mq5","141","void OnStart()"
"18:31","INFO","This is an important message.","Logging.mq5","147","void OnStart()"
"18:31","INFO","Script execution completed.","Logging.mq5","154","void OnStart()"
```

### Exper Advisor Example

```mql5
#include <Logging.mqh>

//+------------------------------------------------------------------+
//| Expert initialization function                                   |
//+------------------------------------------------------------------+
int OnInit()
{  int log_options = LINE | FUNCSIG; // FILENAME | LINE | FUNCSIG; or 0
   logging.Initialize(INFO, false, "example_log.txt", true, TIME_DATE | TIME_MINUTES | TIME_SECONDS, false, log_options, false);
//--- create timer
   EventSetMillisecondTimer(1);
//---
   return(INIT_SUCCEEDED); }
//+------------------------------------------------------------------+
//| Expert deinitialization function                                 |
//+------------------------------------------------------------------+
void OnDeinit(const int reason)
{
//--- destroy timer
   EventKillTimer(); }

int counter = 0;
datetime last_time = 0; //--- Stores the last time the counter was updated
//+------------------------------------------------------------------+
//| Timer function                                                   |
//+------------------------------------------------------------------+
void OnTimer()
{  logging.BeginEvent(); //--- Start a new event
   Log(INFO, "Sample message");
   Log(INFO, "Another message");
   Log(INFO, "Sample message"); 
//--- Get the current time
   datetime current_time = TimeLocal();
//--- Check if at least 2 seconds have passed since the counter was last updated
   if (current_time - last_time >= 2)
   {  //--- Update the counter
      counter++;
      //--- Update the last time
      last_time = current_time;
      //--- Log the message with the new counter value
      Log(INFO, "Counter value: " + IntegerToString(counter));
      //--- You can also log another message
      Log(INFO, "Updated after 2 seconds"); }
   else
   {  //--- Log a message indicating that the timer is active but the counter hasn't changed
      Log(INFO, "Timer active but counter unchanged"); } }
```

### Output MT5 terminal example:

```mql5
2024.09.22 13:00:29.589 test_logging (EURUSD,H1)        2024.09.22 13:00:29 Line: 43 Function: void OnTimer() [INFO] Sample message
2024.09.22 13:00:29.589 test_logging (EURUSD,H1)        2024.09.22 13:00:29 Line: 44 Function: void OnTimer() [INFO] Another message
2024.09.22 13:00:29.589 test_logging (EURUSD,H1)        2024.09.22 13:00:29 Line: 45 Function: void OnTimer() [INFO] Sample message
2024.09.22 13:00:29.589 test_logging (EURUSD,H1)        2024.09.22 13:00:29 Line: 55 Function: void OnTimer() [INFO] Counter value: 1
2024.09.22 13:00:29.589 test_logging (EURUSD,H1)        2024.09.22 13:00:29 Line: 57 Function: void OnTimer() [INFO] Updated after 2 seconds
2024.09.22 13:00:29.605 test_logging (EURUSD,H1)        2024.09.22 13:00:29 Line: 60 Function: void OnTimer() [INFO] Timer active but counter unchanged
2024.09.22 13:00:31.001 test_logging (EURUSD,H1)        2024.09.22 13:00:31 Line: 55 Function: void OnTimer() [INFO] Counter value: 2
2024.09.22 13:00:31.001 test_logging (EURUSD,H1)        2024.09.22 13:00:31 Line: 57 Function: void OnTimer() [INFO] Updated after 2 seconds
2024.09.22 13:00:31.017 test_logging (EURUSD,H1)        2024.09.22 13:00:31 Line: 60 Function: void OnTimer() [INFO] Timer active but counter unchanged
2024.09.22 13:00:33.001 test_logging (EURUSD,H1)        2024.09.22 13:00:33 Line: 55 Function: void OnTimer() [INFO] Counter value: 3
2024.09.22 13:00:33.001 test_logging (EURUSD,H1)        2024.09.22 13:00:33 Line: 57 Function: void OnTimer() [INFO] Updated after 2 seconds
2024.09.22 13:00:33.016 test_logging (EURUSD,H1)        2024.09.22 13:00:33 Line: 60 Function: void OnTimer() [INFO] Timer active but counter unchanged
```

### Conclusion

The **CDebugLogger** class is an invaluable tool for any MQL4/5 developer. With its wide range of customizable features, it enables precise logging and monitoring of applications, facilitating easier debugging and better application performance tracking. Whether you need simple message logging or detailed contextual information, the CDebugLogger class provides a reliable and efficient solution tailored to your development needs.

For more information about the CDebugLogger class or to explore other advanced tools and solutions, visit [StormWave Technologies](/go?link=https://stormwave.co/ "https://stormwave.co/").

**Last comments |
[Go to discussion](/en/forum/473497)**
(1)

![jmimi](https://c.mql5.com/avatar/avatar_na2.png "jmimi")

**[jmimi](/en/users/jmimi)**
|
12 Nov 2024 at 10:37

Thanks for a concise and useful library.
I have one suggestion: Please flush the file on every write and close the file in destructor. It would be more efficient.

![PTB](https://c.mql5.com/i/code/indicator.png)
[PTB](/en/code/52296)

Indicator Description: PTB.mq5
Overview: The PTB.mq5 indicator for MetaTrader 5 calculates short-term and long-term high and low prices, along with Fibonacci retracement levels based on these extremes.
Features:
Short-Term High and Low: Identifies immediate support and resistance over a user-defined short length.
Long-Term High and Low: Analyzes broader market trends over a longer period.
Fibonacci Levels: Plots key retracement levels (23.6%, 38.2%, 50%, 61.8%, 78.6%) for potential reversal points.
Input Parameters:
shortLength: Number of candles for short-term calculation.
longLength: Number of candles for long-term calculation.
Visual Representation:
Distinct colors and widths for each line to differentiate between high/low and Fibonacci levels.
Usage: Helps traders identify entry/exit points and monitor market trends based on historical price levels.

![Code To Check And Delete Chart Objects For MT5](https://c.mql5.com/i/code/script.png)
[Code To Check And Delete Chart Objects For MT5](/en/code/52221)

The script scans through the current chart for any available chart objects, Counts and delete them accordingly, And log the the names of the objects on the chart respectively.

![Position Risk Calculation Tool](https://c.mql5.com/i/code/indicator.png)
[Position Risk Calculation Tool](/en/code/52304)

An indicator that dynamically calculates risk (in percentages and money) based on the lot size and stop loss

![Dashboard Panel for displaying information on the chart](https://c.mql5.com/i/code/expert.png)
[Dashboard Panel for displaying information on the chart](/en/code/52318)

This code shows how you can create a dashboard to display all the relevant information on the chart