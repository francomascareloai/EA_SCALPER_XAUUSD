# Multi-currency night scalper - Night Scalper Multi - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/16350

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/16350) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Multi-currency night scalper - Night Scalper Multi - expert for MetaTrader 5

[Andrey Kornishkin](/en/users/am2)  |
[English](javascript:void(false);)

[Русский](/ru/code/16350) [中文](/zh/code/16350) [Español](/es/code/16350) [Deutsch](/de/code/16350) [日本語](/ja/code/16350) [Português](/pt/code/16350)

Views:
:   20651

Rating:
:   (38)

Published:
:   18 January 2017, 09:24
:   [NightScalper.mq5](/en/code/download/16350/nightscalper.mq5 "NightScalper.mq5")
    (8.11 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/16350.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The **Night Scalper Multi** multi-currency night scalper trades until 0 am terminal time within a narrow range **(r)**, determined using the **Bollinger Bands** indicator.

```mql5
BBHandle=iBands(symb,0,per,0,dev,0);
   CopyBuffer(BBHandle,1,0,1,up);
   CopyBuffer(BBHandle,2,0,1,dn);

   double r=up[0]-dn[0];
```

Position is opened after the hour specified in **Start**, and if there are no open positions on the symbol.

```mql5
if(CountTrades(symb)<1 && TimeCurrent()>StringToTime(s))
```

Buy, if price is lower than the lower boundary of **Bollinger Bands** and channel is smaller than the range specified in the **Razmah** variable.

```mql5
if(Ask<dn[0] && r<razmah*_Point) trade.PositionOpen(symb,0,Lot,Ask,Ask-stop*_Point,Ask+take*_Point);
```

Sell, if price is above the upper boundary of **Bollinger Bands** and channel is smaller than the range specified in the **Razmah** variable.

```mql5
if(Bid>up[0] && r<razmah*_Point) trade.PositionOpen(symb,1,Lot,Bid,Bid+stop*_Point,Bid-take*_Point);
```

Positions are closed by stop losses or force-closed after 0 am.

```mql5
else if(CountTrades(symb)>0 && TimeCurrent()<StringToTime(s)) CloseAll(symb);
```

Trades with the help of the **SymbolTrade** function and uses the **СTrade** class:

```mql5
void SymbolTrade(string symb,int stop,int take,int per,double dev,double razmah,int start)
  {
   string s=(string)start+":00";
   double Ask=SymbolInfoDouble(symb,SYMBOL_ASK);
   double Bid=SymbolInfoDouble(symb,SYMBOL_BID);

   BBHandle=iBands(symb,0,per,0,dev,0);
   CopyBuffer(BBHandle,1,0,1,up);
   CopyBuffer(BBHandle,2,0,1,dn);

   double r=up[0]-dn[0];

   if(CountTrades(symb)<1 && TimeCurrent()>StringToTime(s))
     {
      if(Ask<dn[0] && r<razmah*_Point) trade.PositionOpen(symb,0,Lot,Ask,Ask-stop*_Point,Ask+take*_Point);
      if(Bid>up[0] && r<razmah*_Point) trade.PositionOpen(symb,1,Lot,Bid,Bid+stop*_Point,Bid-take*_Point);
     }
   else if(CountTrades(symb)>0 && TimeCurrent()<StringToTime(s)) CloseAll(symb);
  }
```

Trade operations are performed on new bar.

```mql5
if(bars!=Bars(NULL,0))
     {
      if(Symbol1!="") SymbolTrade(Symbol1,StopLoss1,TakeProfit1,BBPeriod1,BBDev1,Razmah1,Start1);
      if(Symbol2!="") SymbolTrade(Symbol2,StopLoss2,TakeProfit2,BBPeriod2,BBDev2,Razmah2,Start2);
      if(Symbol3!="") SymbolTrade(Symbol3,StopLoss3,TakeProfit3,BBPeriod3,BBDev3,Razmah3,Start3);
        ...
     }
   bars=Bars(NULL,0);
```

**Settings:**

```mql5
input string Symbol1     = "USDCAD";       // Symbol1 Name
input int    StopLoss1   = 370;            // StopLoss1
input int    TakeProfit1 = 20;             // TakeProfit1
input int    BBPeriod1   = 40;             // Bands Period1
input double BBDev1      = 1;              // Bands Deviation1
input double Razmah1     = 450;            // Bands Deviation1 in Points
input int    Start1      = 19;             // Start Time1

input string Symbol2     = "GBPUSD";       // Symbol2 Name
input int    StopLoss2   = 450;            // StopLoss2
input int    TakeProfit2 = 80;             // TakeProfit2
input int    BBPeriod2   = 8;              // Bands Period2
input double BBDev2      = 1;              // Bands Deviation2
input double Razmah2     = 200;            // Bands Deviation2 in Points
input int    Start2      = 20;             // Start Time2

input string Symbol3     = "NZDUSD";       // Symbol3 Name
input int    StopLoss3   = 410;            // StopLoss3
input int    TakeProfit3 = 40;             // TakeProfit3
input int    BBPeriod3   = 4;              // Bands Period3
input double BBDev3      = 1.2;            // Bands Deviation3
input double Razmah3     = 450;            // Bands Deviation3 in Points
input int    Start3      = 19;             // Start Time3

input string Symbol4     = "";             // Symbol4 Name
input int    StopLoss4   = 500;            // StopLoss4
input int    TakeProfit4 = 40;             // TakeProfit4
input int    BBPeriod4   = 24;             // Bands Period4
input double BBDev4      = 1;              // Bands Deviation4
input double Razmah4     = 200;            // Bands Deviation4 in Points
input int    Start4      = 20;             // Start Time4

input string Symbol5     = "";             // Symbol5 Name
input int    StopLoss5   = 500;            // StopLoss5
input int    TakeProfit5 = 40;             // TakeProfit5
input int    BBPeriod5   = 24;             // Bands Period5
input double BBDev5      = 1;              // Bands Deviation5
input double Razmah5     = 200;            // Bands Deviation5 in Points
input int    Start5      = 20;             // Start Time5

input string Symbol6     = "";             // Symbol6 Name
input int    StopLoss6   = 500;            // StopLoss6
input int    TakeProfit6 = 40;             // TakeProfit6
input int    BBPeriod6   = 24;             // Bands Period6
input double BBDev6      = 1;              // Bands Deviation6
input double Razmah6     = 200;            // Bands Deviation6 in Points
input int    Start6      = 20;             // Start Time6

input string Symbol7     = "";             // Symbol7 Name
input int    StopLoss7   = 500;            // StopLoss7
input int    TakeProfit7 = 40;             // TakeProfit7
input int    BBPeriod7   = 24;             // Bands Period7
input double BBDev7      = 1;              // Bands Deviation7
input double Razmah7     = 200;            // Bands Deviation7 in Points
input int    Start7      = 20;             // Start Time7

input string Symbol8     = "";             // Symbol8 Name
input int    StopLoss8   = 500;            // StopLoss8
input int    TakeProfit8 = 40;             // TakeProfit8
input int    BBPeriod8   = 24;             // Bands Period8
input double BBDev8      = 1;              // Bands Deviation8
input double Razmah8     = 200;            // Bands Deviation8 in Points
input int    Start8      = 20;             // Start Time8

input string Symbol9     = "";             // Symbol9 Name
input int    StopLoss9   = 500;            // StopLoss9
input int    TakeProfit9 = 40;             // TakeProfit9
input int    BBPeriod9   = 24;             // Bands Period9
input double BBDev9      = 1;              // Bands Deviation9
input double Razmah9     = 200;            // Bands Deviation9 in Points
input int    Start9      = 20;             // Start Time9

input double Lot         = 1;              // Trade Volume
```

![](https://c.mql5.com/18/53/3.png)

Fig1. The result of the EA trading. EURUSD, H1

![](https://c.mql5.com/18/53/2__2.png)

Fig.2. Deals of the EA in the journal

![](https://c.mql5.com/18/53/1__6.png)

Fig.3. Results of the EA trading and optimization from 11.01.2016 to 13.09.2016. USDCAD, GBPUSD, NZDUSD, H1

**Tips:**

* The EA is recommended for use as a trading assistant and for developing your own strategies.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/16350](/ru/code/16350)

**Last comments |
[Go to discussion](/en/forum/167140)**
(10)

![Andrey Kornishkin](https://c.mql5.com/avatar/2010/9/4C876740-C5E0.jpg "Andrey Kornishkin")

**[Andrey Kornishkin](/en/users/am2)**
|
16 Sep 2016 at 18:18

**fxsaber:**  
 How did you come up with such a simple idea?

I had the idea a long time ago, I have it in my codes and also watched how other scalpers work. Bollinger is my favourite indicator.

![fxsaber](https://c.mql5.com/avatar/2019/8/5D67260D-44C9.png "fxsaber")

**[fxsaber](/en/users/fxsaber)**
|
16 Sep 2016 at 18:21

**Andrew Kornishkin:**  
 I had the idea a long time ago, I have it in my codes and also watched how other scalpers work. Bollinger is my favourite indicator.

Thanks for sharing! I'll check out the idea.

![Dmitry Petrov](https://c.mql5.com/avatar/2018/3/5ABCF0F0-AAE5.jpg "Dmitry Petrov")

**[Dmitry Petrov](/en/users/anabollic)**
|
26 Jul 2017 at 15:53

Can you tell me why it doesn't build a chart in the tester?

It is loaded in MT5. On visualisation it says that the indicator is not loaded. Where should I put it, it is already available in MT5.

![JojoJaja](https://c.mql5.com/avatar/avatar_na2.png "JojoJaja")

**[JojoJaja](/en/users/jojojaja)**
|
10 Jul 2019 at 10:19

How can i download this free Ea here? I didnt found any button

![Marco vd Heijden](https://c.mql5.com/avatar/2021/9/613A9489-6810.png "Marco vd Heijden")

**[Marco vd Heijden](/en/users/thecreator1)**
|
10 Jul 2019 at 10:22

**JojoJaja:**  
 How can i download this free Ea here? I didnt found any button

[https://www.mql5.com/en/code/16350](/en/code/16350)

![The smart averager - Hello Smart](https://c.mql5.com/i/code/expert.png)
[The smart averager - Hello Smart](/en/code/16348)

The Expert Advisor averages losing positions based on a particular algorithm.

![XvaMA_HTF](https://c.mql5.com/i/code/indicator.png)
[XvaMA\_HTF](/en/code/16342)

The XvaMA indicator with the timeframe selection option available in the input parameters.

![JSatl_HTF](https://c.mql5.com/i/code/indicator.png)
[JSatl\_HTF](/en/code/16357)

The JSatl indicator with the timeframe selection option available in the input parameters.

![AFL_WinnerV2_HTF](https://c.mql5.com/i/code/indicator.png)
[AFL\_WinnerV2\_HTF](/en/code/16358)

The AFL\_WinnerV2 indicator with the timeframe selection option available in input parameters.