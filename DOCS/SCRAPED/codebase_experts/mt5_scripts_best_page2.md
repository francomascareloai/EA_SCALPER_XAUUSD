# Top scripts for MetaTrader 5 based on user ratings
           - 2

Source: https://www.mql5.com/en/code/mt5/scripts/best/page2

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Access the CodeBase from your [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

Couldn't find the right code? Order it in the [Freelance](https://www.mql5.com/en/job) section

[How to Write](https://www.mql5.com/en/articles/100) an Expert Advisor or an Indicator

# Top scripts for MetaTrader 5 based on user ratings - 2

[Submit your code](/en/code/new)

![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

You are missing trading opportunities:

* Free trading apps
* Over 8,000 signals for copying
* Economic news for exploring financial markets

Registration
Log in

latin characters without spaces

a password will be sent to this email

An error occurred

* [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

Allow the use of cookies to log in to the MQL5.com website.

Please enable the necessary setting in your browser, otherwise you will not be able to log in.

 

[Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

* [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)

[1](/en/code/mt5/scripts/best)[2](/en/code/mt5/scripts/best/page2)[3](/en/code/mt5/scripts/best/page3)[4](/en/code/mt5/scripts/best/page4)[5](/en/code/mt5/scripts/best/page5)[6](/en/code/mt5/scripts/best/page6)[7](/en/code/mt5/scripts/best/page7)[8](/en/code/mt5/scripts/best/page8)

[latest](/en/code/mt5/scripts) 
|

best

[Partial close Sell Orders](/en/code/60233 "Partial close Sell Orders")

Partially close active sell orders

[Quick Chart Setter: Instant Color Themes for MT5 Traders](/en/code/61452 "Quick Chart Setter: Instant Color Themes for MT5 Traders")

A quick little script to make traders' lives easier. The one thing that always annoys me is resetting the properties like colors for a new chart, to make it look the way i like it. So Here is a script to make things smoother.

[3 way Aroon value calculation](/en/code/64175 "3 way Aroon value calculation")

Showing different ways of the Aroon values calculation

[KeyFinder](/en/code/12382 "KeyFinder")

This script finds DeMark pivot points, displays them on the chart and indicates their dimensions.

[Open Trade](/en/code/47862 "Open Trade")

This function performs the main logic of opening a trade.
Calculates the opening price, take profit levels and stop loss based on symbol information and parameters provided by the user.
Prepare a trade request (MqlTradeRequest) with the necessary information, such as symbol, volume, order type, deviation, comment, magic number, etc.
Call the OrderSend function to send the operation request and get the result.
SetTypeFillingBySymbol function:
Determines the order fill type (Fill or Kill, Immediate or Cancel, or Return) based on the symbol's filling policy.
GetMinTradeLevel function:
Calculates the minimum operating level based on the freeze level and the symbol stops level.
Adjusts the minimum level to make sure it is within certain limits and returns the result.

[Count consecutive no. of bull or bear bars](/en/code/49675 "Count consecutive no. of bull or bear bars")

Sample code to count consecutive no. of bull or bear bars.

[Determine Broker's Daylight (DST) schedule](/en/code/48650 "Determine Broker's Daylight (DST) schedule")

Script to determine whether your Broker follows the US, UK or AU daylight (DST) schedule.

[Information about the ONNX model's inputs and outputs](/en/code/43452 "Information about the ONNX model's inputs and outputs")

The script obtains information about the number, types and sizes of input and output tensors in an ONNX model

[Trap News MT5](/en/code/49864 "Trap News MT5")

Script For Trap News High Impact

[Creat Button Close BuySell On Chart](/en/code/61708 "Creat Button Close BuySell On Chart")

MQL5 script for MetaTrader 5 that adds two buttons to close all buy or sell positions for the current symbol.

[Drag and Drop Move StopLoss](/en/code/46312 "Drag and Drop Move StopLoss")

Set StopLoss by just dragging and dropping script on the desired price level.

[Simplest CSV file writer](/en/code/63261 "Simplest CSV file writer")

Provide simplest class to write CSV file

[send a trade position to telegram channel](/en/code/43610 "send a trade position to telegram channel")

hi, this code need your telegram token and telegram chat id .
you can make robot by BotFather and then search in google how you can find telegram token and chat id then attach them to this code . now every trade would be signals on your telegram channel.

[BuySell + SL + TP](/en/code/51939 "BuySell + SL + TP")

script to open a buy position at the current price in the MT5 window with a specified stop loss (in pips) and take profit (in pips)

[OpenCL Test](/en/code/825 "OpenCL Test")

A small example of the Mandelbrot fractal calculation in OpenCL. The OpenCL accelerates calculations of fractal approximately up to 100 times in comparison with the CPU calculations.

[Apply Template](/en/code/11922 "Apply Template")

Simple script for apply template and/or timeframe to all charts opened.

[Time Price Scale Enables Disables](/en/code/13273 "Time Price Scale Enables Disables")

The script controls the display of time and price scales for all open charts or only for one chart.

[Export trade history to CSV v2](/en/code/24686 "Export trade history to CSV v2")

This is the version 2 of my script to export the trade history from MT5 selected between two dates. The resulting file is CSV that can be opened/imported with any spreadsheet software. More columns were added and fixed minor errors. The code for processing and exporting data was rewritten.

[Balance Graph HTML](/en/code/25199 "Balance Graph HTML")

Display interactive HTML graph of the account balance inside the web browser.

[Programming Patterns - Strategy](/en/code/26722 "Programming Patterns - Strategy")

Encapsulating a family of interchangeable algorythms which can be modified independently from the client.

[TradeReportExporter](/en/code/56662 "TradeReportExporter")

The TradeReportExporter script is designed to export the history of trades (trades) into a convenient CSV file. It automatically collects data on all trades for the last year for the instrument it is installed on. The file includes such data as date and time, transaction type (buy/sell), price, volume, commission and profit/loss. The result is saved in a file that can be opened in Excel or any other spreadsheet editor.

[OpenBuyStopOrder](/en/code/17978 "OpenBuyStopOrder")

A script for placing a BuyStop order

[CloseAllOrders](/en/code/18080 "CloseAllOrders")

The script deletes all pending orders on all symbols at a time.

[Multi\_BuyLimitOrders & Multi\_BuyStopOrders](/en/code/44036 "Multi_BuyLimitOrders & Multi_BuyStopOrders")

Multi buylimit and buystop orders are script files that enable traders to place multiple orders with ease. With just one command, traders can place multiple buylimit or buystop orders using either a target price or pips. By default, the pips value is set to 400, which means the trade will be placed 400 pips away from the current market price for a 5-digit broker. This setup includes stop-loss and take-profit levels, which can be adjusted based on the trader's preferences. Notably, these orders come with a level of flexibility that enables traders to fine-tune their trading strategies. For instance, a trader can opt to set the stop-loss level to zero if they do not use stop-loss.

[Sec-WebSocket-Key Generator](/en/code/47982 "Sec-WebSocket-Key Generator")

Sec-WebSocket-Key Generator

[WININET\_TEST](/en/code/82 "WININET_TEST")

Here is a simple example that shows how to download page(file) from Internet using the library wininet.dll.

[LotLine](/en/code/13304 "LotLine")

The script shows the trade volume in lots required to move the position to a desired level.

[ProfLine](/en/code/20189 "ProfLine")

The script draws horizontal lines representing BUY (blue) and SELL (red) orders.

[downloadhistory.mq5](/en/code/302 "downloadhistory.mq5")

The script downloads historical data (for the current symbol), available at trade server.

[VR System Test MT5](/en/code/14179 "VR System Test MT5")

The script tests the computer in 45 performance tests. It is possible to compare the performance of VPS/VDS servers.

[Volume Average Groups For Comparison](/en/code/44007 "Volume Average Groups For Comparison")

Learn how to split the volume data into different groups so that you can compare them and create a strategy based on volume average.

[Risk Calculator](/en/code/44047 "Risk Calculator")

Calculates the risk in the account currency for a given trading volume of the selected symbol at different time periods.

[Input and output of onnx model](/en/code/47696 "Input and output of onnx model")

The script is useful for inspecting the structure of ONNX models, providing insights into the input and output, their names, and their properties. It is particularly helpful for debugging and understanding the characteristics of ONNX models used in machine learning applications.

[Collect Data (Date, Time and Close Price)](/en/code/56064 "Collect Data (Date, Time and Close Price)")

A simple starting-point script to collect data and send to a CSV in oldest-newest ordering. In this example only the close price data is collected.

[YURAZ\_CreateCSV\_HistoryFile\_From\_MT5\_For\_MT4](/en/code/232 "YURAZ_CreateCSV_HistoryFile_From_MT5_For_MT4")

The script exports historical quotes data from MetaTrader 5 for the import to MetaTrader 4. This solution will allow you to get the full history for MetaTrader 4.

[sHistoryExport - handy script to export the historical data in the МetaТrader 4 format](/en/code/1252 "sHistoryExport - handy script to export the historical data in the МetaТrader 4 format")

Export of all necessary instruments and time frames in one click with load and checking history

[OpenSellLimitOrder](/en/code/17977 "OpenSellLimitOrder")

A script for placing a SellLimit order

[Export Calculated Prices & Indicator Buffers](/en/code/26122 "Export Calculated Prices & Indicator Buffers")

Export tool for OHLC prices, calculated prices & indicator buffers

[Get info about inputs and outputs of onnx-model](/en/code/43453 "Get info about inputs and outputs of onnx-model")

Script gets information about input and output tensors of onnx-model, their types and shapes

[Multi SellOrders](/en/code/44026 "Multi SellOrders")

To assist traders who wish to open multiple sell orders quickly, a script file has been developed that allows them to execute a large number of trades with just one command. The default take profit and stop loss values are set in 5-digit broker format, but for traders using a 4-digit broker, the default must be TP=40 and SL=20.
Num\_of\_Sell is the number of trades to execute. This script file can be extremely useful for traders who want to take advantage of market conditions quickly and efficiently. By simplifying the process of opening multiple sell orders, it can save traders valuable time and allow them to focus on other aspects of their trading

[1](/en/code/mt5/scripts/best)[2](/en/code/mt5/scripts/best/page2)[3](/en/code/mt5/scripts/best/page3)[4](/en/code/mt5/scripts/best/page4)[5](/en/code/mt5/scripts/best/page5)[6](/en/code/mt5/scripts/best/page6)[7](/en/code/mt5/scripts/best/page7)[8](/en/code/mt5/scripts/best/page8)