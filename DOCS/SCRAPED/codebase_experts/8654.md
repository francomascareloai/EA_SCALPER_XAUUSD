# Future___ - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/8654

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/8654) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Future\_\_\_ - expert for MetaTrader 4

[Виталий](/en/users/vitalya_1983)  |
[English](javascript:void(false);)

[Русский](/ru/code/8654)

Views:
:   18261

Rating:
:   (11)

Published:
:   1 July 2016, 09:40
:   [FutureMA.mq4](/en/code/download/8654/FutureMA.mq4 "FutureMA.mq4")
    (11.75 KB)
    [view](# "view")

    [FutureMACD.mq4](/en/code/download/8654/FutureMACD.mq4 "FutureMACD.mq4")
    (10.95 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/8654.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Attempt to create a grid encouraged me to do this.

Take N+M bars on history interval. Write the indicator signals among N bars, and the result among M bars.

This results in a file named [sequence of indicator signals from N bars].csv.

The file contains the subsequent history results.

For example, write the following to a small block:

```mql5
      int history [1000];
      for (int i=analiz_bars+poisk_fractals;i>poisk_fractals;i--)
         {
         history [i] = NormalizeDouble((tocnost*iMACD(NULL,0,Per_MACD/4,Per_MACD,9,PRICE_CLOSE,MODE_MAIN, i)/(100*Point)),0);
         }
```

It outputs an array which is further used here:

```mql5
      string posledovatelnost = shethik +"_";
      for (i=analiz_bars+poisk_fractals;i>poisk_fractals;i--)
         {
         posledovatelnost =posledovatelnost+history [i]+"_";
         }
      posledovatelnost = posledovatelnost +".csv";
```

Then save the file with the name [posledovatelnost].

Write the number of calls (to determine the statistical weight) and results of the following block to that file:

```mql5
      double MaxHighPik = High [poisk_fractals]; //Start comparing the bars
      double MaxLowPik = Low [poisk_fractals];  
      for (i=poisk_fractals; i>=1; i--)
         {
         if (MaxHighPik < High [i])
            {
            MaxHighPik = High [i];     
            }
         if (MaxLowPik > Low [i])
            {
            MaxLowPik = Low [i];       
            }
         }
         
      double Fractal_Up = (MaxHighPik - Open [poisk_fractals])/Point;
      double Fractal_Down = (Open [poisk_fractals]-MaxLowPik)/Point;
```

The movement direction of the following N bars and the reached maximums are determined here. The results are written as averaged with the ability to assign the more recent data an increased or decreased statistical weight using the **zabyvaemost** variable. The indicator values are additionally averaged by the **tocnost** variable. With minimal averaging only the direction +1 or -1 is given.

But. Despite the wonderful looks the results are not impressive. Two expert advisors are provided as example. Profitability rarely rises above 1.1

Example of using the MA:

[![](https://c.mql5.com/18/19/TesterGraph_small.gif)](https://c.mql5.com/18/19/TesterGraph.gif)

If anyone manages to make a decent EA, please contact me.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/8654](/ru/code/8654)

**[Go to discussion](/en/forum/90331)**

![Billy expert](https://c.mql5.com/i/code/expert.png)
[Billy expert](/en/code/8651)

The Expert Advisor uses a certain candlestick pattern and Stochastic.

![ChangeObjectsColor](https://c.mql5.com/i/code/script.png)
[ChangeObjectsColor](/en/code/8649)

The script allows to change the color of selected objects to specified one.

![Stochastic Divergence](https://c.mql5.com/i/code/indicator.png)
[Stochastic Divergence](/en/code/8655)

Divergence based on a standard Stochastic with Alert and language selection.

![Doubler](https://c.mql5.com/i/code/expert.png)
[Doubler](/en/code/8656)

Simple Expert Advisor that simultaneously opens two positions in different directions, provided that the stop loss of the losing position triggers 5 points earlier than the take profit of the profitable one.