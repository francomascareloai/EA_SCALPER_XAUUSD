# NNFX Auto Trader - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/30554

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/30554) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# NNFX Auto Trader - expert for MetaTrader 4

[Manuel Alejandro Cercos Perez](/en/users/alexcercos)

Views:
:   20333

Rating:
:   (39)

Published:
:   10 August 2020, 01:13

Updated:
:   2 September 2020, 20:11
:   [NNFXAutoTrade.mq4](/en/code/download/30554/nnfxautotrade.mq4 "NNFXAutoTrade.mq4")
    (56.72 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/30554.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

This EA allows to **CREATE, MANAGE and EXIT** trades in the No Nonsense Forex way much faster. It helps to perfect risk management and also to get rid of emotions when trading, as you can open and close trades with one click.

### Inputs

-X/Y position: change the position of the box in the chart

-Default Risk: Percentage of the account used in one trade (this setting is saved between sessions). Default is 2.

-Pip decimal shift: extra decimals after the pip decimal (some brokers provide 5 decimals instead of 4. In this case, this parameter should be set to 1).

-Lots decimals: Precision of lot values (if your broker allows to trade with nano lots: 3 decimals). Default is 2.

**\*\*Extra account:** This is not a parameter, but can be changed in code easily (line 43: rewrite, save and compile). Money in external accounts that needs to be taken into account to no split risk (for example, if you had 10000$ in other broker or in the bank). It is not a parameter since it should be changed in each of the 28 pairs every time it is updated: it is faster to write it directly in code and recompile (which changes the value for all instances, while mantaining every other parameter intact).

![]()

### Controls

**-RISK INPUT:** allows to change the risk value faster, but it is not saved after closing MT4.

**-SELL/BUY:** opens 2 trades with half lots in each one: both with stop loss at ATR\*1.5 and only one of them with take profit at ATR.

**-SL to BREAKEVEN:** sets the stop loss of every open trade to its initial price

**-TRAILING STOP:** updates the stop loss (only works after price has moved more than 2\*ATR

**-SHOW:** displays the pip value, the current ATR used (in pips) and the lots that better approximate the risk (and it's real cost)

**-USE ADVANCED:** allows to set custom stops and take profits. Be careful if that window is **open**, since these values would be the ones used (when opening trades, or updating trailing stops). If **USE DATE** is set to true (default), the system picks the current ATR in the hours before daily candle close, and the last ATR after a new candle is created.

### Possible errors or bad uses

-Opening trades when the lots that fit the risk are 0.01 or 0.00 (when using 2 decimals), the amount of lots would be invalid (with 0.01, one trade would be opened with 0.01 lots, and the other would be invalid).

-Set breakeven when the trade is losing also causes an error

-The EA may interfer with other open trades if they are in the same pair since it doesn't recognize which it has opened

-This EA is optimized to be used in D1 charts (if not, make sure that USE DATE is set to false or use custom TP-SL)

-Orders can still be modified manually

-Don't click SELL or BUY multiple times, since it would open 2 trades each time

-Be careful with your margin: the EA does not check it, and it also doesn't prevent you from overexposing to one currency in multiple trades

-It has only been checked with the main forex pairs, it could work with **metals, commodities or stocks** but I can't say for sure

Feel free to report any bug, change code or whatever you may want. If you are a beginner (well, like me), I recommend to learn how risk is calculated before using this EA. Also, forward test it before using it with real money accounts (and make sure your broker allows Expert Advisors, I don't know if that can have any influence).

\*\*Edit: buy orders didn't scale out, solved

**Last comments |
[Go to discussion](/en/forum/348619)**
(5)

![Pankaj S](https://c.mql5.com/avatar/avatar_na2.png "Pankaj S")

**[Pankaj S](/en/users/pankaj5043)**
|
28 Aug 2020 at 12:57

Compilation failed. Error

> ```mql5
> 'NNFXAutoTrade.mq4' NNFXAutoTrade.mq4 1 1
> 'DoubleToStr' - undeclared identifier NNFXAutoTrade.mq4 108 52
> ',' - unexpected token NNFXAutoTrade.mq4 108 68
> 'risk' - some operator expected NNFXAutoTrade.mq4 108 64
> '2' - unexpected token NNFXAutoTrade.mq4 108 70
> ')' - unexpected token NNFXAutoTrade.mq4 108 72
> '*' - open parenthesis expected NNFXAutoTrade.mq4 250 32
> '*' - open parenthesis expected NNFXAutoTrade.mq4 251 38
> 'OP_SELL' - undeclared identifier NNFXAutoTrade.mq4 260 40
> 'Bid' - undeclared identifier NNFXAutoTrade.mq4 260 59
> 'Bid' - undeclared identifier NNFXAutoTrade.mq4 260 67
> 'Bid' - undeclared identifier NNFXAutoTrade.mq4 260 77
> 'OrderSend' - wrong parameters count NNFXAutoTrade.mq4 260 20
> 'SELECT_BY_TICKET' - undeclared identifier NNFXAutoTrade.mq4 263 33
> 'MODE_TRADES' - undeclared identifier NNFXAutoTrade.mq4 263 51
> 'OrderSelect' - wrong parameters count NNFXAutoTrade.mq4 263 13
> 'OrderOpenPrice' - undeclared identifier NNFXAutoTrade.mq4 264 50
> ')' - expression expected NNFXAutoTrade.mq4 264 65
> 'OP_SELL' - undeclared identifier NNFXAutoTrade.mq4 270 36
> 'Bid' - undeclared identifier NNFXAutoTrade.mq4 270 62
> 'Bid' - undeclared identifier NNFXAutoTrade.mq4 270 70
> 'OrderSend' - wrong parameters count NNFXAutoTrade.mq4 270 16
> 'SELECT_BY_TICKET' - undeclared identifier NNFXAutoTrade.mq4 273 33
> 'MODE_TRADES' - undeclared identifier NNFXAutoTrade.mq4 273 51
> 'OrderSelect' - wrong parameters count NNFXAutoTrade.mq4 273 13
> 'OrderOpenPrice' - undeclared identifier NNFXAutoTrade.mq4 274 53
> ')' - expression expected NNFXAutoTrade.mq4 274 68
> '*' - open parenthesis expected NNFXAutoTrade.mq4 294 32
> '*' - open parenthesis expected NNFXAutoTrade.mq4 295 38
> 'OP_BUY' - undeclared identifier NNFXAutoTrade.mq4 305 40
> 'Ask' - undeclared identifier NNFXAutoTrade.mq4 305 58
> 'Ask' - undeclared identifier NNFXAutoTrade.mq4 305 66
> 'Ask' - undeclared identifier NNFXAutoTrade.mq4 305 76
> 'OrderSend' - wrong parameters count NNFXAutoTrade.mq4 305 20
> 'SELECT_BY_TICKET' - undeclared identifier NNFXAutoTrade.mq4 308 33
> 'MODE_TRADES' - undeclared identifier NNFXAutoTrade.mq4 308 51
> 'OrderSelect' - wrong parameters count NNFXAutoTrade.mq4 308 13
> 'OrderOpenPrice' - undeclared identifier NNFXAutoTrade.mq4 309 49
> ')' - expression expected NNFXAutoTrade.mq4 309 64
> 'OP_BUY' - undeclared identifier NNFXAutoTrade.mq4 316 36
> 'Ask' - undeclared identifier NNFXAutoTrade.mq4 316 61
> 'Ask' - undeclared identifier NNFXAutoTrade.mq4 316 69
> 'Ask' - undeclared identifier NNFXAutoTrade.mq4 316 79
> 'OrderSend' - wrong parameters count NNFXAutoTrade.mq4 316 16
> 'SELECT_BY_TICKET' - undeclared identifier NNFXAutoTrade.mq4 319 33
> 'MODE_TRADES' - undeclared identifier NNFXAutoTrade.mq4 319 51
> 'OrderSelect' - wrong parameters count NNFXAutoTrade.mq4 319 13
> 'OrderOpenPrice' - undeclared identifier NNFXAutoTrade.mq4 320 52
> ')' - expression expected NNFXAutoTrade.mq4 320 67
> 'SELECT_BY_POS' - undeclared identifier NNFXAutoTrade.mq4 339 29
> 'MODE_TRADES' - undeclared identifier NNFXAutoTrade.mq4 339 43
> 'OrderSelect' - wrong parameters count NNFXAutoTrade.mq4 339 14
> 'OrderSymbol' - undeclared identifier NNFXAutoTrade.mq4 341 13
> ')' - expression expected NNFXAutoTrade.mq4 341 25
> implicit conversion from 'number' to 'string' NNFXAutoTrade.mq4 341 13
> 'OrderModify' - undeclared identifier NNFXAutoTrade.mq4 344 18
> 'OrderTicket' - undeclared identifier NNFXAutoTrade.mq4 344 30
> ')' - expression expected NNFXAutoTrade.mq4 344 42
> ',' - unexpected token NNFXAutoTrade.mq4 344 43
> 'OrderTicket' - some operator expected NNFXAutoTrade.mq4 344 30
> '(' - unbalanced left parenthesis NNFXAutoTrade.mq4 344 16
> 'OrderOpenPrice' - undeclared identifier NNFXAutoTrade.mq4 344 45
> ')' - expression expected NNFXAutoTrade.mq4 344 60
> ',' - unexpected token NNFXAutoTrade.mq4 344 61
> 'OrderOpenPrice' - undeclared identifier NNFXAutoTrade.mq4 344 63
> ')' - expression expected NNFXAutoTrade.mq4 344 78
> ',' - unexpected token NNFXAutoTrade.mq4 344 79
> 'OrderTakeProfit' - undeclared identifier NNFXAutoTrade.mq4 344 81
> ')' - expression expected NNFXAutoTrade.mq4 344 97
> ',' - unexpected token NNFXAutoTrade.mq4 344 98
> 'OrderExpiration' - undeclared identifier NNFXAutoTrade.mq4 344 100
> ')' - expression expected NNFXAutoTrade.mq4 344 116
> ',' - unexpected token NNFXAutoTrade.mq4 344 117
> ')' - unexpected token NNFXAutoTrade.mq4 344 126
> expression has no effect NNFXAutoTrade.mq4 344 119
> ')' - unexpected token NNFXAutoTrade.mq4 344 127
> 'SELECT_BY_POS' - undeclared identifier NNFXAutoTrade.mq4 363 29
> 'MODE_TRADES' - undeclared identifier NNFXAutoTrade.mq4 363 43
> 'OrderSelect' - wrong parameters count NNFXAutoTrade.mq4 363 14
> 'OrderSymbol' - undeclared identifier NNFXAutoTrade.mq4 365 13
> ')' - expression expected NNFXAutoTrade.mq4 365 25
> implicit conversion from 'number' to 'string' NNFXAutoTrade.mq4 365 13
> 'OrderOpenTime' - undeclared identifier NNFXAutoTrade.mq4 367 49
> ')' - expression expected NNFXAutoTrade.mq4 367 63
> 'OrderOpenTime' - undeclared identifier NNFXAutoTrade.mq4 369 28
> ')' - expression expected NNFXAutoTrade.mq4 369 42
> 'Time' - undeclared identifier NNFXAutoTrade.mq4 369 44
> '[' - array required NNFXAutoTrade.mq4 369 48
> 'iATR' - wrong parameters count NNFXAutoTrade.mq4 374 26
> 'iATR' - wrong parameters count NNFXAutoTrade.mq4 376 26
> 'OrderType' - undeclared identifier NNFXAutoTrade.mq4 378 16
> ')' - expression expected NNFXAutoTrade.mq4 378 26
> 'OP_BUY' - undeclared identifier NNFXAutoTrade.mq4 378 29
> 'Close' - undeclared identifier NNFXAutoTrade.mq4 380 36
> '[' - array required NNFXAutoTrade.mq4 380 41
> 'OrderOpenPrice' - undeclared identifier NNFXAutoTrade.mq4 380 47
> ')' - expression expected NNFXAutoTrade.mq4 380 62
> '*' - open parenthesis expected NNFXAutoTrade.mq4 384 62
> 'OrderStopLoss' - undeclared identifier NNFXAutoTrade.mq4 389 40
> ')' - expression expected NNFXAutoTrade.mq4 389 54
> 'Close' - undeclared identifier NNFXAutoTrade.mq4 393 51
> '[' - array required NNFXAutoTrade.mq4 393 56
> 102 errors, 3 warnings 100 4
> ```

![Jose Alberto Pupo Pascoa](https://c.mql5.com/avatar/2020/9/5F5A426F-AE9E.png "Jose Alberto Pupo Pascoa")

**[Jose Alberto Pupo Pascoa](/en/users/awjp)**
|
29 Aug 2020 at 10:50

**Pankaj S:**  

Compilation failed. Error

....

102 errors, 3 warnings 100 4

Hi Pankaj S,

It builds without any error.

Take some time to learn programming before jump forward and assume authors are dumb to the point of producing 102 errors in [published product](/en/articles/385 "Article: How to Post a Product in the Market"). Not common.

But I did not test the expert itself because I am a disbeliever of Mr. VP theories after learning about them for a few months.

![Pankaj S](https://c.mql5.com/avatar/avatar_na2.png "Pankaj S")

**[Pankaj S](/en/users/pankaj5043)**
|
30 Aug 2020 at 12:46

Sorry, I was runnning on different platform MQ5

**Jose Alberto Pupo Pascoa:**  

Hi Pankaj S,

It builds without any error.

Take some time to learn programming before jump forward and assume authors are dumb to the point of producing 102 errors in [published product](/en/articles/385 "Article: How to Post a Product in the Market"). Not common.

But I did not test the expert itself because I am a disbeliever of Mr. VP theories after learning about them for a few months.

![Yusuf Lateef](https://c.mql5.com/avatar/2022/10/63518c83-68fe.jpg "Yusuf Lateef")

**[Yusuf Lateef](/en/users/bigyusufff)**
|
29 Oct 2020 at 10:24

This is amazing... will test it and give you feedback

![JinQuan 777](https://c.mql5.com/avatar/2025/10/68E4A44C-D55E.png "JinQuan 777")

**[JinQuan 777](/en/users/jinquan777)**
|
7 Oct 2025 at 07:56

do you have similar code for MT5?  
I'm looking for auto be (move sl to entry point) function when the [order placed](https://www.mql5.com/en/docs/constants/errorswarnings/enum_trade_return_codes "MQL5 Documentation: Order Placed") hits a certain amount of profit (by pips)

![5Mins Rsi Cci Ma Expert](https://c.mql5.com/i/code/expert.png)
[5Mins Rsi Cci Ma Expert](/en/code/30543)

This Expert Advisor based on Relative Strenght Index, Commodity Channel Index and Moving Averages MT4 Indicator for Signal.
Please test in Demo Account first.
Regards.

![Currency Strength](https://c.mql5.com/i/code/expert.png)
[Currency Strength](/en/code/30349)

"Currency Strength" EA finds the strongest\weakest currency from 8 major currencies and trades with moving averages, has Trailing Stop Loss &Take Profit works on all time frames major Forex pairs.

![5Mins Envelopes Scalping](https://c.mql5.com/i/code/expert.png)
[5Mins Envelopes Scalping](/en/code/30561)

This Expert Advisor based on Envelopes indicator from MT4, my best TimeFrame is 5 Minutes on GBPUSD.

![VR Watch List and Linker Lite](https://c.mql5.com/i/code/expert.png)
[VR Watch List and Linker Lite](/en/code/30601)

Synchronous change of a trading instrument in all charts