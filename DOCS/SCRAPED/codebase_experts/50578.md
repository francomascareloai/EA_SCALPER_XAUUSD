# CCI beginner tutorial by William210 - indicator for MetaTrader 5

Source: https://www.mql5.com/en/code/50578

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/50578) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# CCI beginner tutorial by William210 - indicator for MetaTrader 5

[Gerard William G J B M Dinh Sy](/en/users/william210)  |
[English](javascript:void(false);)

[Ð ÑƒÑÑÐºÐ¸Ð¹](/ru/code/50578) [ä¸­æ–‡](/zh/code/50578) [EspaÃ±ol](/es/code/50578) [Deutsch](/de/code/50578) [æ—¥æœ¬èªž](/ja/code/50578) [PortuguÃªs](/pt/code/50578) [í•œêµ­ì–´](/ko/code/50578) [FranÃ§ais](/fr/code/50578) [Italiano](/it/code/50578) [TÃ¼rkÃ§e](/tr/code/50578)

Views:
:   5077

Rating:
:   (8)

Published:
:   1 July 2024, 07:36

Updated:
:   2 July 2024, 07:35
:   [CCI beginner tutorial by William210.mq5](/en/code/download/50578/cci_beginner_tutorial_by_william210.mq5 "CCI beginner tutorial by William210.mq5")
    (7.94 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/50578.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

My apologies, this code is no longer available and I don't know how to remove/hide it from codebase

[![CCI beginner tutorial by William210](https://c.mql5.com/18/155/CCI_beginner_tutorial_by_William210.png "CCI beginner tutorial by William210")](/en/forum/453288)

**Last comments |
[Go to discussion](/en/forum/469390)**
(7)

![Mladen Rakic](https://c.mql5.com/avatar/2016/12/584AE3E8-D1F4.jpg "Mladen Rakic")

**[Mladen Rakic](/en/users/mladen)**
|
1 Jul 2024 at 17:54

**Gerard Willia G J B M Dinh Sy [#](/en/forum/469390#comment_53846115):**  
 Hello and thank you for your feedback

```mql5
 i_Diff = (prev_calculated>0) ? rates_total - prev_calculated + 1 : rates_total;
```

That is the correct code for how many bars to copy (including the current, still opened, bar)

![Gerard William G J B M Dinh Sy](https://c.mql5.com/avatar/2023/8/64ccdcc6-13d0.jpg "Gerard William G J B M Dinh Sy")

**[Gerard William G J B M Dinh Sy](/en/users/william210)**
|
1 Jul 2024 at 19:05

I'm sorry, I don't mean to go against your ideas, your experience is much greater than mine.

However, your code fix is not entirely correct in my context.

It would work if I wanted the values to be updated [every tick](https://www.mql5.com/en/articles/239 "Article: The Fundamentals of Testing in MetaTrader 5 "), which is not my intention, as specified in my code

```mql5
 // --- With this code, the average (plot) is only updated when a new bar is opened
 if ( prev_calculated < rates_total)
```

On the other hand, indeed, if we remove the 'new bar' condition, your code is fully functional.

And there, indeed, it is necessary to add Â  +1 Â  has Â  prev\_calculated Â  to have good execution.

But again, it was not my desire to make this update every tick.

My intention was to only update the indicator when a new bar is opened, hence my initial choice of code.

```mql5
 //if( prev_calculated < rates_total)
 //{ 
Â Â  // --- Optimization to only take into account the new bar 
Â Â  //i_Diff = rates_total - prev_calculated; 
Â Â i_Diff = (prev_calculated > 0 )
Â Â Â Â Â Â Â Â Â Â  ? rates_total - prev_calculated + 1 
Â Â Â Â Â Â Â Â Â Â  : rates_total;
 //}
```

In my choice, Â  i\_Diff = rates\_total - prev\_calculated Â  works great, including on new bars after initial run.

![Mladen Rakic](https://c.mql5.com/avatar/2016/12/584AE3E8-D1F4.jpg "Mladen Rakic")

**[Mladen Rakic](/en/users/mladen)**
|
1 Jul 2024 at 20:45

**Gerard Willia G J B M Dinh Sy [#](/en/forum/469390#comment_53846888):**  

I'm sorry, I don't mean to go against your ideas, your experience is much greater than mine.

However, your code fix is not entirely correct in my context.

It would work if I wanted the values to be updated [every tick](/en/articles/239 "Article: The Fundamentals of Testing in MetaTrader 5 "), which is not my intention, as specified in my code

On the other hand, indeed, if we remove the 'new bar' condition, your code is fully functional.

And there, indeed, it is necessary to add Â  +1 Â  has Â  prev\_calculated Â  to have good execution.

But again, it was not my desire to make this update every tick.

My intention was to only update the indicator when a new bar is opened, hence my initial choice of code.

In my choice, Â  i\_Diff = rates\_total - prev\_calculated Â  works great, including on new bars after initial run.

Do whatever you want to do.Â  But the way you wrote that code you have an error that is going to show wrong values for each bar formed after the initial run (that is going to be a classical case of repainting)

all the best

![Gerard William G J B M Dinh Sy](https://c.mql5.com/avatar/2023/8/64ccdcc6-13d0.jpg "Gerard William G J B M Dinh Sy")

**[Gerard William G J B M Dinh Sy](/en/users/william210)**
|
1 Jul 2024 at 21:18

I'm too angry to answer you calmly, but the subject remains open. Would come back

![Mladen Rakic](https://c.mql5.com/avatar/2016/12/584AE3E8-D1F4.jpg "Mladen Rakic")

**[Mladen Rakic](/en/users/mladen)**
|
1 Jul 2024 at 21:48

**Gerard Willia G J B M Dinh Sy [#](/en/forum/469390#comment_53848012):**  
 I'm too angry to answer you calmly, but the subject remains open. Would come back

You are "too angry to answer calmly"? ðŸ˜€ðŸ˜€ðŸ˜€

* Your initial run values are drawn using states "at the close" of the bar
* Then all of a sudden you update values only "on open of a new" bar

+ And then, on each time frame or symbol change, those "on open of a new bar" values are miraculously going to disappear and they are all going to become "at the close" again

> > [![](https://c.mql5.com/3/438/Capture__6.png)](https://c.mql5.com/3/438/Capture__5.png "https://c.mql5.com/3/438/Capture__5.png")
> >
> > [![](https://c.mql5.com/3/438/Capture__9.png)](https://c.mql5.com/3/438/Capture__8.png "https://c.mql5.com/3/438/Capture__8.png")

Save your self and all of us time and correct your code(s) to beÂ consistent in all usage conditions - otherwise it falls into a basic definition of repainting indicator(s)

![Linear Regression Value (apply to)](https://c.mql5.com/i/code/indicator.png)
[Linear Regression Value (apply to)](/en/code/50569)

Linear Regression Value indicator with an option that allows it to be applied to another indicator

![Bollinger Bands with post outer band smoothing](https://c.mql5.com/i/code/indicator.png)
[Bollinger Bands with post outer band smoothing](/en/code/50552)

Bollinger Bands with controllable outer band smoothing (post smoothing)

![ZigZag auto Fibo](https://c.mql5.com/i/code/indicator.png)
[ZigZag auto Fibo](/en/code/50652)

This indicator is designed to draw a Fibonacci retracement, using as a basis the ZigZag indicator.

![SL-TP Values](https://c.mql5.com/i/code/indicator.png)
[SL-TP Values](/en/code/50653)

Indicator displays the value of defined stop loss and or take profit in the deposit currency.
Note: It calculates an estimated value based on a simple calculation and does not take into account brokerage commissions.