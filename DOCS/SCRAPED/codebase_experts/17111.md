# ColorXdinMA_Alert - indicator for MetaTrader 5

Source: https://www.mql5.com/en/code/17111

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/17111) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# ColorXdinMA\_Alert - indicator for MetaTrader 5

[Nikolay Kositsin](/en/users/godzilla)  |
[English](javascript:void(false);)

[Русский](/ru/code/17111) [中文](/zh/code/17111) [Español](/es/code/17111) [Deutsch](/de/code/17111) [日本語](/ja/code/17111) [Português](/pt/code/17111)

Views:
:   8533

Rating:
:   (19)

Published:
:   26 January 2017, 09:28

Updated:
:   29 March 2023, 13:47
:   [ColorXdinMA\_Alert.mq5](/en/code/download/17111/ColorXdinMA_Alert.mq5 "ColorXdinMA_Alert.mq5")
    (32.36 KB)
    [view](# "view")

    \MQL5\Include\

    [SmoothAlgorithms.mqh](/en/code/download/17111/SmoothAlgorithms.mqh "SmoothAlgorithms.mqh")
    (130.2 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/17111.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

**Real Author:** dimeon

The [ColorXdinMA](/en/code/700) trend moving average, which features alerts, sending emails and push-notifications to mobile devices.

The following changes have been made to the indicator code in order to implement the alerts, email messages and push-notifications:

1. Enumeration for the options of indicator signal generation is declared at the global scope before the input variables are declared.

   //+----------------------------------------------------+  
   //| Enumeration for signal generation options   |  
   //+----------------------------------------------------+
2. Introduced new input parameters

   //---- Input variables for alerts  
   input ENUM\_SIGNAL\_MODE SignMode=MODE\_SIGNAL; //Signal generation mode   
   input uint NumberofBar=1;                    //Number of the bar to generate a signal  
   input bool SoundON=true;                     //Enable alerts  
   input uint NumberofAlerts=2;                 //Number of alerts  
   input bool EMailON=false;                    //Enable mailing the signal  
   input bool PushON=false;                     //Enable sending the signal to mobile devices
3. Added three new functions to the end of the indicator code: BuySignal(), SellSignal() and GetStringTimeframe()

   //+------------------------------------------------------------------+  
   //| Buy signal function                                              |  
   //+------------------------------------------------------------------+  
   void BuySignal(string SignalSirname,// text of the indicator name for email and push messages  
                  double &ColorArray[],// color index buffer  
                  int ColorIndex,// color index in the color index buffer to generate a signal   
                  const int Rates\_total,     // the current number of bars  
                  const int Prev\_calculated, // the number of bars on the previous tick  
                  const double &Close[],     // close price  
                  const int &Spread[])       // spread  
     {  
   //---  
      static uint counter=0;  
      if(Rates\_total!=Prev\_calculated) counter=0;  
     
      bool BuySignal=false;  
      bool SeriesTest=ArrayGetAsSeries(ColorArray);  
      int index,index1;  
      if(SeriesTest)  
        {  
         index=int(NumberofBar);  
         index1=index+1;  
        }  
      else  
        {  
         index=Rates\_total-int(NumberofBar)-1;  
         index1=index-1;  
        }  
      if(SignMode==MODE\_SIGNAL)  
        {  
         if(ColorArray[index1]!=ColorIndex && ColorArray[index]==ColorIndex) BuySignal=true;  
        }  
      else  
        {  
         if(ColorArray[index]==ColorIndex) BuySignal=true;  
        }  
      if(BuySignal && counter<=NumberofAlerts)  
        {  
         counter++;  
         MqlDateTime tm;  
         TimeToStruct(TimeCurrent(),tm);  
         string text=TimeToString(TimeCurrent(),TIME\_DATE)+" "+string(tm.hour)+":"+string(tm.min);  
         SeriesTest=ArrayGetAsSeries(Close);  
         if(SeriesTest) index=int(NumberofBar);  
         else index=Rates\_total-int(NumberofBar)-1;  
         double Ask=Close[index];  
         double Bid=Close[index];  
         SeriesTest=ArrayGetAsSeries(Spread);  
         if(SeriesTest) index=int(NumberofBar);  
         else index=Rates\_total-int(NumberofBar)-1;  
         Bid+=\_Point\*Spread[index];  
         string sAsk=DoubleToString(Ask,\_Digits);  
         string sBid=DoubleToString(Bid,\_Digits);  
         string sPeriod=GetStringTimeframe(ChartPeriod());  
         if(SignMode==MODE\_SIGNAL || (SignMode==MODE\_TREND && ColorArray[index1]!=ColorIndex))  
           {  
            if(SoundON) Alert("BUY signal \n Ask=",Ask,"\n Bid=",Bid,"\n currtime=",text,"\n Symbol=",Symbol()," Period=",sPeriod);  
            if(EMailON) SendMail(SignalSirname+": BUY signal alert","BUY signal at Ask="+sAsk+", Bid="+sBid+", Date="+text+" Symbol="+Symbol()+" Period="+sPeriod);  
            if(PushON) SendNotification(SignalSirname+": BUY signal at Ask="+sAsk+", Bid="+sBid+", Date="+text+" Symbol="+Symbol()+" Period="+sPeriod);  
           }  
         else  
           {  
            if(SoundON) Alert("Up Trend signal \n Ask=",Ask,"\n Bid=",Bid,"\n currtime=",text,"\n Symbol=",Symbol()," Period=",sPeriod);  
            if(EMailON) SendMail(SignalSirname+": Up Trend signal alert","BUY signal at Ask="+sAsk+", Bid="+sBid+", Date="+text+" Symbol="+Symbol()+" Period="+sPeriod);  
            if(PushON) SendNotification(SignalSirname+": Up Trend signal at Ask="+sAsk+", Bid="+sBid+", Date="+text+" Symbol="+Symbol()+" Period="+sPeriod);  
           }  
        }  
     
   //---  
     }  
   //+------------------------------------------------------------------+  
   //| Sell signal function                                             |  
   //+------------------------------------------------------------------+  
   void SellSignal(string SignalSirname,// text of the indicator name for email and push messages  
                   double &ColorArray[],       // color index buffer  
                   int ColorIndex,             // color index in the color index buffer to generate a signal  
                   const int Rates\_total,     // the current number of bars  
                   const int Prev\_calculated, // the number of bars on the previous tick  
                   const double &Close[],     // close price  
                   const int &Spread[])       // spread  
     {  
   //---  
      static uint counter=0;  
      if(Rates\_total!=Prev\_calculated) counter=0;  
     
      bool SellSignal=false;  
      bool SeriesTest=ArrayGetAsSeries(ColorArray);  
      int index,index1;  
      if(SeriesTest)  
        {  
         index=int(NumberofBar);  
         index1=index+1;  
        }  
      else  
        {  
         index=Rates\_total-int(NumberofBar)-1;  
         index1=index-1;  
        }  
     
      if(SignMode==MODE\_SIGNAL)  
        {  
         if(ColorArray[index1]!=ColorIndex && ColorArray[index]==ColorIndex) SellSignal=true;  
        }  
      else  
        {  
         if(ColorArray[index]==ColorIndex) SellSignal=true;  
        }  
      if(SellSignal && counter<=NumberofAlerts)  
        {  
         counter++;  
         MqlDateTime tm;  
         TimeToStruct(TimeCurrent(),tm);  
         string text=TimeToString(TimeCurrent(),TIME\_DATE)+" "+string(tm.hour)+":"+string(tm.min);  
         SeriesTest=ArrayGetAsSeries(Close);  
         if(SeriesTest) index=int(NumberofBar);  
         else index=Rates\_total-int(NumberofBar)-1;  
         double Ask=Close[index];  
         double Bid=Close[index];  
         SeriesTest=ArrayGetAsSeries(Spread);  
         if(SeriesTest) index=int(NumberofBar);  
         else index=Rates\_total-int(NumberofBar)-1;  
         Bid+=\_Point\*Spread[index];  
         string sAsk=DoubleToString(Ask,\_Digits);  
         string sBid=DoubleToString(Bid,\_Digits);  
         string sPeriod=GetStringTimeframe(ChartPeriod());  
         if(SignMode==MODE\_SIGNAL || (SignMode==MODE\_TREND && ColorArray[index1]!=ColorIndex))  
           {  
            if(SoundON) Alert("SELL signal \n Ask=",Ask,"\n Bid=",Bid,"\n currtime=",text,"\n Symbol=",Symbol()," Period=",sPeriod);  
            if(EMailON) SendMail(SignalSirname+": SELL signal alert","SELL signal at Ask="+sAsk+", Bid="+sBid+", Date="+text+" Symbol="+Symbol()+" Period="+sPeriod);  
            if(PushON) SendNotification(SignalSirname+": SELL signal at Ask="+sAsk+", Bid="+sBid+", Date="+text+" Symbol="+Symbol()+" Period="+sPeriod);  
           }  
         else  
           {  
            if(SoundON) Alert("Down trend signal \n Ask=",Ask,"\n Bid=",Bid,"\n currtime=",text,"\n Symbol=",Symbol()," Period=",sPeriod);  
            if(EMailON) SendMail(SignalSirname+": Down trend signal alert","SELL signal at Ask="+sAsk+", Bid="+sBid+", Date="+text+" Symbol="+Symbol()+" Period="+sPeriod);  
            if(PushON) SendNotification(SignalSirname+": Down trend signal at Ask="+sAsk+", Bid="+sBid+", Date="+text+" Symbol="+Symbol()+" Period="+sPeriod);  
           }  
        }  
   //---  
     }  
   //+------------------------------------------------------------------+  
   //| Getting the timeframe as a string |  
   //+------------------------------------------------------------------+  
   string GetStringTimeframe(ENUM\_TIMEFRAMES timeframe)  
     {  
   //----  
      return(StringSubstr(EnumToString(timeframe),7,-1));  
   //----  
     }
4. Added a couple of calls to BuySignal() and SellSignal() functions after the indicator calculation cycles in the OnCalculate() block   

   //---      
      BuySignal("ColorXdinMA\_Alert",ColorXdinMA,1,rates\_total,prev\_calculated,close,spread);  
      SellSignal("ColorXdinMA\_Alert",ColorXdinMA,2,rates\_total,prev\_calculated,close,spread);  
   //---

Where ColorXdinMA is the name of the color index buffer for storing indicator colors. Values 1 and 2 are the numbers of colors in this buffer, at which the moving average is ascending or descending, respectively.

It is assumed that the only one call to the BuySignal() and SellSignal() functions will be used in the OnCalculate() block of the indicator code.

The indicator uses the classes of SmoothAlgorithms.mqh library (copy it to **<terminal\_data\_folder>**\MQL5\Include). The use of the classes was thoroughly described in the article ["Averaging Price Series for Intermediate Calculations Without Using Additional Buffers"](/en/articles/180).

![Fig1. The ColorXdinMA_Alert indicator on the chart](https://c.mql5.com/18/55/picture_1__4.png "Fig1. The ColorXdinMA_Alert indicator on the chart")

Fig1. The ColorXdinMA\_Alert indicator on the chart

![Fig.2. The ColorXdinMA_Alert indicator. Generating alert for breakout signal](https://c.mql5.com/18/55/picture_2__4.png "Fig.2. The ColorXdinMA_Alert indicator. Generating alert for breakout signal")

Fig.2. The ColorXdinMA\_Alert indicator. Generating alert for breakout signal

![Fig.3. The ColorXdinMA_Alert indicator. Generating alert for trend signal](https://c.mql5.com/18/55/picture_3__1.png "Fig.3. The ColorXdinMA_Alert indicator. Generating alert for trend signal")

Fig.3. The ColorXdinMA\_Alert indicator. Generating alert for trend signal

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/17111](/ru/code/17111)

**Last comments |
[Go to discussion](/en/forum/168194)**
(1)

![Andrew Brunier Vasconcelos](https://c.mql5.com/avatar/avatar_na2.png "Andrew Brunier Vasconcelos")

**[Andrew Brunier Vasconcelos](/en/users/andrewbrunier)**
|
11 Aug 2023 at 17:50

Good afternoon, I was wondering if you could help me please, I wanted a code for ea in mql5, to [send](https://www.mql5.com/en/docs/network/sendnotification "MQL5 documentation: SendNotification function") personalised [notifications](https://www.mql5.com/en/docs/network/sendnotification "MQL5 documentation: SendNotification function") to the mobile phone...  
 I tried to make the structures but I don't know which are the correct parameters to use...

These notifications would help me a lot, I think it's something simple, so if you can help me I'd really appreciate it, thanks...

Good afternoon, I wanted to know if you could help me please, I wanted a code for ea in mql5, to send personalised notifications to the cell phone...

I tried to make the structures but I don't know what the correct parameters to use...

I wanted something very simple, that a notification was sent when an order was closed, with very simple information such as, "Order Closed (Symbol)/(Profit or Loss) - (Daily Profit)/(Total Profit)".

And I thought of another notification about DrawDown, when it reached a certain value, it would send a message like this, "DrawDown Reached (Value)".

These notifications would help me a lot, I think it's something simple, so if you can help me, I really appreciate it, thank you...

![Fractal_WeightOscillator](https://c.mql5.com/i/code/indicator.png)
[Fractal\_WeightOscillator](/en/code/17109)

Oscillator, representing the weighted smoothed sum of four indicators: Fractal\_RSI, Fractal\_MFI, Fractal\_WPR and Fractal\_DeMarker.

![Fractal_MFI](https://c.mql5.com/i/code/indicator.png)
[Fractal\_MFI](/en/code/17107)

Fractal Money Flow Index.

![FT BillWillams Trader](https://c.mql5.com/i/code/expert.png)
[FT BillWillams Trader](/en/code/17113)

The Expert Advisor based on the iAlligator (Alligator), iMA (Moving Average) indicators.

![ZeroLagEA-AIP v0.0.4](https://c.mql5.com/i/code/expert.png)
[ZeroLagEA-AIP v0.0.4](/en/code/17114)

Trading based on the ZeroLag MACD custom indicator.