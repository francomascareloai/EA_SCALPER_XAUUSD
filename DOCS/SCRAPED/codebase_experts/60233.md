# Partial close Sell Orders - script for MetaTrader 5

Source: https://www.mql5.com/en/code/60233

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/60233) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# Partial close Sell Orders - script for MetaTrader 5

[Muhammad Syamil Bin Abdullah](/en/users/matfx)  |
[English](javascript:void(false);)

[Русский](/ru/code/60233) [中文](/zh/code/60233) [Español](/es/code/60233) [Deutsch](/de/code/60233) [日本語](/ja/code/60233) [Português](/pt/code/60233) [한국어](/ko/code/60233) [Français](/fr/code/60233) [Italiano](/it/code/60233) [Türkçe](/tr/code/60233)

Views:
:   3631

Rating:
:   (3)

Published:
:   8 June 2025, 14:56

Updated:
:   8 June 2025, 15:02
:   [Partial Close Sell Orders.mq5](/en/code/download/60233/partial_close_sell_orders.mq5 "Partial Close Sell Orders.mq5")
    (3.99 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/60233.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The main purpose of this script is to close partially open sell orders (Which is in profits) and let the other running orders close in target profits. Check the Experts tab for the info after executed.

![](https://c.mql5.com/18/163/partial_close_sell_order.JPG)

## How to Use This Script:

1. **Input Parameters**:

   * ClosePercentage : The percentage of each sell position you want to close (0-100)
   * Slippage : Maximum allowed slippage in points
   * CommentText : If you want to close only positions with a specific comment (leave empty for all sell positions)
2. **Features**:

   * Works with multiple sell positions
   * Preserves stop loss and take profit levels for the remaining position
   * Validates minimum volume requirements
   * Handles errors and provides feedback
3. **Installation**:

   * Copy the code to MetaEditor
   * Compile it (F7)
   * The script will appear in the Navigator panel under "Scripts"
   * Drag it to any chart to execute
4. **Notes**:

   * The script will close the specified percentage of ALL sell positions unless you filter by comment
   * It uses FOK (Fill or Kill) execution type to ensure the entire partial close is filled at once
   * The remaining position will keep its original SL/TP levels
   * Make sure to test in a demo account first.

**Last comments |
[Go to discussion](/en/forum/488531)**
(1)

![aljinaahi](https://c.mql5.com/avatar/2025/4/67f97530-df14.jpg "aljinaahi")

**[aljinaahi](/en/users/aljinaahi)**
|
11 Jun 2025 at 20:53

* Maintains stop loss and [take profit levels](https://www.mql5.com/en/docs/constants/tradingconstants/orderproperties#enum_order_property_double "MQL5 documentation:") for the remaining position.

------------------------------------------------------  
 If the stop loss and take profit are increased by the percentage of the partial closing

![Partial Close Buy Orders](https://c.mql5.com/i/code/script.png)
[Partial Close Buy Orders](/en/code/60232)

Script for partially close active buy orders

![Daily Trend](https://c.mql5.com/i/code/indicator.png)
[Daily Trend](/en/code/56909)

Indicator that displays the day's trend at any chart time. You can customise the colours and position of the text on the screen.

![Divergence Awesome Ocilator](https://c.mql5.com/i/code/indicator.png)
[Divergence Awesome Ocilator](/en/code/56820)

This MQL5 custom indicator detects divergences between price action and the Awesome Oscillator (AO), signalling potential market reversals or continuations. It plots buy/sell arrows on the chart, displays the AO as a histogram, and draws trendlines to highlight divergences.

![Tuyul GAP](https://c.mql5.com/i/code/expert.png)
[Tuyul GAP](/en/code/60347)

Trading Gap Weekend, is it profitable?