# Using Moving Averages with an EA (Sample Source Code) - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/46426

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/46426) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Using Moving Averages with an EA (Sample Source Code) - expert for MetaTrader 4

[Lo Thi Mai Loan](/en/users/lothimailoan)

Views:
:   17437

Rating:
:   (4)

Published:
:   16 September 2023, 14:50
:   [EA - Moving Average.mq4](/en/code/download/46426/ea_-_moving_average.mq4 "EA - Moving Average.mq4")
    (11.68 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/46426.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

### **1. ENTRY RULE**

Long Entry: We will enter long positions on the Golden Cross.

1. The value of the previous moving average is higher than the shorter-term moving average.
2. The value of the moving average two periods ago is lower than the shorter-term moving average.
3. The value of the moving average two periods ago is lower than the value of the previous short-term moving average.

If these three conditions are met, we consider it a Golden Cross and enter a long position.

Short Entry: We will enter short positions on the Dead Cross.

1. The value of the previous moving average is lower than the shorter-term moving average.
2. The value of the moving average two periods ago is higher than the shorter-term moving average.
3. The value of the moving average two periods ago is higher than the value of the previous short-term moving average.

If these three conditions are met, we consider it a Dead Cross and enter a short position.

### 2. EXIT RULE

Entry orders are managed only with stop loss orders and take profit limit orders.

The stop loss point is set at a distance of Stoploss value from the mid-term MA.

Take profit Limit orders are set at the same distance as stop orders but on the positive side, also serving fairness.

### 3. BACKTEST RESULT

**Last comments |
[Go to discussion](/en/forum/454159)**
(7)

![miarajas](https://c.mql5.com/avatar/avatar_na2.png "miarajas")

**[miarajas](/en/users/miarajas)**
|
20 Sep 2023 at 08:58

Thanks for your efforts and excellent EA

Does your EA [execute trades](https://www.mql5.com/en/docs/constants/tradingconstants/orderproperties "MQL5 documentation:") automatically once it is installed and activated on Meta Trader 4?

![Lo Thi Mai Loan](https://c.mql5.com/avatar/2024/5/663b6b65-89b1.png "Lo Thi Mai Loan")

**[Lo Thi Mai Loan](/en/users/lothimailoan)**
|
20 Sep 2023 at 10:00

**miarajas [#](/en/forum/454159#comment_49435176):** Thanks for your efforts and excellent EA. Does your EA [execute trades](/en/docs/constants/tradingconstants/orderproperties "MQL5 documentation:") automatically once it is installed and activated on Meta Trader 4?

Yes. You install it into MT4 and EM will automatically trade In addition, you can customize the code to your liking for further optimization.

![Kway Yee Siang](https://c.mql5.com/avatar/2021/11/6193CF26-C590.png "Kway Yee Siang")

**[Kway Yee Siang](/en/users/alexkway)**
|
21 Sep 2023 at 03:05

Thanks for your [code sharing](/go?link=https://forge.mql5.io/help/en/guide "MQL5 Algo Forge: Cloud Workspace for Algorithmic Trading Development")! With optimizations it would work well on all instruments

![diegobincoletto](https://c.mql5.com/avatar/avatar_na2.png "diegobincoletto")

**[diegobincoletto](/en/users/diegobincoletto)**
|
3 Jan 2025 at 23:48

I'm learning MQL4, this is a great help, thank you.

I would like to make a control panel adding buttons to start and stop the [automatic trading](/en/book "Book \"MQL5 Programming for Traders\"") as well as a field to set the lots and few other parameters.

Would you be kind to share some code showing how create such objects?

I'm not asking you to modify your EA, some simple code example would be enough, I will then try to implement the functions in your code.

![Michael Charles Schefe](https://c.mql5.com/avatar/2021/5/60ADC6A5-6810.gif "Michael Charles Schefe")

**[Michael Charles Schefe](/en/users/ausimike)**
|
3 Jan 2025 at 23:59

**diegobincoletto [#](/en/forum/454159#comment_55535140):**  

I would like to make a control panel adding buttons to start and stop the [automatic trading](/en/book "Book \"MQL5 Programming for Traders\"") as well as a field to set the lots and few other parameters.

Would you be kind to share some code showing how create such objects?

I'm not asking you to modify your EA, some simple code example would be enough, I will then try to implement the functions in your code.

there is a few good examples in your terminal navigator that you can use. There is also some great examples in the codebase.

![MaybeAwo EA](https://c.mql5.com/i/code/expert.png)
[MaybeAwo EA](/en/code/46314)

a Versatile automated trading tool for the MetaTrader 4 platform. This EA is designed to assist traders in managing their positions effectively by offering features such as setting a breakeven point, trailing stop, stop loss, and take profit levels. It works with various input parameters, allowing you to customize its behavior to fit your trading strategy.

![Probability and Signals class](https://c.mql5.com/i/code/library.png)
[Probability and Signals class](/en/code/46135)

With these classes you can create and test your signals runtime.

![Super Scalper EMAs](https://c.mql5.com/i/code/expert.png)
[Super Scalper EMAs](/en/code/46546)

Low risk, max profit, winning strategy EA. Based upon Super Scalper EMAs indicator

![Breakout Martin Gale Expert Advisor for mql4](https://c.mql5.com/i/code/expert.png)
[Breakout Martin Gale Expert Advisor for mql4](/en/code/46592)

This is an mql5 Expert Advisor trading the breakouts and using Martin Gale risk management.