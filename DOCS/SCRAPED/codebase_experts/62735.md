# A powerful and feature-rich JSON library for MQL5, designed to bring a modern development experience similar to Python/JS - library for MetaTrader 5

Source: https://www.mql5.com/en/code/62735

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/62735) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Libraries](https://c.mql5.com/i/code/library.png)

# A powerful and feature-rich JSON library for MQL5, designed to bring a modern development experience similar to Python/JS - library for MetaTrader 5

[Dao Liang Ding](/en/users/ding9736)  |
[English](javascript:void(false);)

[Русский](/ru/code/62735) [中文](/zh/code/62735) [Español](/es/code/62735) [Deutsch](/de/code/62735) [日本語](/ja/code/62735) [Português](/pt/code/62735) [한국어](/ko/code/62735) [Français](/fr/code/62735) [Italiano](/it/code/62735) [Türkçe](/tr/code/62735)

Views:
:   3451

Rating:
:   (3)

Published:
:   17 August 2025, 16:45

Updated:
:   18 August 2025, 06:36
:   [JsonCore.mqh](/en/code/download/62735/jsoncore.mqh "JsonCore.mqh")
    (2.18 KB)
    [view](# "view")

    [JsonNode.mqh](/en/code/download/62735/jsonnode.mqh "JsonNode.mqh")
    (5.67 KB)
    [view](# "view")

    [JsonParser.mqh](/en/code/download/62735/jsonparser.mqh "JsonParser.mqh")
    (3.27 KB)
    [view](# "view")

    [JsonSerializer.mqh](/en/code/download/62735/jsonserializer.mqh "JsonSerializer.mqh")
    (9.77 KB)
    [view](# "view")

    [JsonStream.mqh](/en/code/download/62735/jsonstream.mqh "JsonStream.mqh")
    (4.82 KB)
    [view](# "view")

    [JsonStreamParser.mqh](/en/code/download/62735/jsonstreamparser.mqh "JsonStreamParser.mqh")
    (3.05 KB)
    [view](# "view")

    [JsonTypes.mqh](/en/code/download/62735/jsontypes.mqh "JsonTypes.mqh")
    (16.29 KB)
    [view](# "view")

    [JsonUtils.mqh](/en/code/download/62735/jsonutils.mqh "JsonUtils.mqh")
    (3.87 KB)
    [view](# "view")

    [JsonDocument.mqh](/en/code/download/62735/jsondocument.mqh "JsonDocument.mqh")
    (6.93 KB)
    [view](# "view")

    [JsonApiImpl.mqh](/en/code/download/62735/jsonapiimpl.mqh "JsonApiImpl.mqh")
    (33.47 KB)
    [view](# "view")

    [JsonPath.mqh](/en/code/download/62735/jsonpath.mqh "JsonPath.mqh")
    (23.42 KB)
    [view](# "view")

    [Test\_JsonLib\_Script.mq5](/en/code/download/62735/test_jsonlib_script.mq5 "Test_JsonLib_Script.mq5")
    (12.91 KB)
    [view](# "view")

    [JsonLib.mqh](/en/code/download/62735/jsonlib.mqh "JsonLib.mqh")
    (34.62 KB)
    [view](# "view")

    [Expand (13)](javascript:void(false))
    [Collapse (13)](javascript:void(false))

    [Download as ZIP](/en/code/download/62735.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

**1. Overview**

The MQL5 JSON Library is a powerful,feature-rich library designed specifically for parsing, manipulating, and serializing JSON data within the MQL5 environment. It provides a simple and intuitive Document Object Model (DOM) API, aiming to make the JSON handling experience in MQL5 comparable to modern programming languages like JavaScript and Python.

This library is capable of handling a wide range of tasks, from reading simple EA configurations to complex real-time data exchange between systems. Its main functions and features include:

* --- Parsing and Creation ---
* **Load from String or File**: Reliably parses JSON text into manipulable in-memory objects ( JsonParse , JsonFromFile ).
* **Build from Scratch**: Easily create new JSON objects and arrays programmatically using concise APIs like JsonNewObject and JsonNewArray .
* **Flexible Parser**: Optionally supports some non-standard features of JSON5, such as code comments and trailing commas, to enhance compatibility with various data sources.
* --- Manipulation and Access ---
* **Intuitive DOM Traversal**: Access data using intuitive syntax with keys ( node["key"] ) and indices ( node[0] ), just like using a Python dictionary or a JavaScript object.
* **Safe Type Conversion**: Provides a series of methods with default values, such as AsInt(defaultValue) and AsString(defaultValue) , allowing you to safely extract data of the desired type from a node without worrying about program crashes due to type mismatches or non-existent paths.
* **Dynamic Modification**: Freely add, update, or delete key-value pairs in JSON objects and elements in arrays ( Set , Add , Remove ).

  --- Advanced Querying and Processing ---
* **Powerful Query Engine**: Built-in support for **JSON Pointer** (RFC 6901, for direct path access) and **JSONPath** (for complex and fuzzy queries), enabling efficient extraction of one or more data nodes from deeply nested, complex structures, either in bulk or with precision.
* **Low-Memory Stream Parsing**: Provides JsonStreamParser for processing gigabyte-scale, huge JSON files. It reads the file token by token in an event stream manner without loading the entire file into memory, thus achieving ultimate memory efficiency.
* **Utility Functions**: Offers advanced features like document cloning ( .Clone() ) and deep merging ( JsonMerge ), which greatly simplify common complex tasks such as merging "default configuration" with "user configuration".

  --- Robustness and Safety ---
* **Automatic Memory Management**: Adopts the RAII (Resource Acquisition Is Initialization) design pattern. JsonDocument is responsible for managing the lifecycle of all its nodes. Developers do not need to manually new / delete any JSON elements, fundamentally eliminating the risk of memory leaks.
* **Cross-Document Operation Safety**: When assigning a node between different JsonDocument instances, the library automatically performs a safe deep copy (Clone), preventing dangling pointers and accidental data corruption.
* **Detailed Error Reporting**: When parsing fails, the JsonError object provides detailed information including the error line number, column number, and context, facilitating rapid problem diagnosis.

**2. Core Concepts & Memory Management**

[!!] 2.1 Namespace - The Key to Integrating Your Project [!!] **Most Important Tip**: All classes in this library (e.g., JsonDocument , JsonNode ) and global functions (e.g., JsonParse ) are encapsulated within a namespace called MQL5\_Json .

\*\*How to Use It Correctly:\*\* - \*\*In Header Files (.mqh)\*\*: MQL5 does not allow `using namespace` in the global scope of header files. \*\*Therefore, you must use fully qualified names\*\*. This is the only reliable way in multi-file projects. Incorrect: `JsonDocument doc;` Correct: `MQL5\_Json::JsonDocument doc;` - \*\*Inside Functions in Main Program Files (.mq5)\*\*: For convenience, you can use `using namespace MQL5\_Json;` inside functions, but to ensure the generality of the examples, all code in this manual will use the fully qualified name approach. \*\*If you encounter the `'JsonNode' - declaration without type` compilation error,\*\* \*\*it is almost always because you forgot to add the `MQL5\_Json::` prefix\*\* \*\*to the types and functions.\*\*

[!!] 2.2 Memory Management Model JsonDocument **owns** the data; JsonNode is just a **view**.

[!!] 2.3 Object Passing in MQL5 MQL5 requires that all class objects (including JsonNode ) passed as function arguments **must be passed by reference (using &)**. Incorrect: void myFunction(MQL5\_Json::JsonNode node) Correct: void myFunction(MQL5\_Json::JsonNode &node

**Last comments |
[Go to discussion](/en/forum/493450)**
(4)

![Le Minh Duc](https://c.mql5.com/avatar/2023/11/6548d3f4-a5a7.jpg "Le Minh Duc")

**[Le Minh Duc](/en/users/nocpinmylf)**
|
17 Aug 2025 at 18:45

Thank you for sharing your work. I'm curious—how does your library compare to [Sergeev’s Json Lib](/en/code/13663) in terms of performance or capabilities?

![hini](https://c.mql5.com/avatar/2024/3/65e98921-0708.jpg "hini")

**[hini](/en/users/hini)**
|
18 Aug 2025 at 06:11

Thank you very much for sharing the code!

![hini](https://c.mql5.com/avatar/2024/3/65e98921-0708.jpg "hini")

**[hini](/en/users/hini)**
|
18 Aug 2025 at 06:30

Advanced Query 4 Verification failed, is this normal?

![hini](https://c.mql5.com/avatar/2024/3/65e98921-0708.jpg "hini")

**[hini](/en/users/hini)**
|
19 Aug 2025 at 03:25

To resolve the issue of validation failure in Advanced Query 4, replace this function in JsonPath.mqh.

```mql5
   void EvaluatePath(const MQL5_Json::JsonNode &root, const string &path, MQL5_Json::JsonNode &out_nodes[], MQL5_Json::JsonError &error)
   {
      MQL5_Json::JsonNode current_nodes[];
      if(root.IsValid())
      {
         ArrayResize(current_nodes,1);
         current_nodes[0] = root;
      }
      Tokenizer tokenizer(path);
      while(true)
      {
         Tokenizer::Token token = tokenizer.NextToken();
         if(token.type == Tokenizer::Eof) break;
         if(token.type == Tokenizer::Error)
         {
            error.message = "Invalid JSONPath token";
            error.context = token.str_val;
            return;
         }
         if(token.type == Tokenizer::Root || token.type == Tokenizer::Dot) continue;
         MQL5_Json::JsonNode next_gen_nodes[];
         for(int i=0; i < ArraySize(current_nodes); i++)
         {
            MQL5_Json::JsonNode current_node = current_nodes[i];
            if(!current_node.IsValid()) continue;
            if(token.type == Tokenizer::Ddot)  // Deep scan from current node
            {
               // Add current node if it has children that will be processed next
               if(current_node.IsObject() || current_node.IsArray())
               {
                  int s=ArraySize(next_gen_nodes);
                  ArrayResize(next_gen_nodes,s+1);
                  next_gen_nodes[s]=current_node;
               }
            }
            else if(token.type == Tokenizer::Id || token.type == Tokenizer::Str)
            {
               if(current_node.IsObject())
               {
                  MQL5_Json::JsonNode child=current_node.Get(token.str_val);
                  if(child.IsValid())
                  {
                     int s=ArraySize(next_gen_nodes);
                     ArrayResize(next_gen_nodes,s+1);
                     next_gen_nodes[s]=child;
                  }
               }
               else if(current_node.IsArray())
               {
                  for(int j=0; j<current_node.Size();j++)
                  {
                     MQL5_Json::JsonNode item=current_node.At(j);
                     if(item.IsObject())
                     {
                        MQL5_Json::JsonNode child=item.Get(token.str_val);
                        if(child.IsValid())
                        {
                           int s=ArraySize(next_gen_nodes);
                           ArrayResize(next_gen_nodes,s+1);
                           next_gen_nodes[s]=child;
                        }
                     }
                  }
               }
            }
            else if(token.type == Tokenizer::Lbr)  // [index] or [*]
            {
               Tokenizer::Token next_token = tokenizer.NextToken();
               if(next_token.type == Tokenizer::Wild) // [*] 
               {
                  Tokenizer::Token rbr_token = tokenizer.NextToken();
                  if(rbr_token.type == Tokenizer::Rbr)
                  {
                     if(current_node.IsArray())
                     {
                        for(int j=0; j<current_node.Size(); j++)
                        {
                           MQL5_Json::JsonNode child=current_node.At(j);
                           if(child.IsValid())
                           {
                              int s=ArraySize(next_gen_nodes);
                              ArrayResize(next_gen_nodes,s+1);
                              next_gen_nodes[s]=child;
                           }
                        }
                     }
                  }
               }
               else if(next_token.type == Tokenizer::Num) // [index] 
               {
                  Tokenizer::Token rbr_token = tokenizer.NextToken();
                  if(rbr_token.type == Tokenizer::Rbr)
                  {
                     if(current_node.IsArray())
                     {
                        int index = (int)next_token.num_val;
                        if(index >= 0 && index < current_node.Size())
                        {
                           MQL5_Json::JsonNode child=current_node.At(index);
                           if(child.IsValid())
                           {
                              int s=ArraySize(next_gen_nodes);
                              ArrayResize(next_gen_nodes,s+1);
                              next_gen_nodes[s]=child;
                           }
                        }
                     }
                  }
               }
               else
               {
                  error.message = "Invalid array access syntax";
                  error.context = "Expected [*] or [index]";
                  return;
               }
            }
            else if(token.type == Tokenizer::Wild)
            {
               if(current_node.IsObject())
               {
                  string k[];
                  current_node.GetKeys(k);
                  for(int j=0;j<ArraySize(k);j++)
                  {
                     MQL5_Json::JsonNode child=current_node.Get(k[j]);
                     if(child.IsValid())
                     {
                        int s=ArraySize(next_gen_nodes);
                        ArrayResize(next_gen_nodes,s+1);
                        next_gen_nodes[s]=child;
                     }
                  }
               }
               else if(current_node.IsArray())
               {
                  for(int j=0; j<current_node.Size(); j++)
                  {
                     MQL5_Json::JsonNode child=current_node.At(j);
                     if(child.IsValid())
                     {
                        int s=ArraySize(next_gen_nodes);
                        ArrayResize(next_gen_nodes,s+1);
                        next_gen_nodes[s]=child;
                     }
                  }
               }
            }
         }
         // [THE FIX] Replace illegal ArrayCopy with a compliant `for` loop
         int size = ArraySize(next_gen_nodes);
         ArrayResize(current_nodes, size);
         for(int i=0; i<size; i++) current_nodes[i] = next_gen_nodes[i];
      }
      // [THE FIX] Replace illegal ArrayCopy with a compliant `for` loop
      int size_out = ArraySize(current_nodes);
      ArrayResize(out_nodes, size_out);
      for(int i=0; i<size_out; i++) out_nodes[i] = current_nodes[i];
   }
```

![Multi_Divergence_EA](https://c.mql5.com/i/code/expert.png)
[Multi\_Divergence\_EA](/en/code/62742)

The EA identifies trade setups by waiting for a user-defined number of indicators (e.g., 2 out of 3) to show divergence simultaneously. This multi-layer confirmation approach filters out market noise.
Key Features:
Triple Confirmation Engine: Analyzes RSI, MACD, & Stochastic divergence.
Advanced Filters: Optional Trend Filter (MA) and Volume Filter for superior signal quality.
Full Customization: Control all indicator settings, divergence sensitivity, and trade logic.
Professional Risk Management: Use fixed lots or percentage-based money management with SL/TP.

![Average Range](https://c.mql5.com/i/code/indicator.png)
[Average Range](/en/code/54247)

It is an indicator that determines target levels according to the average of price movements.

![Spread lister - current, min, max](https://c.mql5.com/i/code/expert.png)
[Spread lister - current, min, max](/en/code/62784)

EA Spread lister shows the current, min and max values for all symbols / instruments.

![Close All Orders](https://c.mql5.com/i/code/expert.png)
[Close All Orders](/en/code/62811)

CloseAllOrders is a powerful and user-friendly Expert Advisor designed to simplify trade management in MetaTrader 5. With an intuitive button interface directly on your chart, you can close all market positions and pending orders instantly with just one click.