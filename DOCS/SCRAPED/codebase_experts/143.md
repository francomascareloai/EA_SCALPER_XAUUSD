# The Hodrick-Prescott Filter - indicator for MetaTrader 5

Source: https://www.mql5.com/en/code/143

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/143) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# The Hodrick-Prescott Filter - indicator for MetaTrader 5

gpwr  |
[English](javascript:void(false);)

[Русский](/ru/code/143) [中文](/zh/code/143) [Español](/es/code/143) [Deutsch](/de/code/143) [日本語](/ja/code/143) [Português](/pt/code/143) [한국어](/ko/code/143) [Français](/fr/code/143) [Italiano](/it/code/143) [Türkçe](/tr/code/143)

Published by:
:   [Vladimir](/en/users/gpwr)

Views:
:   16531

Rating:
:   (30)

Published:
:   19 July 2010, 10:38

Updated:
:   22 November 2016, 07:32
:   [hodrick-prescott\_filter.mq5](/en/code/download/143/hodrick-prescott_filter.mq5 "hodrick-prescott_filter.mq5")
    (3.99 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/143.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The Hodrick-Prescott filter is used in macroeconomics, especially in real business cycle theory to separate the cyclical component of a time series from raw data. It has a zero lag. There is a common disadvantage of such zero lag filters - **the recent values are recalculated**.

I have tried to apply this filter for the different purposes: for price channels, to use it as the trend changes indicator, etc, but I have found that it hasn't any significant advantages compared with [EMA](https://www.metatrader5.com/en/terminal/help/indicators/trend_indicators/ma), [LWMA](https://www.metatrader5.com/en/terminal/help/indicators/trend_indicators/ma) or [AMA](https://www.metatrader5.com/en/terminal/help/indicators/trend_indicators/ama).

Also I have found that values of the prices, smoothed by this filter are close to the principal component of the Principal Component Analysis (PCA). It seems that there is a mathematical relashionship between the Hodrick-Prescott filter and PCA. It might be useful, so I publish it here. I don't use it, but it would be great if you propose its possible applications.

![The Hodrick-Prescott Filter](https://c.mql5.com/18/0/hpf.png "The Hodrick-Prescott Filter")

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/143](/ru/code/143)

**Last comments |
[Go to discussion](/en/forum/1442)**
(15)

![Constantin](https://c.mql5.com/avatar/avatar_na2.png "Constantin")

**[Constantin](/en/users/constantin)**
|
27 Jul 2010 at 19:38

You don't need a small lambda for this filter. It splits the data into trend and errors, and the errors are close to normally distributed.

So you can build a channel. I use it this way (chart of the euro-buck 4 hours) (implemented in MATLAB). It will redraw only on large movements, and I enter a position only after breaking the MA

By the way, the posted code draws the filter incorrectly....

[![](https://c.mql5.com/3/1/untitled__1.jpg)](https://c.mql5.com/3/1/untitled.jpg "https://c.mql5.com/3/1/untitled.jpg")

![Vladimir](https://c.mql5.com/avatar/2010/5/4C030557-C801.jpg "Vladimir")

**[Vladimir](/en/users/gpwr)**
|
27 Jul 2010 at 22:10

**Constantin:**  

By the way, the really posted code draws the filter incorrectly....

What is the correct way?

![Constantin](https://c.mql5.com/avatar/avatar_na2.png "Constantin")

**[Constantin](/en/users/constantin)**
|
27 Jul 2010 at 23:38

I have not seen the lambda set like this

Lambda=0.0625/MathPow(MathSin[(M\_PI/Per](https://www.mql5.com/en/docs/constants/namedconstants/mathsconstants "MQL5 Documentation: Mathematical constants")),4);

![Vladimir](https://c.mql5.com/avatar/2010/5/4C030557-C801.jpg "Vladimir")

**[Vladimir](/en/users/gpwr)**
|
29 Jul 2010 at 09:47

**Constantin:**  

I've never seen a lambda set like that.

Lambda=0.0625/MathPow(MathSin[(M\_PI/Per](/ru/docs/constants/namedconstants/mathsconstants "MQL5 Documentation: Mathematical constants")),4);

I thought you had found an error in the code. Set the lambda however you want. This formula is my invention not to set lambdas in hundreds of thousands and explain their meaning to people. It's much easier to set the smoothing period as in the muwings. This formula will automatically calculate the lambda for the filter to have similar smoothing as SMA with the same period. Check it out if you want.

![MARCELO DORNELLES](https://c.mql5.com/avatar/avatar_na2.png "MARCELO DORNELLES")

**[MARCELO DORNELLES](/en/users/mdornelles)**
|
16 Jan 2016 at 20:00

Good morning friends,

I'm trying to [set up](https://www.mql5.com/en/articles/1171 "Why Virtual Hosting on the MetaTrader 4 and MetaTrader 5 platforms is better than the usual VPSs") the Hodrick-Prescott Filter indicator (https://www.mql5.com/en/code/143) but I'm getting warnings in the metaeditor that I have no idea how to fix. Here's a screen shot of how it looks on my MT5.

Could you help me in this battle?

Thanks and have a good weekend

![The Moving Average Indicator, based on the Quasi-Digital Filter](https://c.mql5.com/i/code/indicator.png)
[The Moving Average Indicator, based on the Quasi-Digital Filter](/en/code/137)

The Moving Average indicator, based on the Quasi-Digital Filter. The MACD indicator as example of its use is presented.

![iS7N_TREND.mq5](https://c.mql5.com/i/code/indicator.png)
[iS7N\_TREND.mq5](/en/code/135)

Now it's two-color (or two-mode) trend indicator, the number of calculated bars can be specified.

![An Expert Advisor, based on the "Puria method" Forex Strategy](https://c.mql5.com/i/code/expert.png)
[An Expert Advisor, based on the "Puria method" Forex Strategy](/en/code/138)

An Expert Advisor, based on the "Puria method" Forex Strategy.

![iHeikenAshiSm](https://c.mql5.com/i/code/indicator.png)
[iHeikenAshiSm](/en/code/142)

The Heiken Ashi indicator with smoothing.