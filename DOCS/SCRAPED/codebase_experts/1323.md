# PNN Neural Network Class - library for MetaTrader 5

Source: https://www.mql5.com/en/code/1323

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/1323) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Libraries](https://c.mql5.com/i/code/library.png)

# PNN Neural Network Class - library for MetaTrader 5

[Yury Kulikov](/en/users/yurich)  |
[English](javascript:void(false);)

[Русский](/ru/code/1323) [中文](/zh/code/1323) [Español](/es/code/1323) [Deutsch](/de/code/1323) [日本語](/ja/code/1323) [Português](/pt/code/1323)

Views:
:   9672

Rating:
:   (51)

Published:
:   25 December 2012, 11:31
:   [class\_pnn.mqh](/en/code/download/1323/class_pnn.mqh "class_pnn.mqh")
    (12.14 KB)
    [view](# "view")

    [test\_pnn\_xor.mq5](/en/code/download/1323/test_pnn_xor.mq5 "test_pnn_xor.mq5")
    (2.01 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/1323.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The CNetPNN class realizes the probabilistic neural network (Probabilistic Neural Network - PNN).

Creation of the network is declared to be the class parametric constructor.

```mql5
CNetPNN *net=new CNetPNN(input vector size, the number of classes (classification targets));
```

The numbering of classes (classification targets) starts from zero and must be continuous. For example, if 3 classes are set, the number of classes must be: 0, 1, 2.

Learning network is provided by calling the Learn method (the number of learning patterns, input data array, output data array, the number of learning cycles, the maximum learning error).

Input and output learning data are located in one-dimensional arrays vector by vector. On every input learning vector must be defined the class number in the input data. The process of learning is restricted either by epochs of learning, or allowable error.

The Learn method returns the following values:

* 0 - network learning is completed and learning result can be checked through the class variable: mse – learning error, epoch – number of accomplished learning cycles;
* -1 - non-existent class of the input learning data;
* -4 - not enough memory.

To get a response of the network serves the Calculate method (input vector array). The Calculate method returns the class number corresponding to input vector, or -1, if the network is not learned.

Save (open file handle with FILE\_WRITE and FILE\_BIN flags) and Load (open file handle with FILE\_READ and FILE\_BIN flags) methods are intended for saving the network to a file and loading the network from the file respectively. Network topology, learning errors and array weights are saved to the file. If parameters of the loaded network topology differ from the parameters of the established network topology, the network will not be loaded and the Load method will return false.

Using of the class is shown in the attached specimen: Test\_PNN\_XOR - learning network function "exclusive OR".

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/1323](/ru/code/1323)

**Last comments |
[Go to discussion](/en/forum/9668)**
(8)

![Yury Kulikov](https://c.mql5.com/avatar/2011/1/4D36722C-D069.jpg "Yury Kulikov")

**[Yury Kulikov](/en/users/yurich)**
|
18 Mar 2013 at 16:21

**qingyouwei:** 

... I test one and get the MSE=7.218702473434161e-008 ,is it all right ??

This is quite a small error.

Error and learning time depends on the prepared data for training. Preparing the data is a separate issue and it needs to explore before application of [neural networks](https://www.mql5.com/en/articles/497 "Article: Neural networks - from theory to practice ").

![Dua Yong Rew](https://c.mql5.com/avatar/2012/9/506484E9-0B8E.jpg "Dua Yong Rew")

**[Dua Yong Rew](/en/users/doshur)**
|
19 Mar 2013 at 15:21

any example on how to use?

![Jimmy Tee](https://c.mql5.com/avatar/avatar_na2.png "Jimmy Tee")

**[Jimmy Tee](/en/users/arstneio)**
|
27 Nov 2016 at 17:14

Nice. Even nicer that it works perfectly in MT4 too.

With a large number of samples the network does get rather large because it stores all the training samples. A useful addition would be a [function](https://www.mql5.com/en/docs/constants/namedconstants/compilemacros "MQL5 documentation: Predefined Macrosubstitutions") to reduce the network by removing any samples that increase the total error.

Another useful addition would be the possibility of adding new training samples at a later date.

I'll contribute some code once I have figured out why I'm getting nan values for the mse from time to time.

![Rasoul Mojtahedzadeh](https://c.mql5.com/avatar/2015/6/558F004E-DFBD.png "Rasoul Mojtahedzadeh")

**[Rasoul Mojtahedzadeh](/en/users/rasoul)**
|
2 Mar 2018 at 19:36

**Jimmy Tee:**  

Nice. Even nicer that it works perfectly in MT4 too.

With a large number of samples the network does get rather large because it stores all the training samples. A useful addition would be a function to reduce the network by removing any samples that increase the total error.

Another useful addition would be the possibility of adding new training samples at a later date.

I'll contribute some code once I have figured out why I'm getting nan values for the mse from time to time.

I also get mse = NaN time to time. This happens completely in random which is kind of strange. I will take a look at the code to see what could be the bug...

![mensz](https://c.mql5.com/avatar/avatar_na2.png "mensz")

**[mensz](/en/users/mensz)**
|
12 Jun 2019 at 08:20

How do I turn this class into an EA?

![ATR_MA_Oscillator](https://c.mql5.com/i/code/indicator.png)
[ATR\_MA\_Oscillator](/en/code/1322)

ATR MA Oscillator is the oscillator drawn on the basis of the difference between the ATR oscillator and its signal line.

![i-VaR95](https://c.mql5.com/i/code/indicator.png)
[i-VaR95](/en/code/1320)

The indicator displays the historical volatility value

![GRNN Neural Network Class](https://c.mql5.com/i/code/library.png)
[GRNN Neural Network Class](/en/code/1324)

The class realizes generalized regression network (General Regression Neural Network - GRNN)

![iSarX4](https://c.mql5.com/i/code/indicator.png)
[iSarX4](/en/code/1325)

Four parabolic indicators at one time!