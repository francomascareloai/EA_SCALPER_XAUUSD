# Confluence Detector - indicator for MetaTrader 5

Source: https://www.mql5.com/en/code/49345

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/49345) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# Confluence Detector - indicator for MetaTrader 5

[Conor Mcnamara](/en/users/phade)  |
[English](javascript:void(false);)

[Русский](/ru/code/49345) [中文](/zh/code/49345) [Español](/es/code/49345) [Deutsch](/de/code/49345) [日本語](/ja/code/49345) [Português](/pt/code/49345) [한국어](/ko/code/49345) [Français](/fr/code/49345) [Italiano](/it/code/49345) [Türkçe](/tr/code/49345)

Views:
:   9205

Rating:
:   (8)

Published:
:   19 April 2024, 21:13

Updated:
:   16 November 2025, 00:00
:   [Timeframe Confluence Detector.mq5](/en/code/download/49345/timeframe_confluence_detector.mq5 "Timeframe Confluence Detector.mq5")
    (4.25 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/49345.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The indicator draws three line plots on the chart. It detects the current period, and you assign two other periods in the input which should compare to the current period.

![Inputs](https://c.mql5.com/18/171/2__10.jpg "Inputs")

If the price is not moving in the same direction on the other timeframes you selected, the lines will deviate from each other and this shows that there is a lack of confluence between those timeframes.

When the lines move apart, it can be a signal to avoid trading during that time. It is safer to trade when there is confluence between multiple timeframes.

[![Plots](https://c.mql5.com/18/171/1__23.png "Plots")](https://c.mql5.com/18/171/1__22.png "https://c.mql5.com/18/155/1.png")

It is an experimental indicator. A simple minimal science experiment.

First plot is a line chart on the closing prices of the current period.

Second plot is the deviation of 1st input timeframe to current period.

Third plot is the deviation of 2nd input timeframe to current period.

You can often see a much different chart when you switch from one timeframe to another. This proves that M1 price action could be behaving completely differently to M5 price action, M5 price action could be behaving completely differently to H1, and so on. If bars are red on each timeframe, then there is what I say is "confluence", because the close prices are agreeing on that direction.

Usage:

**The current timeframe must be higher than the other two timeframes chosen in the input. See screenshot closely as an example.**

Example:

TF 1 (Current): M30

TF 2 (Deviator): M15

TF 3 (Deviator): M5

Six M5 bars and two M15 bars are tested against the M30 bar close price direction. The lower timeframe close prices are **within** the M30 time block, so naturally the lower timeframe bars will complete first and update the deviator plots on the current, higher timeframe.

M30 bar wraps {M15 Close + M15 Close}

M30 bar wraps {M5 Close + M5 Close + M5 Close + M5 Close + M5 Close + M5 Close}

These close prices on the lower timeframes cause the line plots to warp based on where the bars close (every timeframe bar has a closing price). The data is recorded when both the bars are open (current), and closed (historical), so the ticks of current unclosed bars are taken into account.

Visually, it works as a trend indicator, but it must be noted that this is not not a tick indicator as historical data is based on OHLC - the resulting visual plot is based on where bars finally closed.

The word "confluence" in this context, is to examine if the close prices on different timeframe bars are harmonious (similar) with respect to the timeframes chosen. If there is a lot of noise and volatility, then it will record this by means of line expansion (lines moving away from each other), and if the close prices are agreeing (similar), it will record that by means of line contraction (lines becoming closer to each other).

**Last comments |
[Go to discussion](/en/forum/465881)**
(1)

![Conor Mcnamara](https://c.mql5.com/avatar/2025/9/68dab3ec-4506.png "Conor Mcnamara")

**[Conor Mcnamara](/en/users/phade)**
|
16 Nov 2025 at 11:41

The indicator description has since been updated to ensure correct usage and prevent misuse.

CopySeries retrieves timeseries data for a specified timeframe, and ensures that all requested arrays remain synchronized by index for the assigned timeframe.

![QuickTradeKeys123](https://c.mql5.com/i/code/expert.png)
[QuickTradeKeys123](/en/code/49343)

QuickTradeKeys 123 is a user-friendly Expert Advisor (EA) for MetaTrader 5, enabling traders to execute buy and sell operations quickly by simply pressing the numbers '1' and '2' on their keyboard. Pressing '3' closes all open positions. This EA is ideal for swift trading and testing purposes where manual intervention is required without using the mouse.

![Simple Yet Effective Breakout Strategy](https://c.mql5.com/i/code/expert.png)
[Simple Yet Effective Breakout Strategy](/en/code/49272)

A simple yet effective donchian channel breakout strategy. This strategy is timeless!

![Trailing with Close by Button and Profit](https://c.mql5.com/i/code/expert.png)
[Trailing with Close by Button and Profit](/en/code/49365)

This EA help you for Auto set the TP & SL by default parameter, Auto trailing stop & step for any order that you place from any device, Easy way to close all orders with 5 Button "Close All", "Close Profit", "Close Lose", "Close BUY", "Close SELL", Auto close all orders by profit or lose treshold value

![Check Last Closed Trade (Profit / Type / Symbol etc.)](https://c.mql5.com/i/code/expert.png)
[Check Last Closed Trade (Profit / Type / Symbol etc.)](/en/code/49374)

Select the last closed deal (trade) to further work.