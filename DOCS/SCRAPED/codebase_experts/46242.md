# Ranged Grid Bot EA with pending orders - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/46242

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/46242) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Ranged Grid Bot EA with pending orders - expert for MetaTrader 4

[Alessio Fabiani](/en/users/afabiani)

Views:
:   21934

Rating:
:   (7)

Published:
:   3 September 2023, 13:40

Updated:
:   2 October 2023, 17:34
:   [RangeEA.mq4](/en/code/download/46242/rangeea.mq4 "RangeEA.mq4")
    (23.23 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/46242.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

**UPDATE: v1.01**

* Added magic number
* Added control on symbol (it can be now attached to different charts on the same account)
* Added time control for trading
* Added an option to forcibly close all the trades after the end hour

The EA creates a grid of equally spaced pending limit orders taking into account:

 - The current price; sell-limit above / buy-limit below

 - The trading range; computed by using the weekly highs and lows

The EA then manages the orders while they have been executed.

The logic is:

* IF #EXECUTED ORDERS == 2  
  OPEN NEW LIMIT AT THE PEN. PRICE
* IF #EXECUTED ORDERS > TOT - 2  
  RESET THE LIMIT ORDERS TO RANGE

[![](https://c.mql5.com/18/150/rangegridea-screen-1161__1.gif)](https://c.mql5.com/18/150/rangegridea-screen-1161.gif "https://c.mql5.com/18/150/rangegridea-screen-1161.gif")

 - check the video for the full strategy

**Last comments |
[Go to discussion](/en/forum/453463)**
(18)

![Fernando Carreiro](https://c.mql5.com/avatar/2025/9/68d40cf8-38fb.png "Fernando Carreiro")

**[Fernando Carreiro](/en/users/fmic)**
|
18 Oct 2023 at 12:03

**[@rischellen02032002](/en/users/rischellen02032002) [#](/en/forum/453463/page2#comment_50004696):** Good day Alessio Fabiani# can you remove the time restrictions from the current version of the bot please?

What time restrictions? There are none! Set the EA's parameters accordingly.

![rischellen02032002](https://c.mql5.com/avatar/avatar_na2.png "rischellen02032002")

**[rischellen02032002](/en/users/rischellen02032002)**
|
18 Oct 2023 at 17:19

**Fernando Carreiro [#](/en/forum/453463/page2#comment_50004861):** What time restrictions? There are none! Set the EA's parameters accordingly.

The start and end time parameters are affecting the bot performance, can they be removed? Also  what's your input for the bots parameters?

![Fernando Carreiro](https://c.mql5.com/avatar/2025/9/68d40cf8-38fb.png "Fernando Carreiro")

**[Fernando Carreiro](/en/users/fmic)**
|
18 Oct 2023 at 18:14

**[@rischellen02032002](/en/users/rischellen02032002) [#](/en/forum/453463/page2#comment_50011785):** The start and end time parameters are affecting the bot performance, can they be removed? Also  what's your input for the bots parameters?

I repeat — set them accordingly. By default, they are 0 and 24 which is the equivalent to no time restriction.

We only have 24 hours in a day, so the hour will always be greater or equal to 0 and less then 24 — hence no restriction if you set the parameters correctly.

> ```mql5
> input int startTrade = 0; // Trade Start Time; Do not trade before this hour
> input int endTrade = 24; // Trade End Time; Do not trade after this hour
> ```
>
> ```mql5
> void OnTick()
>   {
> 
>    datetime currentBarTime = Time[0]; // Get the opening time of the current bar
> 
>    if(Hour() >= startTrade && Hour() < endTrade)
>      { 
> 
> ...
> ```

![Erdem](https://c.mql5.com/avatar/2024/7/669d2c6c-e3f9.png "Erdem")

**[Erdem](/en/users/erdem16)**
|
20 Jul 2024 at 21:28

Thank you this is very good grid bot it can possible can we change timeframe as we wanted also if there stoploss on off option this would be good

![Mohammed Abdulla D K Karbon](https://c.mql5.com/avatar/avatar_na2.png "Mohammed Abdulla D K Karbon")

**[Mohammed Abdulla D K Karbon](/en/users/mohaa7)**
|
7 Oct 2024 at 09:31

Hi Alessio. I'm using your Range EA, it was good last week. But this week there are no [pending orders](https://www.mql5.com/en/docs/constants/tradingconstants/orderproperties#enum_order_type "MQL5 documentation:") anymore. Why the EA is not opening any new pending orders?

![Ehlers reverse EMA](https://c.mql5.com/i/code/indicator.png)
[Ehlers reverse EMA](/en/code/46075)

A trend or cycle indicator with very low lag.

![Gaussian Low Lag Filters](https://c.mql5.com/i/code/indicator.png)
[Gaussian Low Lag Filters](/en/code/46050)

Gaussian Filter Multi Pole smoother of price data

![Probability and Signals class](https://c.mql5.com/i/code/library.png)
[Probability and Signals class](/en/code/46135)

With these classes you can create and test your signals runtime.

![MaybeAwo EA](https://c.mql5.com/i/code/expert.png)
[MaybeAwo EA](/en/code/46314)

a Versatile automated trading tool for the MetaTrader 4 platform. This EA is designed to assist traders in managing their positions effectively by offering features such as setting a breakeven point, trailing stop, stop loss, and take profit levels. It works with various input parameters, allowing you to customize its behavior to fit your trading strategy.