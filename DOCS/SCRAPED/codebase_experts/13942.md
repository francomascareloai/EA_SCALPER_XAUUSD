# Robust EA Template - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/13942

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/13942) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Robust EA Template - expert for MetaTrader 4

[Inovance](/en/users/inovance)  |
[English](javascript:void(false);)

[Русский](/ru/code/13942) [Deutsch](/de/code/13942) [日本語](/ja/code/13942)

Views:
:   30229

Rating:
:   (26)

Published:
:   2 October 2015, 17:28

Updated:
:   22 November 2016, 07:32
:   [robust\_ea\_template.mq4](/en/code/download/13942/robust_ea_template.mq4 "robust_ea_template.mq4")
    (11.8 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/13942.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

**Real author:**

Inovance - https://www.inovancetech.com/

A robust EA template to help correctly set take profit and stop loss levels, enter and exit positions, and handle terminal issues, such as crashes or disconnects.

To use, input your entry conditions at the bottom of the EA in the "Long and Short Entry Conditions" section. Input your long conditions to return "1" if a long signal is generated in the "LongSignal()" function and your short conditions to return "-1" if a short signal is generated in the "ShortSignal()" function.

A single Buy or Sell order will be placed if your conditions are met and no order will be placed if both long and short conditions are met. It will exit the trade if the take profit or stop loss is hit or if there is a signal in the opposite direction, in which case it will exit the existing trade and open a new one in the appropriate direction.

![External Inputs](https://c.mql5.com/18/42/External_Inputs__1.png "External Inputs")

EA Inputs

"Long and Short Entry Conditions" section with example strategy shown (**note:this is an arbitrary strategy for demonstration purposes only**).

```mql5
//+------------------------------------------------------------------+
//| Long and Short Entry Conditions                                  |
//+------------------------------------------------------------------+
int indCCI0period = 14; // Indicator 1 period
int indRSI1period = 14; // Indicator 2 period
//+------------------------------------------------------------------+
//| Long Entry(Return "1" for long entry, "0" for no entry)          |
//+------------------------------------------------------------------+
int LongSignal()
  {
   double CCI0 = iCCI(NULL,0,indCCI0period,PRICE_CLOSE,1);
   double RSI1 = iRSI(NULL,0,indRSI1period,PRICE_CLOSE,1);
   int match=0;
   if(CCI0>-200 && CCI0<=-150) match++;
   else if(CCI0>-100 && CCI0<=-50) match++;
   if(RSI1>0 && RSI1<=25) match++;
   if(match == 2) return 1;
   return 0;
  }
//+------------------------------------------------------------------+
//| Short Entry(Return "-1" for long entry, "0" for no entry)        |
//+------------------------------------------------------------------+
int ShortSignal()
  {
   double CCI0 = iCCI(NULL,0,indCCI0period,PRICE_CLOSE,1);
   double RSI1 = iRSI(NULL,0,indRSI1period,PRICE_CLOSE,1);
   int match=0;
   if(CCI0 > 50 && CCI0 <= 150) match++;
   if(RSI1 > 80 && RSI1 <= 100) match++;
   if(match == 2) return -1;
   return 0;
  }
```

**Recommendations:**

* Works with 4- and 5- digit brokers.
* Always test on a demo account.
* Example strategy shown in template (**note:this is an arbitrary strategy for demonstration purposes only).**

**Last comments |
[Go to discussion](/en/forum/64854)**
(12)

![Alain Verleyen](https://c.mql5.com/avatar/2024/5/663a6cdf-e866.jpg "Alain Verleyen")

**[Alain Verleyen](/en/users/angevoyageur)**
|
8 Oct 2015 at 11:28

**calli:**  

I have discussed about this with WHRoeder. He disagrees with my solution. (I couldn't found the link in the mql4-forum).

I want that a PIP has always the same money-value - by default close to 10 units of the [account currency](/en/docs/constants/environment_state/accountinformation#enum_account_info_string "MQL5 documentation: Account Properties") - and came to this solution:

Let me know, if you realize an error.

You will never find an universal solution, a PIP is only well defined for Forex (and yet you can find people which will disagree), for all other symbols it's trader dependant.

![Carl Schreiber](https://c.mql5.com/avatar/2018/2/5A745EEE-EB76.PNG "Carl Schreiber")

**[Carl Schreiber](/en/users/gooly)**
|
8 Oct 2015 at 15:54

**Alain Verleyen:**  
 You will never find an universal solution, a PIP is only well defined for Forex (and yet you can find people which will disagree), for all other symbols it's trader dependant.

Well, I don't care much about what others say unless it meets my needs - somehow.

Nowadays PIP has become an "artificial" unit, broker dependent are (in mt4-Speech) "Digits", the "\_Point" and the "MODE\_TICKSIZE".

With my solution I know that a stop of 70 PIP will always risk approximately the same amount of my money.

Otherwise to have that risk I have to enter either 70 or 700 or 7 or ... and that is a wonderful source of mistakes, typos and errors.

![Roberto Jacobs](https://c.mql5.com/avatar/2015/6/55706E50-4CAE.jpg "Roberto Jacobs")

**[Roberto Jacobs](/en/users/3rjfx)**
|
15 Oct 2015 at 06:23

**Automated-Trading:**  

[Robust EA Template](/en/code/13942):

Author: [Inovance](/en/users/Inovance "Inovance")

Thank you Inovance.  
 Perhaps you can add code to open a pending order.

![Inovance](https://c.mql5.com/avatar/2015/3/550C8BB7-CAC0.png "Inovance")

**[Inovance](/en/users/inovance)**
|
21 Oct 2015 at 21:22

**3rjfx:**  
 Thank you Inovance.  
 Perhaps you can add code to open a pending order.

Glad you found this useful. I will create a different template to work with [pending orders](https://www.mql5.com/en/docs/constants/tradingconstants/orderproperties#enum_order_type "MQL5 documentation:") and will be sure to let you know when it's posted!

Happy trading.

![joaobucks](https://c.mql5.com/avatar/avatar_na2.png "joaobucks")

**[joaobucks](/en/users/joaobucks)**
|
26 Nov 2015 at 18:52

I want to substitute the indicators from CCI and RSI to EMA and SMA, such that it trades a cross of the EMA3 and SMA18. Can someone help me make this modification? Thanks

![Close symbol with profit or loss](https://c.mql5.com/i/code/expert.png)
[Close symbol with profit or loss](/en/code/13937)

Easy EA for closing positions of the symbol with profit or loss. You can use it for hidden SL too.

![Basic Trailing Stop](https://c.mql5.com/i/code/expert.png)
[Basic Trailing Stop](/en/code/13906)

An EA template to add a simple trailing stop to your strategy.

![Squeeze RA V1](https://c.mql5.com/i/code/indicator.png)
[Squeeze RA V1](/en/code/13938)

My version of Squeeze Indicator for MetaTrader 4. This indicator is based on a strategy mentioned in John Carter's book, Mastering the Trade. It is also a fully improvised version of Squeeze\_Break indicator by Des O'Regan.

![Instant Execution New](https://c.mql5.com/i/code/expert.png)
[Instant Execution New](/en/code/13940)

Instant execution button to close profit orders, close all orders, auto close by trailing parameter. Last update: 21 April 2016. Prev: 8 Dec 2015