# Simplest CSV file reader - script for MetaTrader 5

Source: https://www.mql5.com/en/code/46935

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/46935) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# Simplest CSV file reader - script for MetaTrader 5

[Denis Kislicyn](/en/users/deniskislitsyn)

Views:
:   8462

Rating:
:   (16)

Published:
:   21 October 2023, 21:33

Updated:
:   1 September 2025, 20:11
:   \MQL5\Files\

    [filename.csv](/en/code/download/46935/filename.csv "filename.csv")
    (0.31 KB)
    [view](# "view")

    \MQL5\Include\

    [DKSimplestCSVReader.mqh](/en/code/download/46935/DKSimplestCSVReader.mqh "DKSimplestCSVReader.mqh")
    (12.75 KB)
    [view](# "view")

    [DKSimplestCSVReader\_Example.mq5](/en/code/download/46935/DKSimplestCSVReader_Example.mq5 "DKSimplestCSVReader_Example.mq5")
    (2.11 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/46935.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Use this simplest class to read CSV file with out any preparations and types casting declarations.

Find the shortest usage example below.

```mql5
string Filename = "filename.csv";

CDKSimplestCSVReader CSVFile; // Create class object

// Read file pass FILE_ANSI for ANSI files or another flag for another codepage.
// Give values separator and flag of 1st line header in the file 
if (CSVFile.ReadCSV(Filename, FILE_ANSI, ";", true)) {
  PrintFormat("Successfully read %d lines from CSV file with %d columns: %s", 
              CSVFile.RowCount(),     // Return data lines count without header 
              CSVFile.ColumnCount(),  // Return columns count from 1st line of the file
              Filename);
  
  // Print all columns of the file from 1st line
  for (int i = 0; i < CSVFile.ColumnCount(); i++) {   
    PrintFormat("  Column Index=#%d; Name=%s", i, CSVFile.GetColumn(i));
  }         
              
  // Print values from all rows
  for (int i = 0; i < CSVFile.RowCount(); i++) {
    PrintFormat("Row %d: Value by column name: CSVFile.GetValue(i, ""Time"")=%s", i, CSVFile.GetValue(i, "Time")); // Get value from i line by column name
    PrintFormat("Row %d: Value by column index: CSVFile.GetValue(i, 0)=%s", i, CSVFile.GetValue(i, 0));            // Get value from i line by column index
  }    
} 
else
  PrintFormat("Error reading CSV file or file has no any rows: %s", Filename);  
```

**Last comments |
[Go to discussion](/en/forum/456125)**
(17)

![Blessing Dumbura](https://c.mql5.com/avatar/2021/1/5FFC20BB-41D2.png "Blessing Dumbura")

**[Blessing Dumbura](/en/users/beetrader)**
|
30 Apr 2025 at 12:41

saved me a lot of hustle

![Sugeng Lutfi Yatama](https://c.mql5.com/avatar/2022/10/635d343f-5851.jpg "Sugeng Lutfi Yatama")

**[Sugeng Lutfi Yatama](/en/users/dingdong99)**
|
7 Jun 2025 at 22:20

[![](https://c.mql5.com/3/466/3899260206758__1.png)](https://c.mql5.com/3/466/3899260206758.png "https://c.mql5.com/3/466/3899260206758.png")

```mql5
//+------------------------------------------------------------------+
//| Return column name from 1st line of the file by index            |
//+------------------------------------------------------------------+
string CDKSimplestCSVReader::GetColumn(uint aColumnIndex, string aErrorValue = "")
 {
  string keys[];
  int values[];
  Columns.CopyTo(keys, values);

  if(aColumnIndex < ArraySize(keys))
    return keys[aColumnIndex];
  return aErrorValue;
 }
```

in build 5100, 6 Juni 2025,   
that code have error, friend

![Blessing Dumbura](https://c.mql5.com/avatar/2021/1/5FFC20BB-41D2.png "Blessing Dumbura")

**[Blessing Dumbura](/en/users/beetrader)**
|
8 Jun 2025 at 16:57

**Sugeng Lutfi Yatama [#](/en/forum/456125/page2#comment_56892654):**  

in build 5100, 6 Juni 2025,   
that code have error, friend

```mql5
string CDKSimplestCSVReader::GetColumn(uint aColumnIndex, string aErrorValue = "")
 {
  string keys[];
  uint values[];
  Columns.CopyTo(keys, values);

  if(aColumnIndex < (uint) ArraySize(keys))
    return keys[aColumnIndex];
  return aErrorValue;
 }
```

change the values from int to uint and type cast the ArraySize to uint

![Sugeng Lutfi Yatama](https://c.mql5.com/avatar/2022/10/635d343f-5851.jpg "Sugeng Lutfi Yatama")

**[Sugeng Lutfi Yatama](/en/users/dingdong99)**
|
9 Jun 2025 at 16:01

**Blessing Dumbura [#](/en/forum/456125/page2#comment_56896128):**  
 change the values from int to uint and type cast the ArraySize to uint

ok, thank you for help, friend.

![Vikram K](https://c.mql5.com/avatar/2019/8/5D528ABA-3171.png "Vikram K")

**[Vikram K](/en/users/vikramk)**
|
12 Jun 2025 at 08:38

Very nice class.

![MT5 CCI with shift parameter](https://c.mql5.com/i/code/indicator.png)
[MT5 CCI with shift parameter](/en/code/46924)

The default CCI in MT5 doesn't have the shift parameter. This script implements the shift.

![Smooth Algorithms - Corrected/Modified - library for MetaTrader 5](https://c.mql5.com/i/code/library.png)
[Smooth Algorithms - Corrected/Modified - library for MetaTrader 5](/en/code/46816)

Smooth Algorithms fixed version plus Trade Algorithms plus full operational EA, plus two indicators . So you will get complete project where you be able to see example how to use and implement this libraries

![Keltner Channel code for beginners by William210](https://c.mql5.com/i/code/indicator.png)
[Keltner Channel code for beginners by William210](/en/code/46986)

Keltner Channel for traders or young developers by William210

![Donchian Channel for beginners by William210](https://c.mql5.com/i/code/indicator.png)
[Donchian Channel for beginners by William210](/en/code/46989)

Donchian Channel for traders or young developers by William210