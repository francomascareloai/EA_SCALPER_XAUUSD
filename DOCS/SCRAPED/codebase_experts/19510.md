# N Candles v5 - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/19510

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/19510) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# N Candles v5 - expert for MetaTrader 5

[Vladimir Karputov](/en/users/barabashkakvn)  |
[English](javascript:void(false);)

[Русский](/ru/code/19510) [中文](/zh/code/19510) [Español](/es/code/19510) [Deutsch](/de/code/19510) [日本語](/ja/code/19510) [Português](/pt/code/19510)

Views:
:   4367

Rating:
:   (21)

Published:
:   22 January 2018, 09:56

Updated:
:   27 June 2018, 14:50
:   [N Candles v5.mq5](/en/code/download/19510/n_candles_v5.mq5 "N Candles v5.mq5")
    (37.95 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/19510.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The Expert Advisor searches for N identical candlesticks in a row. It buys on bullish candlesticks and sells on bearish ones. The account type is taken into account, i.e. whether it is netting or hedging. The [CPositionInfo](/en/docs/standardlibrary/tradeclasses/cpositioninfo "MQL5 Reference → Standard Library → Trade Classes → CPositionInfo"), [CTrade](/en/docs/standardlibrary/tradeclasses/ctrade "MQL5 Reference → Standard Library → Trade Classes → CTrade"), [CSymbolInfo](/en/docs/standardlibrary/tradeclasses/csymbolinfo "MQL5 Reference → Standard Library → Trade Classes → CSymbolInfo") and [CAccountInfo](/en/docs/standardlibrary/tradeclasses/caccountinfo "MQL5 Reference → Standard Library → Trade Classes → CAccountInfo") trade classes are used in the code.

* Version 1: [N candles](/en/code/18023 "N Сandles - expert for MetaTrader 5").
* Version 2: [N Candles v2](/en/code/18219 "N Candles v2 - expert for MetaTrader 5").
* Version 3: [N Candles v3](/en/code/18575 "N Candles v3 - expert for MetaTrader 5").
* Version 4: [N Candles v4](/en/code/18609 "N Candles v4 - expert for MetaTrader 5").

New in version 5: the new "working time" parameter allows setting the trade beginning and end hours. The EA will only trade within "working time" and will do nothing the rest time.

### Input Parameters

* **N identical candles which go in a row** - the number of identical candlesticks in a row.
* **Lot** - position volume.
* **Take Profit**.
* **Stop Loss**.
* **Trailing Stop ("0" -> not trailing)**.
* **Trailing Step (use if Trailing Stop >0)**.
* **Max positions certain direction (only for hedging)** - the maximum number of positions (only for hedging accounts).
* **Max position volume (only for netting)** - the maximum volume of a position (only for netting accounts).
* **Use trade hours** - enable/disable the time filter.
* **Start hour** - trading start hour.
* **End hour** - trading end hour.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/19510](/ru/code/19510)

**Last comments |
[Go to discussion](/en/forum/225358)**
(4)

![jdflash](https://c.mql5.com/avatar/avatar_na2.png "jdflash")

**[jdflash](/en/users/jdflash)**
|
31 May 2020 at 20:02

Good day, can I put only **Reverse** - the reversal of the trading signal - on this old version 5?

![Vladimir Karputov](https://c.mql5.com/avatar/2024/2/65d8b5a2-f9d9.jpg "Vladimir Karputov")

**[Vladimir Karputov](/en/users/barabashkakvn)**
|
31 May 2020 at 20:05

**jdflash:**  
 Good afternoon, can I put only **Reverse** - the reversal of the trading signal - on this old version 5?

There are about nine versions now - look through them:

[https://www.mql5.com/ru/search#!keyword=N-%20CANDLES&module=mql5\_module\_codebase](/ru/search#!keyword=N-%20CANDLES&module=mql5_module_codebase)

![jdflash](https://c.mql5.com/avatar/avatar_na2.png "jdflash")

**[jdflash](/en/users/jdflash)**
|
2 Jun 2020 at 10:28

I've looked through it, version 9 is great, but it doesn't adjust to the desired strategy. What do I need to put in the old version 5 only **Reverse** - the reversal of the trading signal?

**Vladimir Karputov:**  

There are about nine versions now - check them out:

[https://www.mql5.com/ru/search#!keyword=N-%20CANDLES&module=mql5\_module\_codebase](/ru/search#!keyword=N-%20CANDLES&module=mql5_module_codebase)

![Vladimir Karputov](https://c.mql5.com/avatar/2024/2/65d8b5a2-f9d9.jpg "Vladimir Karputov")

**[Vladimir Karputov](/en/users/barabashkakvn)**
|
2 Jun 2020 at 11:36

**jdflash:**  

I've looked through it, version 9 is great, but it doesn't adjust to the desired strategy. What do I need to put in the old version 5 only **Reverse** - the reversal of the trading signal?

Unfortunately regression in versioning is unacceptable.

![Dtm_HTF](https://c.mql5.com/i/code/indicator.png)
[Dtm\_HTF](/en/code/19506)

The Dtm indicator with the possibility to change the indicator timeframe from input parameters.

![Exp_CMO_Duplex](https://c.mql5.com/i/code/expert.png)
[Exp\_CMO\_Duplex](/en/code/19502)

Two identical trading systems based on the crossover of the CMO indicator and the zero line, for long and short trades, which can be configured in different ways in one Expert Advisor.

![BeerGodEA](https://c.mql5.com/i/code/expert.png)
[BeerGodEA](/en/code/19512)

The Expert Advisor uses signals of the iMA (Moving Average, MA) indicator with a delay from the bar opening time.

![Precipice MartIn](https://c.mql5.com/i/code/expert.png)
[Precipice MartIn](/en/code/19514)

A trading strategy using the Martingale system.