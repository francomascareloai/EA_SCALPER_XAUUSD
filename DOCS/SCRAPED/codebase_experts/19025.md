# Pending orders DOWN - script for MetaTrader 5

Source: https://www.mql5.com/en/code/19025

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/19025) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# Pending orders DOWN - script for MetaTrader 5

[Vladimir Karputov](/en/users/barabashkakvn)  |
[English](javascript:void(false);)

[Русский](/ru/code/19025) [中文](/zh/code/19025) [Español](/es/code/19025) [Deutsch](/de/code/19025) [日本語](/ja/code/19025) [Português](/pt/code/19025)

Views:
:   10844

Rating:
:   (38)

Published:
:   3 November 2017, 12:30

Updated:
:   28 February 2018, 16:04
:   [Pending orders DOWN.mq5](/en/code/download/19025/pending_orders_down.mq5 "Pending orders DOWN.mq5")
    (14.07 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/19025.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The "Pending orders DOWN" script sets a grid of orders below the current price.

### Input Parameters

* **Gap for pending orders DOWN from the current price (in pips)** - the distance from the current price to place the first pending order.
* **Step between orders DOWN (in pips)** - distance between pending orders.
* **Type of pending orders DOWN** - the type of the pending order (can be either Buy Limit or Sell Stop).
* **DOWN quantity** - the number of orders to be placed.
* **Lots** - the volume of each order.
* **Stop Loss (in pips)** - Stop Loss value.
* **Take Profit (in pips)** - Take Profit value.

The script ensures the fastest possible sending of trade requests to place pending orders due to the use of the [asynchronous mode of trading operations](/en/docs/standardlibrary/tradeclasses/ctrade/ctradesetasyncmode "Trade Classes → CTrade → SetAsyncMode"):

```mql5
   m_trade.SetAsyncMode(true);
```

Here is an example of sending requests for five pending orders:

```mql5
2017.08.28 09:00:30.227 Scripts script Pending orders DOWN (AUDCAD,Daily) loaded successfully
2017.08.28 09:00:35.272 Trades  '6121033': sell stop 0.01 AUDCAD at 0.98893 sl: 0.99143 tp: 0.98693
2017.08.28 09:00:35.272 Trades  '6121033': sell stop 0.01 AUDCAD at 0.98743 sl: 0.98993 tp: 0.98543
2017.08.28 09:00:35.273 Trades  '6121033': sell stop 0.01 AUDCAD at 0.98593 sl: 0.98843 tp: 0.98393
2017.08.28 09:00:35.273 Trades  '6121033': sell stop 0.01 AUDCAD at 0.98443 sl: 0.98693 tp: 0.98243
2017.08.28 09:00:35.273 Trades  '6121033': sell stop 0.01 AUDCAD at 0.98293 sl: 0.98543 tp: 0.98093
2017.08.28 09:00:35.274 Scripts script Pending orders DOWN (AUDCAD,Daily) removed
```

Five orders were sent in 1 millisecond!

Here is the full report, from the script start to its removal (the time of first order sent was 2017.08.28 09:00:35.272):

```mql5
2017.08.28 09:00:30.227 Scripts script Pending orders DOWN (AUDCAD,Daily) loaded successfully
2017.08.28 09:00:35.272 Trades  '6121033': sell stop 0.01 AUDCAD at 0.98893 sl: 0.99143 tp: 0.98693
2017.08.28 09:00:35.272 Trades  '6121033': sell stop 0.01 AUDCAD at 0.98743 sl: 0.98993 tp: 0.98543
2017.08.28 09:00:35.273 Trades  '6121033': sell stop 0.01 AUDCAD at 0.98593 sl: 0.98843 tp: 0.98393
2017.08.28 09:00:35.273 Trades  '6121033': sell stop 0.01 AUDCAD at 0.98443 sl: 0.98693 tp: 0.98243
2017.08.28 09:00:35.273 Trades  '6121033': sell stop 0.01 AUDCAD at 0.98293 sl: 0.98543 tp: 0.98093
2017.08.28 09:00:35.274 Scripts script Pending orders DOWN (AUDCAD,Daily) removed
2017.08.28 09:00:35.340 Trades  '6121033': accepted sell stop 0.01 AUDCAD at 0.98893 sl: 0.99143 tp: 0.98693
2017.08.28 09:00:35.341 Trades  '6121033': order #164992356 sell stop 0.01 / 0.01 AUDCAD at market done in 68.657 ms
2017.08.28 09:00:35.341 Trades  '6121033': accepted sell stop 0.01 AUDCAD at 0.98743 sl: 0.98993 tp: 0.98543
2017.08.28 09:00:35.342 Trades  '6121033': order #164992357 sell stop 0.01 / 0.01 AUDCAD at market done in 69.645 ms
2017.08.28 09:00:35.342 Trades  '6121033': accepted sell stop 0.01 AUDCAD at 0.98593 sl: 0.98843 tp: 0.98393
2017.08.28 09:00:35.343 Trades  '6121033': order #164992358 sell stop 0.01 / 0.01 AUDCAD at market done in 70.006 ms
2017.08.28 09:00:35.343 Trades  '6121033': accepted sell stop 0.01 AUDCAD at 0.98443 sl: 0.98693 tp: 0.98243
2017.08.28 09:00:35.343 Trades  '6121033': order #164992359 sell stop 0.01 / 0.01 AUDCAD at market done in 70.346 ms
2017.08.28 09:00:35.343 Trades  '6121033': accepted sell stop 0.01 AUDCAD at 0.98293 sl: 0.98543 tp: 0.98093
2017.08.28 09:00:35.343 Trades  '6121033': order #164992360 sell stop 0.01 / 0.01 AUDCAD at market done in 70.312 ms
```

The time when placing of the last pending order was confirmed is 2017.08.28 09:00:35.343. Totally, all operations took as little as 71 milliseconds!

At the beginning of script operation, the correctness of the specified volume of pending orders is checked:

```mql5
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//---
   if(InpLots<=0.0)
     {
      Print("The \"Lots\" can't be smaller or equal to zero");
      return;
     }
//---
   if(!m_symbol.Name(Symbol())) // sets symbol name
      return;
   if(!RefreshRates())
      return;

   string err_text="";
   if(!CheckVolumeValue(InpLots,err_text))
     {
      Print(err_text);
      return;
     }
//---
```

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/19025](/ru/code/19025)

**Last comments |
[Go to discussion](/en/forum/218717)**
(58)

![Luis Fredy Garcia Azuero](https://c.mql5.com/avatar/2022/4/62698578-9474.png "Luis Fredy Garcia Azuero")

**[Luis Fredy Garcia Azuero](/en/users/fredygarcia)**
|
12 Aug 2022 at 15:45

**Vladimir Karputov [#](/es/forum/220526#comment_13809607):** In this code, instead of"m\_symbol.LotsMin()" put"InpLots":

Hi, the code is great, but look I made the modification you suggest but anyway the pending orders are still opened at the minimum lotting, what can I be doing wrong?

![Bjoern Calow](https://c.mql5.com/avatar/2023/12/6572136f-cfd5.jpg "Bjoern Calow")

**[Bjoern Calow](/en/users/blackdimmu)**
|
2 Jan 2023 at 22:16

ok it does what it should. and that is far more than I have seen in other scribts. but I can't change the size of the order ?

![ai futureart](https://c.mql5.com/avatar/2023/2/63E6E047-18FD.png "ai futureart")

**[ai futureart](/en/users/forextrees)**
|
11 Feb 2023 at 00:26

How to mix [sell stop](https://www.mql5.com/en/docs/constants/tradingconstants/orderproperties#enum_order_type "MQL5 documentation:") and buy stop pending orders script over. ver "1.004"

![Oanh Tran](https://c.mql5.com/avatar/2023/8/64CCCAB2-4525.png "Oanh Tran")

**[Oanh Tran](/en/users/oanh065363)**
|
28 Oct 2023 at 18:08

If you can increase the lot for each [pending order](https://www.mql5.com/en/docs/constants/tradingconstants/orderproperties#enum_order_type "MQL5 documentation:"), your profits will increase

![MatrixRevolu](https://c.mql5.com/avatar/avatar_na2.png "MatrixRevolu")

**[MatrixRevolu](/en/users/matrixrevolu)**
|
13 Oct 2024 at 19:08

Can you change the script code to add when the order will be cancelled?

Example: put the Expiry of the order in the input parameters.

**Input parameters**

* **Gap for pending orders UP from the current price (in pips)** - the **gap** from the current price to place the first [pending order](/en/docs/constants/tradingconstants/orderproperties#enum_order_type "MQL5 documentation: Order properties").
* **Step between orders UP (in pips** ) - distance between pending orders.
* **Type of pending orders UP** - type of pending order (can be Buy Stop or Sell Limit).
* **UP quantity** - number of orders to be placed .
* **Lots** - volume of each pending order .
* **Stop Loss (in pips)**.
* **Take Profit (in pips)**.
* **!!!!(Order expiry)!!!!**

Thank you in advance for your help.

![Pending orders UP](https://c.mql5.com/i/code/script.png)
[Pending orders UP](/en/code/19024)

The scripts places multiple pending orders higher than the current price.

![History Deals and Orders](https://c.mql5.com/i/code/script.png)
[History Deals and Orders](/en/code/19019)

The 'History Deals and Orders' script shows absolutely all properties of deals and orders from the trading history over a given time interval.

![Burg Extrapolator](https://c.mql5.com/i/code/expert.png)
[Burg Extrapolator](/en/code/19046)

The Expert Advisor uses Burg's method for linear prediction.

![Carbophos](https://c.mql5.com/i/code/expert.png)
[Carbophos](/en/code/19048)

The Expert Advisor sets a grid of pending Sell Limit and Buy Limit orders.