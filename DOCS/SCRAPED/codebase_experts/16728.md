# Opening and Сlosing on time - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/16728

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/16728) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Opening and Сlosing on time - expert for MetaTrader 5

[Vladimir Karputov](/en/users/barabashkakvn)  |
[English](javascript:void(false);)

[Русский](/ru/code/16728) [中文](/zh/code/16728) [Español](/es/code/16728) [Deutsch](/de/code/16728) [日本語](/ja/code/16728) [Português](/pt/code/16728)

Views:
:   5755

Rating:
:   (19)

Published:
:   19 January 2017, 16:54
:   [Opening\_and\_ilosing\_on\_time.mq5](/en/code/download/16728/opening_and_ilosing_on_time.mq5 "Opening_and_ilosing_on_time.mq5")
    (14.59 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/16728.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The EA opens and closes positions at a specified time. Only HH:mm are considered in the inputs (time).

**Inputs:**

***opening time (only HH:mm are considered)*** — position open time

***closing time (only HH:mm are considered)*** — position close time

***symbol*** — traded symbol

***volume transaction*** — position volume

***true -> Buy, false -> Sell*** — if "true", only "Buy" positions are opened; if "false", only "Sell" ones

***magic number*** — EA's magic number.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/16728](/ru/code/16728)

**Last comments |
[Go to discussion](/en/forum/167446)**
(41)

![Vladimir Karputov](https://c.mql5.com/avatar/2024/2/65d8b5a2-f9d9.jpg "Vladimir Karputov")

**[Vladimir Karputov](/en/users/barabashkakvn)**
|
31 Aug 2020 at 18:24

**xinyao shen :**  

Still can't close the position, but opened it twice and tested it successfully.

Manually opened a short position of 0.01 lots, and then opened a long position of 0.02,. The test was successful. Use the default phantom number.

Manually open a position, close it independently or it doesn't work. The phantom number is 0, the position is not closed at the time, no response.

Another test, after using a backhand 0.02 long order, and using the time to close the position, it is possible to close the position. With the default phantom number

That is, if you open a position with this EA, it is possible to close it, but if you open a position manually and close it with this EA, it is not possible. This is what we have tested so far.

If you have something to say, please: provide a description of the [trading environment](https://www.mql5.com/en/articles/994 "Article: How to Prepare a Trading Account for Migration to Virtual Hosting "). Provide a description (detailed) of your steps: what you do and what you get.

![YAO YAO](https://c.mql5.com/avatar/2020/1/5E16D28B-1FE2.jpg "YAO YAO")

**[YAO YAO](/en/users/sjjc2015)**
|
1 Sep 2020 at 05:53

For example, at 03:15 server time, I manually opened a short position in Europe and the United States for 0.01 lots and set a Stop Loss and [Take Profit](https://www.mql5.com/en/articles/7113 "Article: Scratching Profits to the Last Pip ") in MT5, and I need to set a time to close the position at 18:00.

Server time 15:15 I manually opened a long position in AUD 0.01 lot with a Stop Loss and Take Profit set in MT5, and I need to set a time to force the position to close at 21:00 A mandatory close time of 21:25

Provided that the position must be opened manually, with the closing EA to close the position at the time of the closing time forced to close the position, each trading instrument (trading varieties) can be set up independent of the time to close the position. Or each underlying trade has a corresponding mandatory closing time.

![Vladimir Karputov](https://c.mql5.com/avatar/2024/2/65d8b5a2-f9d9.jpg "Vladimir Karputov")

**[Vladimir Karputov](/en/users/barabashkakvn)**
|
1 Sep 2020 at 07:42

**YAO YAO :**  

For example, at 03:15 server time, I manually opened a short position in Europe and the United States for 0.01 lots, set a stop-loss and take-profit in MT5, and needed to set a time for the forced closure of the position at 18:00.

Server time 15:15 I manually opened a long position in AUD 0.01 lot with a Stop Loss and Take Profit set in MT5, and I need to set a time to force the position to close at 21:00 A forced close time of 21:25

Provided that the position must be opened manually, the position will be closed by the closing EA at the closing time, and the closing time can be set independently for each trading instrument (trading instrument). Or each underlying trade has a corresponding mandatory closing time.

I still don't understand you. Tip: read the description carefully. Set the correct Magic Number. I will not give more advice. I hope you can read.

![womouse](https://c.mql5.com/avatar/avatar_na2.png "womouse")

**[womouse](/en/users/womouse)**
|
24 Jun 2021 at 10:15

Hello, if I manually create a position, how can I use this script to close the position at a specified time?

![Vladimir Karputov](https://c.mql5.com/avatar/2024/2/65d8b5a2-f9d9.jpg "Vladimir Karputov")

**[Vladimir Karputov](/en/users/barabashkakvn)**
|
24 Jun 2021 at 10:38

**womouse :**  
 

Hello, if I manually create a position, how can I use this script to close the position at a specified time?

You can check it yourself.

![Artificial Intelligence](https://c.mql5.com/i/code/expert.png)
[Artificial Intelligence](/en/code/16727)

The Expert Advisor using artificial intelligence - a single-layer neural network. The "Perceptron" is used for identification of the quotes movement direction. Both iAC indicator and CopyTime calls are used.

![The MasterMind 2](https://c.mql5.com/i/code/expert.png)
[The MasterMind 2](/en/code/16726)

Receive data from two indicators: iStochastic and iWPR.

![Exp_3STO](https://c.mql5.com/i/code/expert.png)
[Exp\_3STO](/en/code/16732)

The trading system based on the three Stochastics signals from three different timeframes.

![Exp_3RVI](https://c.mql5.com/i/code/expert.png)
[Exp\_3RVI](/en/code/16733)

The trading system based on the three RVI oscillator signals from three different timeframes.