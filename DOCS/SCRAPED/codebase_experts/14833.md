# 1 Click Button To Close All Open Positions - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/14833

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/14833) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# 1 Click Button To Close All Open Positions - expert for MetaTrader 4

[grandaevus](/en/users/grandaevus)  |
[English](javascript:void(false);)

[Русский](/ru/code/14833)

Views:
:   72074

Rating:
:   (39)

Published:
:   16 February 2016, 15:45

Updated:
:   24 March 2016, 16:15
:   [1ClickCloseAllv01.mq4](/en/code/download/14833/1clickcloseallv01.mq4 "1ClickCloseAllv01.mq4")
    (3.73 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/14833.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

**Click "Close All" button to close all your open positions (regardless of the pair)** **at once.**

This new version **doesn't contain** the code written below that previous versions had which may cause an infinite loop.

```mql5
if(checkOrderClose==false) continue;
```

but instead brings **an error control system** to prevent an infinite loop while still closing all trades.

```mql5
if(checkOrderClose == false)
         {
         int errorCode = GetLastError();
         
         if (errorCode == 1 || errorCode == 2 || errorCode == 5 || errorCode == 6 || errorCode == 64 || errorCode == 65 || errorCode == 132 || errorCode == 133 || errorCode == 139) break;
         else continue;        
         }   
```

![](https://c.mql5.com/18/46/1clickclose.png)

**Last comments |
[Go to discussion](/en/forum/73642)**
(24)

![Abdalla Mohamed Mahmoud Taha](https://c.mql5.com/avatar/2025/11/6919f755-6890.jpg "Abdalla Mohamed Mahmoud Taha")

**[Abdalla Mohamed Mahmoud Taha](/en/users/abdalla)**
|
8 Dec 2020 at 22:20

can you make it for mt5 please

![ehsan malaei](https://c.mql5.com/avatar/2021/5/60AD1656-9940.jpg "ehsan malaei")

**[ehsan malaei](/en/users/ehsanmalaei)**
|
19 Jan 2022 at 10:32

Helo, Is it possible to speed up the closing of positions in Expert?

It has an option called max slippage, maybe we should change it to increase the closing speed of the positions?

![ddchbm](https://c.mql5.com/avatar/avatar_na2.png "ddchbm")

**[ddchbm](/en/users/ddchbm)**
|
5 Mar 2022 at 19:05

Hi what does the "Max Slippage" input do? There is no explanation for the only input. Hehe =)

Thanks

![minigol95](https://c.mql5.com/avatar/avatar_na2.png "minigol95")

**[minigol95](/en/users/minigol95)**
|
8 Feb 2024 at 12:57

Good morning everyone. I'm new to MT4. I would like to understand what to install to have the option to close all open orders (not those in standby) with just one click. Some time ago I managed to install but now it no longer works. can someone help me ?

![Garhardt](https://c.mql5.com/avatar/avatar_na2.png "Garhardt")

**[Garhardt](/en/users/garhardt)**
|
18 Jul 2024 at 15:36

Does this Close All Positions EA close them in consecutive order ?  Because here in the USA we have to abide by FIFO rules (positions have to be closed in the order that they were opened).

![Example of RSI Automated](https://c.mql5.com/i/code/expert.png)
[Example of RSI Automated](/en/code/14804)

This is my 1st published code, it is very simple code example: RSI 14 (price close) — open buy when it is < 25, close buy when it is > 50, open sell when it is > 75, close sell when it is < 50.

![FloatingSpread](https://c.mql5.com/i/code/indicator.png)
[FloatingSpread](/en/code/14707)

The indicator for the floating spread. Displays the change in spread of multiple currency pairs.

![Not Only Spread](https://c.mql5.com/i/code/indicator.png)
[Not Only Spread](/en/code/14315)

Spread, its moving average (EMA), its maximum and minimum, and ticks per second (market speed) in the Comment. The version 1.01 is made with the normal average, instead of the moving average.

![Example of Stochastic Automated](https://c.mql5.com/i/code/expert.png)
[Example of Stochastic Automated](/en/code/14864)

The main idea of this Expert Advisor is to trade by the basic concept of Stochastic oscillator in its basic parameters, with ability to change these parameters via the EA inputs.