# Virtual Profit Close - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/29186

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/29186) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Virtual Profit Close - expert for MetaTrader 4

[Kenneth Parling](/en/users/kenpar)

Views:
:   32815

Rating:
:   (37)

Published:
:   13 May 2020, 13:36

Updated:
:   9 August 2021, 15:25
:   [Virtual\_Profit\_Close.mq4](/en/code/download/29186/virtual_profit_close.mq4 "Virtual_Profit_Close.mq4")
    (10.51 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/29186.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

### Virtual Profit Close

With this expert adviser you can control an already existing open position (by another ea or a manual order) and close it by desired profit level virtually. Additionally a trailing stop can be used (not virtual!)

**Last comments |
[Go to discussion](/en/forum/340492)**
(5)

![Dhanaraj](https://c.mql5.com/avatar/2020/12/5FC63C3A-78A8.png "Dhanaraj")

**[Dhanaraj](/en/users/imdhanaraj)**
|
18 Feb 2021 at 17:36

Great article. Thanks for the share!

![Clay Pot](https://c.mql5.com/avatar/2019/7/5D1F7B35-D3FC.png "Clay Pot")

**[Clay Pot](/en/users/claaaay)**
|
19 Feb 2021 at 03:54

Hi Kenneth,

Thanks for the EA. Do you think you can add Trailing order option to trail profit for orders of the same magic number thanks.

Cheers.

![Kenneth Parling](https://c.mql5.com/avatar/2025/11/69272bcd-4185.jpg "Kenneth Parling")

**[Kenneth Parling](/en/users/kenpar)**
|
19 Feb 2021 at 05:18

**Dhanaraj:**  
 Great article. Thanks for the share!

You're welcome

![Kenneth Parling](https://c.mql5.com/avatar/2025/11/69272bcd-4185.jpg "Kenneth Parling")

**[Kenneth Parling](/en/users/kenpar)**
|
19 Feb 2021 at 05:19

**Clay Pot:**  

Hi Kenneth,

Thanks for the EA. Do you think you can add Trailing order option to trail profit for orders of the same magic number thanks.

Cheers.

You're welcome,

Updated version 1.01 available with trailing stop

![gccomtech27](https://c.mql5.com/avatar/avatar_na2.png "gccomtech27")

**[gccomtech27](/en/users/gccomtech27)**
|
26 Apr 2025 at 06:39

May I know where to download your updated version?

![Expert adviser Easy Robot](https://c.mql5.com/i/code/expert.png)
[Expert adviser Easy Robot](/en/code/29150)

Any account type, leverage and deposit

![V Sync Chart Lite](https://c.mql5.com/i/code/indicator.png)
[V Sync Chart Lite](/en/code/29105)

The V Sync Chart Lite indicator is written for demonstration purposes and shows how it is possible to synchronize the object

![GMT Time on chart](https://c.mql5.com/i/code/indicator.png)
[GMT Time on chart](/en/code/29211)

The GMT Time on chart indicator is written for users who like to see GMT Time on-screen.
For convenience, This indicator code is written clearly and simple.
Update 1: 16-5-2020
\*Input font color
\*Input font size

![waverider zigzag](https://c.mql5.com/i/code/indicator.png)
[waverider zigzag](/en/code/29248)

This indicator is ZigZag based on Bill Williams Aligator