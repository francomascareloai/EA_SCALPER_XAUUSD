# Close all profit at end of week - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/36631

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/36631) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Close all profit at end of week - expert for MetaTrader 5

[Mr Anucha Maneeyotin](/en/users/tungman)

Views:
:   7782

Rating:
:   (28)

Published:
:   30 September 2021, 11:41

Updated:
:   17 November 2021, 14:24
:   [Closeprofitendofweek.mq5](/en/code/download/36631/closeprofitendofweek.mq5 "Closeprofitendofweek.mq5")
    (3.09 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/36631.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Setup hour and minute for check current time and variable if current date is friday this function close all profit for currency pair

**Last comments |
[Go to discussion](/en/forum/378756)**
(1)

![Oswald O](https://c.mql5.com/avatar/2019/11/5DCA8DC1-3F96.jpg "Oswald O")

**[Oswald O](/en/users/oswaldoogink)**
|
19 Oct 2021 at 10:12

Hello,

Local time and [server time](https://www.mql5.com/en/docs/dateandtime/timetradeserver "MQL5 documentation: TimeTradeServer function") are used, if server in another timezone is not calculated. Calculating commission and Swap seem relevant? Further it look usable but unsure what happens if position has a Magic?

Kind wishes,

Oswald

![Sample detect economic calendar](https://c.mql5.com/i/code/expert.png)
[Sample detect economic calendar](/en/code/36603)

This code use detect economic calendar and put pending order before released news time

![CloseAll FIFO](https://c.mql5.com/i/code/script.png)
[CloseAll FIFO](/en/code/36589)

CloseAll script complying FIFO rules.

![SymbolInfo example script Enhancement with margin and leverage data](https://c.mql5.com/i/code/script.png)
[SymbolInfo example script Enhancement with margin and leverage data](/en/code/36636)

SymbolInfo example script lacks margin and leverage data wich are nowhere to be found explicitely in Metatrader, the trader must search thoroughly into the broker site in order to find them. The aim of this script is to provide a remedy to it from a standard tool.

![Open Pending order After Position Get StopLoss](https://c.mql5.com/i/code/expert.png)
[Open Pending order After Position Get StopLoss](/en/code/36713)

Open Pending order After Position Get StopLoss