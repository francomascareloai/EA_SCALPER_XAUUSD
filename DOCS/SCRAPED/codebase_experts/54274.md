# Auto Scale ZigZag - indicator for MetaTrader 4

Source: https://www.mql5.com/en/code/54274

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/54274) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# Auto Scale ZigZag - indicator for MetaTrader 4

[Evgeniy Chumakov](/en/users/jack857752)

Views:
:   8899

Rating:
:   (3)

Published:
:   17 December 2024, 13:13
:   [AutoScaleZigZag.mq4](/en/code/download/54274/autoscalezigzag.mq4 "AutoScaleZigZag.mq4")
    (20.9 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/54274.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

ZigZag with automatic step size determination for changing the wave direction.  
  
In this version of the zigzag, there is only one configurable parameter - Scale.

[![](https://c.mql5.com/18/157/USDCHFH1_Scale1__3.png)](https://c.mql5.com/18/157/USDCHFH1_Scale1__2.png "https://c.mql5.com/18/157/USDCHFH1_Scale1__2.png")

Example Scale = 0.5:

[![](https://c.mql5.com/18/157/USDCHFH1_Scale05__3.png)](https://c.mql5.com/18/157/USDCHFH1_Scale05__2.png "https://c.mql5.com/18/157/USDCHFH1_Scale05__2.png")

Example Scale = 2.0:

[![](https://c.mql5.com/18/157/USDCHFH1_Scale2__3.png)](https://c.mql5.com/18/157/USDCHFH1_Scale2__2.png "https://c.mql5.com/18/157/USDCHFH1_Scale2__2.png")

Example Scale = 1.0 / 0.5 / 2.0 together on one chart:

[![](https://c.mql5.com/18/157/USDCHFH1_Combo__3.png)](https://c.mql5.com/18/157/USDCHFH1_Combo__2.png "https://c.mql5.com/18/157/USDCHFH1_Combo__2.png")

**Last comments |
[Go to discussion](/en/forum/478418)**
(13)

![Bahman Asgarov](https://c.mql5.com/avatar/avatar_na2.png "Bahman Asgarov")

**[Bahman Asgarov](/en/users/bahmanasgerov)**
|
1 Jan 2025 at 17:28

Dear Evgeniy,

Thanks a lot for your kind reply. I understand I dont explain my question properly and therefore the picture is stil vague.

I have enclosed a graph with expanation to give you more information about my question...

Along with this, I would add some more words here...

I mean in your buffers one can get information from various buffers, where in one of them it give -1 and +1 which indicates the trend accordingly.

This cannot be used by EA-s acccordingly... simply because, it does not give correct information, like when ZigZag is Downtrend, these figures are both +1 and - 1...

Buffer N5 and N6 cannot be used as well as it does not give information about exact Y coordinate (price) of ZigZig line, it only offers replicated values of previous Extremums... which is not of much [demand](https://www.metatrader5.com/en/terminal/help/indicators/trend_indicators/dema "MetaTrader 5 Help: Double Exponential Moving Average indicator").

We need the exact value of ZigZag line...not extremum... That is, if I am on bar 5 (for ex) I need not the price value of this bar, but ZigZag value of this bar.. That is intersection of Bar 5 and price value at the ZigZag graph...ent

I hope I could deliver my position. If not, please have a look to this attachment with full illustration...

![Evgeniy Chumakov](https://c.mql5.com/avatar/2025/10/68ebc5dc-dfa6.jpg "Evgeniy Chumakov")

**[Evgeniy Chumakov](/en/users/jack857752)**
|
1 Jan 2025 at 17:39

**Bahman Asgarov [#](/en/forum/478418#comment_55513874):**  

Dear Evgeniy,

The indicator has buffers that display the extremes of the zigzag and there are calculated buffers for building the same indicator.    
And it doesn't matter if someone likes the information in the calculated buffers or not. They are not created for that, but for building an indicator.   
The indicator draws a zigzag polyline. What it copes with and nothing else is provided in it.

![Bahman Asgarov](https://c.mql5.com/avatar/avatar_na2.png "Bahman Asgarov")

**[Bahman Asgarov](/en/users/bahmanasgerov)**
|
1 Jan 2025 at 21:13

Thanks Evgeniy, at least you  answered it. Though this answer does not help us))

I have not worked with indicators before. But I will do my best to see about.

By the way, I have just checked that, with ordinary [ZigZag indicator](/en/articles/646 "Article: The \"ZigZag\" indicator: a new look and new solutions ") the same result can be achieved (by adding up Depth paramerer let say up to 20-25) as well.

The difference is that ordinary ZigZag puts only extremum points and doesnt copy this value to non-extremums which makes it very easy to determine the current trend programmatically...

Anyway, thanks again for such good indicator, at least we can use it visually, since programmatic approach is not possible due to that shortoming...

Regards

Bahman

![Evgeniy Chumakov](https://c.mql5.com/avatar/2025/10/68ebc5dc-dfa6.jpg "Evgeniy Chumakov")

**[Evgeniy Chumakov](/en/users/jack857752)**
|
2 Jan 2025 at 08:59

**Bahman Asgarov [#](/en/forum/478418/page2#comment_55515127):**  

Thanks Evgeniy, at least you  answered it. Though this answer does not help us))

I have not worked with indicators before. But I will do my best to see about.

By the way, I have just checked that, with ordinary [ZigZag indicator](/en/articles/646 "Article: The \"ZigZag\" indicator: a new look and new solutions ") the same result can be achieved (by adding up Depth paramerer let say up to 20-25) as well.

The difference is that ordinary ZigZag puts only extremum points and doesnt copy this value to non-extremums which makes it very easy to determine the current trend programmatically...

Anyway, thanks again for such good indicator, at least we can use it visually, since programmatic approach is not possible due to that shortoming...

Regards

Bahman

Anything is possible! You just need to go through the required buffer and take the info. What kind of buffers were I talking about earlier. And there is no difference in getting them, even from this indicator, which is standard.

By the way, I have just checked that, with ordinary [ZigZag indicator](/en/articles/646 "Article: The \"ZigZag\" indicator: a new look and new solutions ") the same result can be achieved (by adding up Depth paramerer let say up to 20-25) as well.

No, it's not the same at all.  In my indicator, scale = the price itself, the price is taken as a percentage of the step.

![Evgeniy Chumakov](https://c.mql5.com/avatar/2025/10/68ebc5dc-dfa6.jpg "Evgeniy Chumakov")

**[Evgeniy Chumakov](/en/users/jack857752)**
|
2 Jan 2025 at 09:05

```mql5
SetIndexBuffer(0,ArrayHighZZ,INDICATOR_DATA);

SetIndexBuffer(1,ArrayLowZZ,INDICATOR_DATA);
```

To get the zigzag extremes, you need to go through these buffers and compare them with [EMPTY\_VALUE](/en/docs/constants/namedconstants/otherconstants "MQL5 documentation: Other Constants").  Where the value is unequal to it, there is an extremum.

```mql5
double MaxZZ = iCustom(Symbol(),PERIOD_CURRENT,"Indicator_Name",[Here is the input setting parameter],0,bar_number)

double MinZZ = iCustom(Symbol(),PERIOD_CURRENT,"Indicator_Name",[Here is the input setting parameter],1,bar_number)


```

You pass, if the value is not equal to EMPTY\_VALUE, then there is an extremum.

![ZigZag Step Points](https://c.mql5.com/i/code/indicator.png)
[ZigZag Step Points](/en/code/54067)

Another version of ZigZag, where the step size for changing the direction of the segment is set in price points.

![BuySellZigZag](https://c.mql5.com/i/code/indicator.png)
[BuySellZigZag](/en/code/53995)

Double ZigZag draws virtual Buy and Sell levels on the price chart.

![Surfing - 2 EMA strategy](https://c.mql5.com/i/code/expert.png)
[Surfing - 2 EMA strategy](/en/code/54396)

This is a pretty simple startegy that follows trend. Recommended time frams is D1.
when close price brakes up the EMA build based on high prices given that RSI is above 55 and RSI is above its Moving average - we buy.
when close price brakes down the EMA build based on low prices given that RSI is below 45 and RSI is below its moving average - we sell.
system closes previose trade if there is opposite signal
system uses take profit and stop loss as well as trailing stop

![Moving Average MTF](https://c.mql5.com/i/code/indicator.png)
[Moving Average MTF](/en/code/54662)

Moving average with calculated period based on timeframe