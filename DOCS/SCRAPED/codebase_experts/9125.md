# RUBBERBANDS_2 EA - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/9125

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/9125) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.metatrader.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# RUBBERBANDS\_2 EA - expert for MetaTrader 4

[StJojo](/en/users/stjojo)

Views:
:   38256

Rating:
:   (10)

Published:
:   17 August 2009, 09:30

Updated:
:   21 April 2014, 14:54
:   [RUBBERBANDS\_2.mq4](/en/code/download/9125/RUBBERBANDS_2.mq4 "RUBBERBANDS_2.mq4")
    (8.09 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/9125.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

RUBBERBANDS\_2 EA

Version 1.2

DON'T USE THIS EA FOR LIVE TRADING. I don't want to see anybody lose his/her account. I just wanted to give you some new idea.

- The external variable "quiescenow" has been added to quiesce this EA when the current session ends.

-- The logic for the closure of all outstanding orders has been modified.

-- Some external variables have been renamed to be more meaninghful:

useequityprofitcut -> use\_sessionTP  
dollareqprofitcut -> sessionTP  
useequitylosscut -> use\_sessionSL  
dollareqlosscut -> sessionSL

(The older version still works fine when used in a single currency pair and no other orders are outstanding in other currency pairs.)

This EA is an enhanced version of the original RUBBERBANDS EA. Just like RUBBERBANDS EA, it works in any timeframe for any currency pair, including gold and silver. Its logic, again, is based on the fact that any price movement may accompany rebound ("Delapsus Resurgam") and the maxim of "Sell high, buy low".

It opens orders in both directions (BUY & SELL) at a time initially, then opens an additional SELL order everytime the price goes up by multiples of "pipstep" above the initial SELL order, and opens an additional BUY order everytime the price goes down by multiples of "pipstep" below the initial BUY order.

It closes all the outstanding orders when the specified profit "sessionTP" (in dollars) is reached, which functions as TAKEPROFIT, or, if set so ("use\_sessionSL"==true), when the specified loss "sessionSL" (in dollars) is reached, which functions as STOPLOSS.

The opening of the initilal orders through the closure of all outstanding orders constitutes one "session".

The external variable "maxcount" limits the number of orders per session.

Use Strategy Tester to see how this EA performs.

Preferred currency pairs are four major pairs: EUR/USD, GBP/USD, USD/JPY, and USD/CHF. To avoid big drawdowns, smaller "sessionTP" may help.

External variables are:

Lots = 0.02 (number of lots for each order)

maxcount = 10 (maximum number of orders allowed in one session)

pipstep = 50 (pip distance to place additional BUY or SELL orders)

quiescenow = false (if true, quiesces this EA when the current session ends)

donow = false (if true, opens orders immediately)

stopnow = false (if true, stops this EA)

closenow = false (if true, closes all outstanding orders)

use\_sessionTP = true (don't change this)

sessionTP = 1000 (profit in dollars per lot to close all outstanding orders; functions as TAKEPROFIT)

use\_sessionSL = false (If true, uses "sessionSL" below)

sessionSL = 300 (loss in dollars per lot to close all outstanding orders; functions as STOPLOSS)

The following three external variables are for restarting this EA after, say, the weekend, when there are outstanding orders. "inmax" and "imin" are displayed as "GLBmax" and "GLBmin" on the chart.

useinvalues = false (set to true on restart)

inmax = 0 (set former max on restart)

inmin = 0 (set former min on restart)

**Last comments |
[Go to discussion](/en/forum/26833)**
(48)

![](https://c.mql5.com/avatar/avatar_na2.png)

**[Deleted]**
|
8 Dec 2009 at 21:59

I have a new Idea, but i dont know how to code it:

If we have a hedged Situation (f.e.: 10 Buy and 10 Sell) and the profit reached a minium of a specific level---> close all order

Is someone able to code that?

UPDATE:

I have a first idea but it doenst work fine. The EA opens a hedget
Position at the beginning, so i tried to define that the EA [only closes](https://www.mql5.com/en/docs/constants/environment_state/marketinfoconstants#enum_symbol_trade_mode "MQL5 documentation: Symbol properties")
all Positions if there were more than 5 Sell and Buy orders.

BUT: The EA closes at the beginning about 10x the first hedget
Position and after that he clothes nothing even if its hedget and we
have more than 5 Sell/5 Buy. Does someone know how to solve this?

CODE:

int BuyCnt = 0;  
int SellCnt = 0;

int abo = OrdersTotal();

  

for (int i=0; i < abo; i++)

  

{

  

if (!OrderSelect(i, SELECT\_BY\_POS, MODE\_TRADES)) continue;

  
  

int type = OrderType();

  

if (type == OP\_BUY) BuyCnt++;

  

if (type == OP\_SELL) SellCnt++;

  

}

  

if (BuyCnt<5 && SellCnt<5 && BuyCnt-SellCnt==0)

  

{

  
GLBcloseall=true;  
}

![](https://c.mql5.com/avatar/avatar_na2.png)

**[Deleted]**
|
27 May 2010 at 18:38

**ForExDRH:**  

Hi St Jojo etal,

I’m a new comer to the ForEx, but have used computers for over 30 years and have done a little bit of programming along the way. I have read your description of your RubberBands EA and understand how and why it works and think it is a good approach as well. From the little bit I have learned this is a type of [Martingale](/en/articles/1481 "Martingale") system like PipMaker though I may be mistaken about it being an apt description of your approach.

They both are great profit makers, but their downfall is that the losing trades don’t get canceled out EARLY.  A tight Stop Loss on the losing trade of hedging pairs makes it very profitable. I also have a great little commercial utility from PipBoxer.Com that is a 2 stage Trailing Stop Loss (PBTS) that helps these systems and is very reasonably priced. It works with your RubberBands AE but unfortunately not with PipMaker.

When I use these programs more in a Scalping mode, which they are great for as they recognize and place a lot of trades very quickly (when your AE is in ‘Safety Mode’) and manually close out the losing trade very early as soon it is clear which of the trades is definitely losing money and the other one of the pair is making money both of these approaches are VERY profitable.

I have no experience programming MT4 and I don’t know if personal circumstances will permit me to undertake programming in this area. At this stage if I am going to do it I will wait till MT5 comes out very soon.

I appeal to you as well as other programmers to put an adjustable Stop Loss and preferably a Trailing Stop Loss as well onto both your RubberBands AND PipMaker and these systems will be GREAT and VERY profitable EAs.

Thanks for sharing. (8 >) Prosperous Trading (< 8)

DougRH

  

What settings and which revision do you prefer when using the PBTS and Rubberbands as a scalper?

I like the PBTS. Thanks for the idea.

rsqzjek

![forex.tcfoo](https://c.mql5.com/avatar/avatar_na2.png "forex.tcfoo")

**[forex.tcfoo](/en/users/forex.tcfoo)**
|
25 Nov 2013 at 13:57

Trying to run LIVE but it is not possible. Anyone can help?

Running [DEMO account](https://www.mql5.com/en/docs/constants/environment_state/accountinformation#enum_account_trade_mode "MQL5 documentation: Account Properties") works perfectly

![Rasoul Mojtahedzadeh](https://c.mql5.com/avatar/2015/6/558F004E-DFBD.png "Rasoul Mojtahedzadeh")

**[Rasoul Mojtahedzadeh](/en/users/rasoul)**
|
25 Mar 2014 at 14:07

This is my back-testing results:

[![](https://c.mql5.com/3/35/TesterGraph_3_small__1.gif)](https://c.mql5.com/3/35/TesterGraph_3__1.gif)

![ed1210](https://c.mql5.com/avatar/avatar_na2.png "ed1210")

**[ed1210](/en/users/ed1210)**
|
22 May 2014 at 18:44

Which indicators does this expert use?

![XMA](https://c.mql5.com/i/code/indicator.png)
[XMA](/en/code/9123)

This Moving Average indicator has digital filter to detect trend and flat states of the market.

![Waddah Attar Super Support Resistance](https://c.mql5.com/i/code/indicator.png)
[Waddah Attar Super Support Resistance](/en/code/9122)

This Indicators Show You most of Support and Resistance Levels on your Chart .

![REI (Range Expansion Index) DeMark](https://c.mql5.com/i/code/indicator.png)
[REI (Range Expansion Index) DeMark](/en/code/9126)

The REI (Range Expansion Index) indicator by Thomas DeMark.

![Waddah Attar Scalping](https://c.mql5.com/i/code/indicator.png)
[Waddah Attar Scalping](/en/code/9130)

Waddah Attar Scalping indicator Shows you quick Trend.