# The pattern MACD - head and shoulders. Good but on rare occasions. - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/8212

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/8212) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# The pattern MACD - head and shoulders. Good but on rare occasions. - expert for MetaTrader 4

[Юрий](/en/users/fortrader.ru)  |
[English](javascript:void(false);)

[Русский](/ru/code/8212) [中文](/zh/code/8212) [Español](/es/code/8212) [Deutsch](/de/code/8212) [日本語](/ja/code/8212) [Português](/pt/code/8212)

Views:
:   14916

Rating:
:   (2)

Published:
:   27 June 2008, 08:27

Updated:
:   21 April 2014, 14:52
:   [MacdPatternTraderv03.mq4](/en/code/download/8212/MacdPatternTraderv03.mq4 "MacdPatternTraderv03.mq4")
    (7.65 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/8212.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The implementation of the pattern MACD head and shoulders

  

The original of the trade strategy is available by the link:  
[http://www.unfx.ru/strategies\_to\_trade/strategies\_134.php](https://www.mql5.com/go?link=http://www.unfx.ru/strategies_to_trade/strategies_134.php "http://www.unfx.ru/strategies_to_trade/strategies_134.php")

The EA was written to verify the effectiveness of the strategy described by the author, you can view the educt and the description of the EA in the latest issue of our journal:  
[http://www.fortrader.ru/ftgate.php?id=0&num=54](https://www.mql5.com/go?link=http://www.fortrader.ru/ftgate.php?id=0&num=54 "http://www.fortrader.ru/ftgate.php?id=0&amp;num=54")

### Short Description of the EA's Algorithm:

1. Time period: H4;  
2. Symbol: EURUSD;  
Volume: 1 lot  
3. Indicators: ЕMA7, EMA21, EMA359, SMA89. MACD 5,13,1.

Searching for a buy signal  
1. The MACD hystogram must form a minimum below -0,0030;  
2. Once the minimum below -0,0030 has been formed, the hystogram must form another lower-lying minimum below -0,0045;  
3. Once the minimum below -0,0045 has been formed, the hystogram must form another minimum that lies above the first and the second minimums;  
4. The stop-order is placed below the last local minimum by 10 points;  
5. The first target for 30% of the position is closed when the price's value is above the 21-peroid exponential average;  
6. The second target for the half of the position is closed when the price reaches the value betweeen the 89-period simple sliding average and the 365-period exponential average;  
7. The third target for the remaimig part of the position is closed when the price reaches the price resistance level.  
  
  
Searching for a sell signal  
1. The MACD hystogram must form a maximum above 0,0030;  
2. Once the maximum above 0,0030 has been formed, the hystogram must form another higher maximum above 0,0045;  
3. Once the maximum above 0,0045 has been formed, the hystogram must form another maximum that lies below the first and the second maximums;  
4. The stop-order is placed above the last local maximum by 10 points;  
5. The first target for 30% of the position is closed when the price's value is below the 21-peroid exponential average;  
6. The second target for the half of the position is closed when the price reaches the value between the 89-period simple sliding average and the 365-period exponential average;  
7. The third target for the remaimig part of the position is closed when the price reaches the price resistance level.  
  
  
  
Testing the EA with the standard parameters:

![](https://c.mql5.com/18/18/result.gif)

After optimizing the parameters:

![](https://c.mql5.com/18/18/optimize.gif)

Reasonably good combinations are obtained during working on the future and the past, read the details in our journal:  
[http://www.fortrader.ru/ftgate.php?id=0&num=54](https://www.mql5.com/go?link=http://www.fortrader.ru/ftgate.php?id=0&num=54 "http://www.fortrader.ru/ftgate.php?id=0&amp;num=54")

p/s All possible variables are outputted to the external parameters, you can pick up some good parameters for the intraday charts too, experiment. Testing with the ticks is dispensable. If you have any ideas about updating the EA or any questions, write.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/8212](/ru/code/8212)

**Last comments |
[Go to discussion](/en/forum/25529)**
(1)

![Piotr](https://c.mql5.com/avatar/2014/3/11820_1333136927.jpg "Piotr")

**[Piotr](/en/users/puncher)**
|
3 Jul 2008 at 06:54

**Hello,**

**Could you please try to help me write the EA like this:**  ['Can somebody try to write EA based on Taichi & deMarker indicators only on 1 hour charts?'](https://www.mql5.com/en/forum/109566)

**The above link is to my subject I have added last time on this MQL Forum...**

**Best regards,**

**Puncher**

**POL****AND**

![ZigAndZag_trader](https://c.mql5.com/i/code/expert.png)
[ZigAndZag\_trader](/en/code/8211)

At Bookkeeper's request, I've made an "egzpert advizor" by the ZigAndZag indicator, published at: http://codebase.mql4.com/ru/3681

![MultiIndicatorOptimizer](https://c.mql5.com/i/code/expert.png)
[MultiIndicatorOptimizer](/en/code/8217)

The EA uses 5 indicators.

![L_Correlation](https://c.mql5.com/i/code/indicator.png)
[L\_Correlation](/en/code/8224)

The correlation coefficient between the quotes charts of two currency pairs.

![Pendulum 1_01](https://c.mql5.com/i/code/expert.png)
[Pendulum 1\_01](/en/code/8223)

The parameters of working - Places two starting pending orders for buying and selling (the size of the lot is calculated automatically on the basis of the deposit size and the maximum increase of leverage from 0.01 to 0.07 lots) taking into account th