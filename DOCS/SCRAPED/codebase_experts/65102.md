# ConvertServerTime - library for MetaTrader 5

Source: https://www.mql5.com/en/code/65102

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/65102) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Libraries](https://c.mql5.com/i/code/library.png)

# ConvertServerTime - library for MetaTrader 5

[amrali](/en/users/amrali)  |
[English](javascript:void(false);)

[Русский](/ru/code/65102) [中文](/zh/code/65102) [Español](/es/code/65102) [Deutsch](/de/code/65102) [日本語](/ja/code/65102) [Português](/pt/code/65102) [한국어](/ko/code/65102) [Français](/fr/code/65102) [Italiano](/it/code/65102) [Türkçe](/tr/code/65102)

Views:
:   1342

Rating:
:   (5)

Published:
:   20 October 2025, 21:22

Updated:
:   27 October 2025, 12:05
:   [ConvertServerTime.mqh](/en/code/download/65102/ConvertServerTime.mqh "ConvertServerTime.mqh")
    (14.39 KB)
    [view](# "view")

    [Test.mq5](/en/code/download/65102/Test.mq5 "Test.mq5")
    (0.09 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/65102.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Here is a simplified function to convert server times (also stored times of bars, ticks, or economic calendar events) from one broker's time zone to another.

```mql5
//+------------------------------------------------------------------+
//| Convert server time from one broker's time zone to another.      |
//+------------------------------------------------------------------+
datetime  ConvertServerTime(
   const datetime   aTime,                             // source server time to convert
   const int        sourceOffsetUTC = 0,               // source server standard (winter) UTC offset in seconds
   const int        destinationOffsetUTC = 0,          // destination server standard (winter) UTC offset in seconds
   ENUM_RULE_DST    sourceRuleDST = DST_NONE,          // source server daylight savings schedule
   ENUM_RULE_DST    destinationRuleDST = DST_NONE      // destination server daylight savings schedule
  )
```

To be able to identify the DST schedules for the source and destination servers (US, EU, or no schedule), you can use that script [https://www.mql5.com/en/code/48650](/en/code/48650)

This function adopts the standard offset notation used in most programming languages (for example, JavaScript). In this convention, **positive time zones** (such as **GMT+3**) correspond to **positive offsets** (e.g., **+10800**), while **negative time zones** correspond to **negative offsets**.

Note that this is **the inverse of MQL5’s built-in** TimeGMTOffset() **function**, which represents **positive time zones** with **negative offsets** (e.g., **-10800**) and **negative time zones** with **positive offsets**.

This is a sample of running the function:

![](https://c.mql5.com/18/170/1.png)

**The output:**

![](https://c.mql5.com/18/170/2.png)

The complete library (*TimeZoneInfo.mqh*) with more features can be found here. [https://www.mql5.com/en/code/48419](/en/code/48419)

**Last comments |
[Go to discussion](/en/forum/498059)**
(31)

![fxsaber](https://c.mql5.com/avatar/2019/8/5D67260D-44C9.png "fxsaber")

**[fxsaber](/en/users/fxsaber)**
|
24 Oct 2025 at 09:38

**amrali [#](/en/forum/498059/page3#comment_58347619):**  

This makes it clear that servers under european scheduling (DST\_EU) work in the Eastern European Time (EET) time zone, UTC+3/+2.

European brokers may operate in different time zones, so I suggested doing so.

[Forum on trading, automated trading systems and testing trading strategies](/en/forum)

[Libraries: ConvertServerTime](/en/forum/498059/page2#comment_58338628)

[fxsaber](/en/users/fxsaber), 2025.10.23 06:20

I may be wrong, but it seems right.

```mql5
//   const int sourceOffsetDST        = GetDST(aTime, sourceRuleDST);
   const int sourceOffsetDST        = GetDST(aTime - sourceTotalOffset, sourceRuleDST);
```

And then the corresponding changes.

And this.

```mql5
      PrintFormat("ERROR: %s is invalid for %s GMT+0 (DST skipped this hour).", TimeToString(aTime), EnumToString(aRule));
```

![fxsaber](https://c.mql5.com/avatar/2019/8/5D67260D-44C9.png "fxsaber")

**[fxsaber](/en/users/fxsaber)**
|
24 Oct 2025 at 11:01

**amrali [#](/en/forum/498059/page3#comment_58345521):**  

Attached a script to scan M1-timeseries for the splits.

DST-navigate expert.

[![](https://c.mql5.com/3/477/1762543822161__1.png)](https://c.mql5.com/3/477/1762543822161.png "https://c.mql5.com/3/477/1762543822161.png")

![fxsaber](https://c.mql5.com/avatar/2019/8/5D67260D-44C9.png "fxsaber")

**[fxsaber](/en/users/fxsaber)**
|
24 Oct 2025 at 11:35

**fxsaber [#](/en/forum/498059/page3#comment_58348987):**  

DST-navigate expert.

With this tool it became immediately possible to write such DST detection logic.

```mql5
#property script_show_inputs

input string inCryptoSymbol = "BTCUSD";

bool BarIsExist( datetime Time, const string Symb, const ENUM_TIMEFRAMES TF = PERIOD_M15 )
{
  return(iBarShift(Symb, TF ,Time / PeriodSeconds(TF) * PeriodSeconds(TF), true) != -1);
}

void OnStart()
{
  const datetime DateEU = D'2025.03.30';
  const datetime DateUS = D'2024.11.03';
  
  const string CryptoSymbol = (inCryptoSymbol == "") ? _Symbol : inCryptoSymbol;
  
  bool ResEU = false;
  
  for (int i = -10; !ResEU && (i < 10); i++)
    if (ResEU = !BarIsExist(DateEU + 1800 + 3600 * i, CryptoSymbol))
      Print(AccountInfoString(ACCOUNT_SERVER) + ": DST_EUR, GMT" + ((i < 0) ? NULL : "+") + (string)i);

  if (!ResEU)  
    Print(AccountInfoString(ACCOUNT_SERVER) + ": " + (BarIsExist(DateUS, CryptoSymbol) ? "DST_NONE" : "DST_US"));
}
```

Result.

```mql5
RannForex-Server: DST_EUR, GMT+3
Exness-MT5Trial3: DST_NONE
FusionMarketsAU-Live: DST_US
```

![amrali](https://c.mql5.com/avatar/2021/7/60EB6C17-183F.jpg "amrali")

**[amrali](/en/users/amrali)**
|
24 Oct 2025 at 11:49

**fxsaber [#](/en/forum/498059/page3#comment_58349490):**  

With this tool it became immediately possible to write such DST detection logic.

Result.

Nice tool. I will test it.

Unfortunately, not working on my server.

[![](https://c.mql5.com/3/477/Screenshot_2025-10-24_150010__1.png)](https://c.mql5.com/3/477/Screenshot_2025-10-24_150010.png "https://c.mql5.com/3/477/Screenshot_2025-10-24_150010.png")

working: [Determine Broker's Daylight (DST) schedule](/en/code/48650)

![amrali](https://c.mql5.com/avatar/2021/7/60EB6C17-183F.jpg "amrali")

**[amrali](/en/users/amrali)**
|
24 Oct 2025 at 11:51

Fixed in v1.20:  

```mql5
int GetDST(const datetime aTime, const int baseUTC, const ENUM_RULE_DST aRule = DST_NONE)
  {
   if(aRule == DST_EU)
     {
      dst_start = MakeDateTime(iYear, 03, 31 - (4 + Y) % 7, 01) + baseUTC;  // the last Sunday of March for the EU switch (DST+1)
      dst_end   = MakeDateTime(iYear, 10, 31 - (1 + Y) % 7, 02) + baseUTC;  // the last Sunday of October for the EU switch (DST+0)
     }

   if(aRule == DST_US)
     {
      dst_start = MakeDateTime(iYear, 03, 14 - (1 + Y) % 7, 07) + baseUTC;  // the second Sunday of March for the US switch (DST+1)
      dst_end   = MakeDateTime(iYear, 11, 07 - (1 + Y) % 7, 07) + baseUTC;  // the first Sunday of November for the US switch (DST+0)
     }
  }
```

Using UTC hour for DST switch, then add baseUTC offset of broker's server.  
Works nicely with european and US-scheduling servers.

![StopLoss trailing classes library for MQL5](https://c.mql5.com/i/code/library.png)
[StopLoss trailing classes library for MQL5](/en/code/63926)

A set of classes for automatic moving of StopLoss of open positions by fixed indentation or by values of Parabolic SAR and moving averages indicators, or by specified position stop level.

![MACD Histogram MC](https://c.mql5.com/i/code/indicator.png)
[MACD Histogram MC](/en/code/65050)

MACD Histogram

![Bollinger Bands Squeeze](https://c.mql5.com/i/code/indicator.png)
[Bollinger Bands Squeeze](/en/code/65117)

It signals a period of low market volatility that is about to end, foreshadowing a significant price move.

![Simple Expert Advisor based on WPR, Bollinger Bands and ATR indicators](https://c.mql5.com/i/code/expert.png)
[Simple Expert Advisor based on WPR, Bollinger Bands and ATR indicators](/en/code/63916)

A simple strategy based on the signals of two indicators: Williams' Percent Range (WPR) and Bollinger Bands (BB). A position is opened only when the signals of both indicators coincide.