# ZigZag EA - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/21452

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/21452) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# ZigZag EA - expert for MetaTrader 5

satop  |
[English](javascript:void(false);)

[Русский](/ru/code/21452) [中文](/zh/code/21452) [Español](/es/code/21452) [Deutsch](/de/code/21452) [日本語](/ja/code/21452) [Português](/pt/code/21452)

Published by:
:   [Vladimir Karputov](/en/users/barabashkakvn)

Views:
:   23275

Rating:
:   (37)

Published:
:   23 August 2018, 13:06
:   [ZigZag EA.mq5](/en/code/download/21452/zigzag_ea.mq5 "ZigZag EA.mq5")
    (73.54 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/21452.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

**Author of the idea**: [Iurii Tokman](/en/users/satop "Iurii Tokman (satop)")

**MQL5 code author**: [barabashkakvn](/en/users/barabashkakvn)

The EA applies data from the ZigZag custom indicator. This indicator is used to define the channel. Buy Stop and Sell Stop pending orders are placed along the channel borders. After a pending order is activated, trailing can be enabled for a position. Stop loss and take profit values are specified in Fibo levels (0.0%, 23.6%, 38.2%, 50%, 61.8%, 100%, 161.8%, 261.8% and 423.6%).

![ZigZag EA](https://c.mql5.com/18/70/ZigZag_EA.png "ZigZag EA")

### Inputs

ZigZag settings:

* Depth;
* Deviation;
* Backstep.

EA operation time:

* Operation start, hours;
* Operation start, minutes;
* Operation stop, hours;
* Operation stop, minutes.

Channel and indent settings:

* Indent in points;
* Minimum channel size;
* Maximum channel size.

ММ settings:

* Lots;
* Risk.

EA settings:

* Stop loss in %;
* Take profit in %;
* Trailing Stop (in pips);
* Trailing Step (in pips);
* Show channel lines;
* magic number.

EURUSD,M15:

![ZigZag EA](https://c.mql5.com/18/70/ZigZag_EA__1.png "ZigZag EA")

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/21452](/ru/code/21452)

**Last comments |
[Go to discussion](/en/forum/275215)**
(63)

![YANETT PIRELA](https://c.mql5.com/avatar/avatar_na2.png "YANETT PIRELA")

**[YANETT PIRELA](/en/users/dalisnett)**
|
12 Sep 2023 at 04:52

Good, greetings thanks for your contributions, just a comment the robot has two [compilation errors](https://www.metatrader5.com/en/metaeditor/help/development/compile "MetaTrader 5 Help: Errors when compiling MQL5 programs in MetaTrader 5 client terminal"), could you say how to correct them, it is return

![Enrique Enguix](https://c.mql5.com/avatar/2025/9/68c108f2-b619.jpg "Enrique Enguix")

**[Enrique Enguix](/en/users/envex)**
|
14 Sep 2023 at 15:30

**YANETT PIRELA compilation errors could you say how to correct, is return**

The error is in this function:

```mql5
//+------------------------------------------------------------------+
//| Lots or risk in percent for a deal from a free margin |
//+------------------------------------------------------------------+
bool LotsOrRisk(const double lots,const double risk,const int digits_adjust)
  {
   if(lots<0.0 && risk<0.0)
     {
      Print(__FUNCTION__,", ERROR: Parameter (\"lots\" or \"risk\") can't be less than zero");
      return(false);
     }
   if(lots==0.0 && risk==0.0)
     {
      Print(__FUNCTION__,", ERROR: Trade is impossible: You have set \"lots\" == 0.0 and \"risk\" == 0.0");
      return(false);
     }
   if(lots>0.0 && risk>0.0)
     {
      Print(__FUNCTION__,", ERROR: Trade is impossible: You have set \"lots\" > 0.0 and \"risk\" > 0.0");
      return(false);
     }
   if(lots>0.0)
     {
      string err_text="";
      if(!CheckVolumeValue(lots,err_text))
        {
         Print(__FUNCTION__,", ERROR: ",err_text);
         return(false);
        }
     }
   else if(risk>0.0)
     {
      if(m_money!=NULL)
         delete m_money;
      m_money=new CMoneyFixedMargin;
      if(m_money!=NULL)
        {
         if(!m_money.Init(GetPointer(m_symbol),Period(),m_symbol.Point()*digits_adjust))
            return(INIT_FAILED);
         m_money.Percent(risk);
        }
      else
        {
         Print(__FUNCTION__,", ERROR: Object CMoneyFixedMargin is NULL");
         return(INIT_FAILED);
        }
     }
//---
   return(true);
  }
```

For it to work you must change return (INIT\_FAILED); by **return false;**

I guess it would work in a previous version, but now it is not a boolean expression.

![Jay Allen](https://c.mql5.com/avatar/2022/10/6338F655-6E3C.jpg "Jay Allen")

**[Jay Allen](/en/users/mrjayallen)**
|
17 Dec 2023 at 17:34

Anyone read Russian?

![Fernando Carreiro](https://c.mql5.com/avatar/2025/9/68d40cf8-38fb.png "Fernando Carreiro")

**[Fernando Carreiro](/en/users/fmic)**
|
17 Dec 2023 at 21:34

**Jay Allen [#](/en/forum/275215/page4#comment_51194652):** Anyone read Russian?

If you are referring to the code comments or text, then use Google translate or any other automated translation tool.

![Chan Dararith](https://c.mql5.com/avatar/2016/8/57B89A50-7E18.jpg "Chan Dararith")

**[Chan Dararith](/en/users/chandararith)**
|
16 Mar 2024 at 11:24

when i try to test this EA it shown that it was error not boolean

![Waddah_Attar_Trend_Candles_HTF](https://c.mql5.com/i/code/indicator.png)
[Waddah\_Attar\_Trend\_Candles\_HTF](/en/code/21450)

The Waddah\_Attar\_Trend\_Candles indicator with the timeframe selection option available in the input parameters.

![Waddah_Attar_Trend_Candles](https://c.mql5.com/i/code/indicator.png)
[Waddah\_Attar\_Trend\_Candles](/en/code/21449)

The candle chart based on Waddah\_Attar\_Trend histograms calculated using the Open, High, Low and Close price series of the price chart.

![XPeriodCandleSystem_HTF](https://c.mql5.com/i/code/indicator.png)
[XPeriodCandleSystem\_HTF](/en/code/21453)

The XPeriodCandleSystem indicator with the timeframe selection option available in the input parameters.

![Differential_Average_By_Sultonov_HTF](https://c.mql5.com/i/code/indicator.png)
[Differential\_Average\_By\_Sultonov\_HTF](/en/code/21455)

The Differential\_Average\_By\_Sultonov indicator with the timeframe selection option available in the input parameters.