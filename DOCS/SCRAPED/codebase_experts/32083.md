# MQL Plus Enhanced Error Handler Support - library for MetaTrader 5

Source: https://www.mql5.com/en/code/32083

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/32083) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Libraries](https://c.mql5.com/i/code/library.png)

# MQL Plus Enhanced Error Handler Support - library for MetaTrader 5

[Dominik Egert](/en/users/dominik_egert)

Views:
:   4377

Rating:
:   (22)

Published:
:   22 November 2020, 11:47

Updated:
:   14 May 2023, 13:22
:   \MQL5\Include\MQLplus\lib\_error\

    [lib\_error\_definitions.mqh](/en/code/download/32083/lib_error_definitions.mqh "lib_error_definitions.mqh")
    (19.44 KB)
    [view](# "view")

    [lib\_error\_functions.mqh](/en/code/download/32083/lib_error_functions.mqh "lib_error_functions.mqh")
    (8.36 KB)
    [view](# "view")

    [lib\_error\_main.mqh](/en/code/download/32083/lib_error_main.mqh "lib_error_main.mqh")
    (47.58 KB)
    [view](# "view")

    [lib\_errtxt\_mql4.mqh](/en/code/download/32083/lib_errtxt_mql4.mqh "lib_errtxt_mql4.mqh")
    (52.4 KB)
    [view](# "view")

    [lib\_errtxt\_mql4\_error\_codes.mqh](/en/code/download/32083/lib_errtxt_mql4_error_codes.mqh "lib_errtxt_mql4_error_codes.mqh")
    (31.02 KB)
    [view](# "view")

    [lib\_errtxt\_mql5.mqh](/en/code/download/32083/lib_errtxt_mql5.mqh "lib_errtxt_mql5.mqh")
    (614.85 KB)
    [view](# "view")

    [lib\_errtxt\_mql5\_error\_codes.mqh](/en/code/download/32083/lib_errtxt_mql5_error_codes.mqh "lib_errtxt_mql5_error_codes.mqh")
    (31.91 KB)
    [view](# "view")

    \MQL5\Include\MQLplus\lib\_error\error\_language\_files\

    [lib\_error\_descriptions\_mt5\_fr.csv](/en/code/download/32083/lib_error_descriptions_mt5_fr.csv "lib_error_descriptions_mt5_fr.csv")
    (24.06 KB)
    [view](# "view")

    \MQL5\Include\MQLplus\

    [lib\_error.mqh](/en/code/download/32083/lib_error.mqh "lib_error.mqh")
    (12.1 KB)
    [view](# "view")

    \MQL5\Libraries\LibError\

    [LibError.mq5](/en/code/download/32083/liberror.mq5 "LibError.mq5")
    (1.64 KB)
    [view](# "view")

    \MQL5\Experts\LibError\_Example\

    [LibError\_HowTo.mq5](/en/code/download/32083/liberror_howto.mq5 "LibError_HowTo.mq5")
    (17.87 KB)
    [view](# "view")

    [Expand (11)](javascript:void(false))
    [Collapse (11)](javascript:void(false))

    [Download as ZIP](/en/code/download/32083.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Change-Log 4.2

* Bugfixes, compatibilitishues resolved.
* Fixed error in UserErrorHandler function signature.

Change-Log 4.0

* Recreated the whole code structure to support shared library compilation as wel las header include compilation
* Supports external CSV-File as supply for mql error codes
* Is MQL4 compatible
* All MQL4 and MQL5 Languages are included
* Supports MQL API function shadowing to be turned on or off

From now on the project is distributed as shared project over MQL cloud storage. You are welcome to contribute to the code.

You will need "MQLplus Include Library Collection" Project. optionally add the "MQLplus Enhanced Error Handler Library" Project to your files to have the shared binary library compiled as well as get an example project, showing the usage of the library.

Change-Log 3.12

* Massive improvements to all aspects of the errror code generation and handling
* Compatibility with MQL4 integrated
* Support for user supplied OnError() function definition, see beginning of lib\_error.mql-file
* Overwrite Built-In function SetUserError()
* Translation of error messages to almost all supported languages by MQL

Current Version 3.12

Encapsulates error code and text handling.

Supported features:

* User defined error codes
* Error code groups
* Customizable output string
* Seemless integration

Error code handling and error code resolving to text messages is a pain. This include file will solve some of the daily issues of handling error codes.

Example output:

[![](https://c.mql5.com/18/103/4272794142445__1.png)](https://c.mql5.com/18/103/4272794142445.png "https://c.mql5.com/18/103/4272794142445.png")

This output was produced by ObjectGetInteger() in exaple code below.

Example code:

```mql5
/////////////////////////////////////////
//
//  Handle user specified warning codes 
//  as errors.
//
#define LIB_ERR_LEVEL_WARNING_AS_ERROR
#include <mqlplus/lib_error.mqh>


/*
*********************************************************************************************************
*  Provider return codes                                                                                *
*********************************************************************************************************
*/

// Define error group id
#define EA_ERRGROUP_CODE_EA_CORE            0x01

// Defined return codes
#define CORE_SUCCESS                            LIB_ERROR_CODE(EA_ERRGROUP_CODE_EA_CORE, 0x00)
#define CORE_INFO_CORE_READY                    LIB_ERROR_CODE_HANDLED(EA_ERRGROUP_CODE_EA_CORE, 0x01)
#define CORE_WARN_PENDING_OPERATION             LIB_ERROR_CODE_WARNING(EA_ERRGROUP_CODE_EA_CORE, 0x01)

// Define message resolver
LIB_ERR_REGISTER_RESOLVER_BEGIN(EA_ERRGROUP_CODE_EA_CORE)
    LIB_ERR_REGISTER_RESOLVER_MSGCODE(CORE_SUCCESS,                     "CORE_SUCCESS",                     "Operation success. An order has been processed.")
    LIB_ERR_REGISTER_RESOLVER_MSGCODE(CORE_INFO_CORE_READY,             "CORE_INFO_CORE_READY",             "Expert advisor: Core ready.")
    LIB_ERR_REGISTER_RESOLVER_MSGCODE(CORE_WARN_PENDING_OPERATION,      "CORE_WARN_PENDING_OPERATION",      "A pending operation is awaiting confirmation.")
LIB_ERR_REGISTER_RESOLVER_END(EA_ERRGROUP_CODE_EA_CORE)








//+------------------------------------------------------------------+
//| Expert initialization function                                   |
//+------------------------------------------------------------------+
int OnInit()
  {
//---

    // Set a user defined error code
    SetUserError(CORE_INFO_CORE_READY);

   
//---
   return(INIT_SUCCEEDED);
  }




//+------------------------------------------------------------------+
//| Expert deinitialization function                                 |
//+------------------------------------------------------------------+
void OnDeinit(const int reason)
  {
//---

    // Perform some check    
    check_for_pending_orders();

    // Retrieve error code and display its text
    OnError();
    



//---
   return;
  }



//+------------------------------------------------------------------+
//| Expert tick function                                             |
//+------------------------------------------------------------------+
void OnTick()
  {
//---

    // Retrieve the error code
    int err_code = NULL;

    // Update some state by function
    if( (!some_function())
     && (OnError(err_code)) )   // Display error message in journal and retrieve its corresponding error number
    {
        // Last error code is saved in err_code

        return;
    }


    // Continue processing


//---
    return;   
  }
//+------------------------------------------------------------------+




//+------------------------------------------------------------------+
//| check_for_pending_orders()                                       |
//+------------------------------------------------------------------+
void check_for_pending_orders()
  {
//---

    // Set a user defined error code
    SetUserError(CORE_WARN_PENDING_OPERATION);


//---
   return;
  }



//+------------------------------------------------------------------+
//| some_function()                                                  |
//+------------------------------------------------------------------+
bool some_function()
  {
//---
    // Error status
    bool err = false;


    // Perform some eventually failing operation
    err |= (!err) && !ObjectGetInteger(ChartID(), "", OBJPROP_COLOR) && OnError(__LINE__);


    // Set a user defined error code
    err |= (!err) && SetUserError(CORE_SUCCESS);

//---
   return(!err);
  }


```

**Last comments |
[Go to discussion](/en/forum/356266)**
(6)

![Dominik Egert](https://c.mql5.com/avatar/2024/2/65db1363-e44b.jpg "Dominik Egert")

**[Dominik Egert](/en/users/dominik_egert)**
|
2 May 2022 at 14:36

From now on this project is part of MQLplus Library and shared via Shared Cloud Storage. You can find the current source files under "MQLplus" "MQLplus Include Library Collection".

To make use of the shared binary library as well as on how to use the code, see the Shared Cloud Storage Project "LibError" "MQLplus Enhanced [Error Handler](https://www.mql5.com/en/articles/2041 "Article: Error Handling and Logging in MQL5 ") Library". it includes two files, one to compile the actual library to binary, and another to show its usage.

For those who need to compile the source into one ex4/5 file, all you need to do is remove the define-flag as show and documented in the HowTo-Project.

Also I welcome anyone to contribute to the code.

![hini](https://c.mql5.com/avatar/2024/3/65e98921-0708.jpg "hini")

**[hini](/en/users/hini)**
|
7 Sep 2024 at 18:45

Hello author, how do I use the macro LIB\_ERROR\_IMPORT\_SHARED\_LIBRARY ? I defined the macro, but during runtime it shows an error message: cannot [open file](https://www.mql5.com/en/docs/files/fileopen "MQL5 documentation: FileOpen function") 'LibError.ex5'

![hini](https://c.mql5.com/avatar/2024/3/65e98921-0708.jpg "hini")

**[hini](/en/users/hini)**
|
7 Sep 2024 at 19:47

```mql5
  string str= "sss";
  int n = (int)str;
  SetMqlError(5040, "some output...");
  OnError();
```

What is the function of the second parameter of SetMqlError? Why don't I see its output, only the official default output

![Dominik Egert](https://c.mql5.com/avatar/2024/2/65db1363-e44b.jpg "Dominik Egert")

**[Dominik Egert](/en/users/dominik_egert)**
|
18 Sep 2024 at 15:48

**hini [#](/en/forum/356266#comment_54514555):**  
 Hello author, how do I use the macro LIB\_ERROR\_IMPORT\_SHARED\_LIBRARY ? I defined the macro, but during runtime it shows an error message: cannot [open file](/en/docs/files/fileopen "MQL5 documentation: FileOpen function") 'LibError.ex5'

Because you first need to compile the actual shared library. You can do this with the attached file.

Place it into Libraries/LibError/\* and compile it.

Then, in your project, you can use the shared library.

![Dominik Egert](https://c.mql5.com/avatar/2024/2/65db1363-e44b.jpg "Dominik Egert")

**[Dominik Egert](/en/users/dominik_egert)**
|
18 Sep 2024 at 18:20

**hini [#](/en/forum/356266#comment_54514763):**  

What is the function of the second parameter of SetMqlError? Why don't I see its output, only the official default output

This is actually a "bug", I forgot to add the code for inserting the comment string.

In file lib\_error\_main.mqh at line 614, you will find this:

```mql5
        { error_string = LIB_NAMESPACE(lib_err, func_ptr_mql_err_codes)(error_code); }
```

you will need to replace it with this:

```mql5
        { error_string = ::StringFormat("%s %s", LIB_NAMESPACE(lib_err, func_ptr_mql_err_codes)(error_code), LIB_NAMESPACE(lib_err, err_desc_comment)()); }
```

I will update the code in the codebase when I find some time...

![Camarilla Points](https://c.mql5.com/i/code/indicator.png)
[Camarilla Points](/en/code/32073)

Indicator Camarilla Points "Stocks & Commodities V. 31:3 (pg. 10-15)"

![MQL Plus Enhanced Debugging Support](https://c.mql5.com/i/code/library.png)
[MQL Plus Enhanced Debugging Support](/en/code/32071)

An (optional) include file to enhance debugging experience.

![Doulble MA Cross Draw Histogram MT5](https://c.mql5.com/i/code/indicator.png)
[Doulble MA Cross Draw Histogram MT5](/en/code/32111)

Doulble MA Cross Draw Histogram MT5

![state - behavioral design pattern](https://c.mql5.com/i/code/library.png)
[state - behavioral design pattern](/en/code/32121)

allow an object to alter its behavior when its internal state changes. the object will appear to change its class