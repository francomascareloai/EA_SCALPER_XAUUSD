---
title: "CustomTicksAdd"
url: "https://www.mql5.com/en/docs/customsymbols/customticksadd"
hierarchy: []
scraped_at: "2025-11-28 09:31:47"
---

# CustomTicksAdd

[MQL5 Reference](/en/docs "MQL5 Reference")[Custom Symbols](/en/docs/customsymbols "Custom Symbols")CustomTicksAdd

* [CustomSymbolCreate](/en/docs/customsymbols/customsymbolcreate "CustomSymbolCreate")
* [CustomSymbolDelete](/en/docs/customsymbols/customsymboldelete "CustomSymbolDelete")
* [CustomSymbolSetInteger](/en/docs/customsymbols/customsymbolsetinteger "CustomSymbolSetInteger")
* [CustomSymbolSetDouble](/en/docs/customsymbols/customsymbolsetdouble "CustomSymbolSetDouble")
* [CustomSymbolSetString](/en/docs/customsymbols/customsymbolsetstring "CustomSymbolSetString")
* [CustomSymbolSetMarginRate](/en/docs/customsymbols/customsymbolsetmarginrate "CustomSymbolSetMarginRate")
* [CustomSymbolSetSessionQuote](/en/docs/customsymbols/customsymbolsetsessionquote "CustomSymbolSetSessionQuote")
* [CustomSymbolSetSessionTrade](/en/docs/customsymbols/customsymbolsetsessiontrade "CustomSymbolSetSessionTrade")
* [CustomRatesDelete](/en/docs/customsymbols/customratesdelete "CustomRatesDelete")
* [CustomRatesReplace](/en/docs/customsymbols/customratesreplace "CustomRatesReplace")
* [CustomRatesUpdate](/en/docs/customsymbols/customratesupdate "CustomRatesUpdate")
* CustomTicksAdd
* [CustomTicksDelete](/en/docs/customsymbols/customticksdelete "CustomTicksDelete")
* [CustomTicksReplace](/en/docs/customsymbols/customticksreplace "CustomTicksReplace")
* [CustomBookAdd](/en/docs/customsymbols/custombookadd "CustomBookAdd")

# CustomTicksAdd

Adds data from an array of the [MqlTick](/en/docs/constants/structures/mqltick) type to the price history of a custom symbol. The custom symbol must be [selected](/en/docs/marketinformation/symbolselect) in the Market Watch window.

| |
| --- |
| int  CustomTicksAdd(    const string     symbol,             // Symbol name    const MqlTick&   ticks[],            // The array with tick data that should be applied to the custom symbol    uint             count=WHOLE\_ARRAY   // number of the ticks[] array elements to be used    ); |

Parameters

symbol

[in]  The name of the custom symbol.

ticks[]

[in]   An array of tick data of the [MqlTick](/en/docs/constants/structures/mqltick) type arranged in order of time from earlier data to more recent ones, i.e. ticks[k].time\_msc <= ticks[n].time\_msc, if k<n.

count=WHOLE\_ARRAY

[in]  Number of the ticks[] array elements to be used for adding. [WHOLE\_ARRAY](/en/docs/constants/namedconstants/otherconstants) means that all ticks[] array elements should be used.

Return Value

The number of added ticks or -1 in case of an [error](/en/docs/constants/errorswarnings/errorcodes).

Further Note

The CustomTicksAdd function only works for custom symbols opened in the Market Watch window. If the symbol is not selected in Market Watch, then you should add ticks using [CustomTicksReplace](/en/docs/customsymbols/customticksreplace).

The CustomTicksAdd function allows transmitting ticks as if they are delivered from the broker's server. Data are sent to the Market Watch window instead of being written directly to the tick database. The terminal then saves ticks from the Market Watch to a database. If the amount of data transmitted during one function call is large, the behavior of the function changes in order to reduce resource usage. If more than 256 ticks are passed, data is divided into two parts. The first, i.e. the larger part is written directly to the tick database (as it is done in [CustomTicksReplace](/en/docs/customsymbols/customticksreplace)). The second part containing 128 ticks is passed to the Market Watch window, from which the terminal saves the ticks to a database.

The [MqlTick](/en/docs/constants/structures/mqltick) structure has two fields with the time value: time (the tick time in seconds) and  time\_msc (the tick time in milliseconds), which are counted from January 1, 1970. These fields in the added ticks are processed in the following order:

1. If ticks[k].time\_msc!=0, we use it to fill the ticks[k].time field, i.e. ticks[k].time=ticks[k].time\_msc/1000 (integer division) is set for the tick
2. If ticks[k].time\_msc==0 and ticks[k].time!=0, time in milliseconds is obtained by multiplying by 1000, i.e. ticks[k].time\_msc=ticks[k].time\*1000
3. If ticks[k].time\_msc==0 and ticks[k].time==0, the current [trade server time](/en/docs/dateandtime/timetradeserver) up to a millisecond as of the moment of CustomTicksAdd call is written to these fields.

If the value of ticks[k].bid, ticks[k].ask, ticks[k].last or ticks[k].volume is greater than zero, a combination of appropriate flags is written to the ticks[k].flags field:

* TICK\_FLAG\_BID – the tick has changed the bid price
* TICK\_FLAG\_ASK  – the tick has changed the ask price
* TICK\_FLAG\_LAST – the tick has changed the last deal price
* TICK\_FLAG\_VOLUME – the tick has changed the volume

If the value of a field is less than or equal to zero, the corresponding flag is not written to the ticks[k].flags field.

 

Flags TICK\_FLAG\_BUY and TICK\_FLAG\_SELL are not added to the history of a custom symbol.

 

Example:

| |
| --- |
| //+------------------------------------------------------------------+ //|                                               CustomTicksAdd.mq5 | //|                                  Copyright 2024, MetaQuotes Ltd. | //|                                             https://www.mql5.com | //+------------------------------------------------------------------+ #property copyright "Copyright 2024, MetaQuotes Ltd." #property link      "https://www.mql5.com" #property version   "1.00"   #define   CUSTOM\_SYMBOL\_NAME     Symbol()+".C"     // custom symbol name #define   CUSTOM\_SYMBOL\_PATH     "Forex"           // name of the group, in which a symbol is to be created #define   CUSTOM\_SYMBOL\_ORIGIN   Symbol()          // name of a symbol a custom one is to be based on   #define   DATATICKS\_TO\_COPY      UINT\_MAX          // number of ticks copied #define   DATATICKS\_TO\_PRINT     20                // number of ticks sent to the journal   //+------------------------------------------------------------------+ //| Script program start function                                    | //+------------------------------------------------------------------+ void OnStart()   { //--- get the error code when creating a custom symbol    int create=CreateCustomSymbol(CUSTOM\_SYMBOL\_NAME, CUSTOM\_SYMBOL\_PATH, CUSTOM\_SYMBOL\_ORIGIN);     //--- if the error code is not 0 (successful symbol creation) and not 5304 (symbol has already been created) - leave    if(create!=0 && create!=5304)       return;   //--- get the standard symbol tick data to the MqlTick array    MqlTick array[]={};    if(!GetTicksToArray(CUSTOM\_SYMBOL\_ORIGIN, DATATICKS\_TO\_COPY, array))       return;     //--- print the time of the first and last received ticks of the standard symbol    int total=(int)array.Size();    PrintFormat("First tick time: %s.%03u, Last tick time: %s.%03u",                TimeToString(array[0].time, TIME\_DATE|TIME\_MINUTES|TIME\_SECONDS), array[0].time\_msc%1000,                TimeToString(array[total-1].time, TIME\_DATE|TIME\_MINUTES|TIME\_SECONDS), array[total-1].time\_msc%1000);                 //--- print DATATICKS\_TO\_PRINT last ticks of the standard symbol in the journal    PrintFormat("\nThe last %d ticks for the standard symbol '%s':", DATATICKS\_TO\_PRINT, CUSTOM\_SYMBOL\_ORIGIN);    for(int i=total-DATATICKS\_TO\_PRINT; i<total; i++)      {       if(i<0)          continue;       PrintFormat("  %dth Tick: %s", i, GetTickDescription(array[i]));      }     //--- add a custom symbol to the MarketWatch window    ResetLastError();    if(!SymbolSelect(CUSTOM\_SYMBOL\_NAME, true))      {       Print("SymbolSelect() failed. Error ", GetLastError());       return;      }       //--- add the tick array data to the custom symbol price history    Print("...");    uint start=GetTickCount();    PrintFormat("Start of adding %u ticks to the history of the custom symbol '%s'", array.Size(), CUSTOM\_SYMBOL\_NAME);    int added=CustomTicksAdd(CUSTOM\_SYMBOL\_NAME, array);    PrintFormat("Added %u ticks to the history of the custom symbol '%s' in %u ms", added, CUSTOM\_SYMBOL\_NAME, GetTickCount()-start);     //--- get the custom symbol tick data to the MqlTick array    Print("...");    if(!GetTicksToArray(CUSTOM\_SYMBOL\_NAME, array.Size(), array))       return;     //--- print the time of the first and last received ticks of the custom symbol    total=(int)array.Size();    PrintFormat("First tick time: %s.%03u, Last tick time: %s.%03u",                TimeToString(array[0].time, TIME\_DATE|TIME\_MINUTES|TIME\_SECONDS), array[0].time\_msc%1000,                TimeToString(array[total-1].time, TIME\_DATE|TIME\_MINUTES|TIME\_SECONDS), array[total-1].time\_msc%1000);                 //--- print DATATICKS\_TO\_PRINT last ticks of the custom symbol in the journal    PrintFormat("\nThe last %d ticks for the custom symbol '%s':", DATATICKS\_TO\_PRINT, CUSTOM\_SYMBOL\_NAME);    for(int i=total-DATATICKS\_TO\_PRINT; i<total; i++)      {       if(i<0)          continue;       PrintFormat("  %dth Tick: %s", i, GetTickDescription(array[i]));      }   //--- display a hint about the script termination keys on the chart comment    Comment(StringFormat("Press 'Esc' to exit or 'Del' to delete the '%s' symbol and exit", CUSTOM\_SYMBOL\_NAME)); //--- wait for pressing the Esc or Del keys to exit in an endless loop    while(!IsStopped() && TerminalInfoInteger(TERMINAL\_KEYSTATE\_ESCAPE)==0)      {       Sleep(16);       //--- when pressing Del, delete the created custom symbol and its data       if(TerminalInfoInteger(TERMINAL\_KEYSTATE\_DELETE)<0)         {          //--- delete bar data          int deleted=CustomRatesDelete(CUSTOM\_SYMBOL\_NAME, 0, LONG\_MAX);          if(deleted>0)             PrintFormat("%d history bars of the custom symbol '%s' were successfully deleted", deleted, CUSTOM\_SYMBOL\_NAME);                    //--- delete tick data          deleted=CustomTicksDelete(CUSTOM\_SYMBOL\_NAME, 0, LONG\_MAX);          if(deleted>0)             PrintFormat("%d history ticks of the custom symbol '%s' were successfully deleted", deleted, CUSTOM\_SYMBOL\_NAME);                    //--- delete symbol          if(DeleteCustomSymbol(CUSTOM\_SYMBOL\_NAME))             PrintFormat("Custom symbol '%s' deleted successfully", CUSTOM\_SYMBOL\_NAME);          break;         }      } //--- clear the chart before exiting    Comment("");    /\*    result:    Requested 4294967295 ticks to download tick history for the symbol 'EURUSD'    The tick history for the 'EURUSD' symbol is received in the amount of 351183943 ticks in 56454 ms    First tick time: 2011.12.19 00:00:08.000, Last tick time: 2024.06.20 21:18:12.010        The last 20 ticks for the standard symbol 'EURUSD':      351183923th Tick: 2024.06.20 21:17:46.380 Bid=1.07124 (Info tick)      351183924th Tick: 2024.06.20 21:17:47.779 Ask=1.07125 Bid=1.07125 (Info tick)      351183925th Tick: 2024.06.20 21:17:48.584 Ask=1.07124 Bid=1.07124 (Info tick)      351183926th Tick: 2024.06.20 21:17:49.481 Ask=1.07125 (Info tick)      351183927th Tick: 2024.06.20 21:17:49.985 Ask=1.07122 Bid=1.07122 (Info tick)      351183928th Tick: 2024.06.20 21:17:50.482 Ask=1.07124 Bid=1.07124 (Info tick)      351183929th Tick: 2024.06.20 21:17:51.584 Ask=1.07123 Bid=1.07123 (Info tick)      351183930th Tick: 2024.06.20 21:17:52.786 Ask=1.07124 Bid=1.07124 (Info tick)      351183931th Tick: 2024.06.20 21:17:53.487 Ask=1.07125 Bid=1.07125 (Info tick)      351183932th Tick: 2024.06.20 21:17:53.989 Ask=1.07126 Bid=1.07126 (Info tick)      351183933th Tick: 2024.06.20 21:17:55.789 Ask=1.07125 Bid=1.07125 (Info tick)      351183934th Tick: 2024.06.20 21:17:58.495 Ask=1.07126 Bid=1.07126 (Info tick)      351183935th Tick: 2024.06.20 21:18:00.102 Bid=1.07126 (Info tick)      351183936th Tick: 2024.06.20 21:18:00.698 Ask=1.07129 Bid=1.07129 (Info tick)      351183937th Tick: 2024.06.20 21:18:03.699 Bid=1.07129 (Info tick)      351183938th Tick: 2024.06.20 21:18:04.699 Ask=1.07128 Bid=1.07128 (Info tick)      351183939th Tick: 2024.06.20 21:18:05.901 Ask=1.07129 Bid=1.07129 (Info tick)      351183940th Tick: 2024.06.20 21:18:07.606 Ask=1.07128 Bid=1.07128 (Info tick)      351183941th Tick: 2024.06.20 21:18:11.512 Ask=1.07127 Bid=1.07127 (Info tick)      351183942th Tick: 2024.06.20 21:18:12.010 Ask=1.07126 Bid=1.07126 (Info tick)    ...    Start of adding 351183943 ticks to the history of the custom symbol 'EURUSD.C'    Added 351183943 ticks to the history of the custom symbol 'EURUSD.C' in 269890 ms    ...    Requested 351183943 ticks to download tick history for the symbol 'EURUSD.C'    The tick history for the 'EURUSD.C' symbol is received in the amount of 351183943 ticks in 116407 ms    First tick time: 2011.12.19 00:00:08.000, Last tick time: 2024.06.20 21:18:12.010        The last 20 ticks for the custom symbol 'EURUSD.C':      351183923th Tick: 2024.06.20 21:17:46.380 Ask=1.07124 Bid=1.07124 (Info tick)      351183924th Tick: 2024.06.20 21:17:47.779 Ask=1.07125 Bid=1.07125 (Info tick)      351183925th Tick: 2024.06.20 21:17:48.584 Ask=1.07124 Bid=1.07124 (Info tick)      351183926th Tick: 2024.06.20 21:17:49.481 Ask=1.07125 Bid=1.07125 (Info tick)      351183927th Tick: 2024.06.20 21:17:49.985 Ask=1.07122 Bid=1.07122 (Info tick)      351183928th Tick: 2024.06.20 21:17:50.482 Ask=1.07124 Bid=1.07124 (Info tick)      351183929th Tick: 2024.06.20 21:17:51.584 Ask=1.07123 Bid=1.07123 (Info tick)      351183930th Tick: 2024.06.20 21:17:52.786 Ask=1.07124 Bid=1.07124 (Info tick)      351183931th Tick: 2024.06.20 21:17:53.487 Ask=1.07125 Bid=1.07125 (Info tick)      351183932th Tick: 2024.06.20 21:17:53.989 Ask=1.07126 Bid=1.07126 (Info tick)      351183933th Tick: 2024.06.20 21:17:55.789 Ask=1.07125 Bid=1.07125 (Info tick)      351183934th Tick: 2024.06.20 21:17:58.495 Ask=1.07126 Bid=1.07126 (Info tick)      351183935th Tick: 2024.06.20 21:18:00.102 Ask=1.07126 Bid=1.07126 (Info tick)      351183936th Tick: 2024.06.20 21:18:00.698 Ask=1.07129 Bid=1.07129 (Info tick)      351183937th Tick: 2024.06.20 21:18:03.699 Ask=1.07129 Bid=1.07129 (Info tick)      351183938th Tick: 2024.06.20 21:18:04.699 Ask=1.07128 Bid=1.07128 (Info tick)      351183939th Tick: 2024.06.20 21:18:05.901 Ask=1.07129 Bid=1.07129 (Info tick)      351183940th Tick: 2024.06.20 21:18:07.606 Ask=1.07128 Bid=1.07128 (Info tick)      351183941th Tick: 2024.06.20 21:18:11.512 Ask=1.07127 Bid=1.07127 (Info tick)      351183942th Tick: 2024.06.20 21:18:12.010 Ask=1.07126 Bid=1.07126 (Info tick)    \*/   } //+------------------------------------------------------------------+ //| Create a custom symbol, return an error code                     | //+------------------------------------------------------------------+ int CreateCustomSymbol(const string symbol\_name, const string symbol\_path, const string symbol\_origin=NULL)   { //--- define the name of a symbol a custom one is to be based on    string origin=(symbol\_origin==NULL ? Symbol() : symbol\_origin);     //--- if failed to create a custom symbol and this is not error 5304, report this in the journal    ResetLastError();    int error=0;    if(!CustomSymbolCreate(symbol\_name, symbol\_path, origin))      {       error=GetLastError();       if(error!=5304)          PrintFormat("CustomSymbolCreate(%s, %s, %s) failed. Error %d", symbol\_name, symbol\_path, origin, error);      } //--- successful    return(error);   } //+------------------------------------------------------------------+ //| Remove a custom symbol                                           | //+------------------------------------------------------------------+ bool DeleteCustomSymbol(const string symbol\_name)   { //--- hide the symbol from the Market Watch window    ResetLastError();    if(!SymbolSelect(symbol\_name, false))      {       PrintFormat("SymbolSelect(%s, false) failed. Error %d", GetLastError());       return(false);      }        //--- if failed to delete a custom symbol, report this in the journal and return 'false'    ResetLastError();    if(!CustomSymbolDelete(symbol\_name))      {       PrintFormat("CustomSymbolDelete(%s) failed. Error %d", symbol\_name, GetLastError());       return(false);      } //--- successful    return(true);   } //+------------------------------------------------------------------+ //| Get the specified number of ticks in the array                   | //+------------------------------------------------------------------+ bool GetTicksToArray(const string symbol, const uint count, MqlTick &array[])   { //--- notify of the start of loading historical data    PrintFormat("Requested %u ticks to get tick history for the symbol '%s'", count, symbol);     //--- make 3 attempts to receive ticks     int attempts=0;    while(attempts<3)      {       //--- measure the start time before receiving the ticks       uint start=GetTickCount();              //--- request the tick history since 1970.01.01 00:00.001 (parameter from=1 ms)       int received=CopyTicks(symbol, array, COPY\_TICKS\_ALL, 1, count);       if(received!=-1)         {          //--- display information about the number of ticks and spent time           PrintFormat("The tick history for the '%s' symbol is received in the amount of %u ticks in %d ms", symbol, received, GetTickCount()-start);                    //--- if the tick history is synchronized, the error code is equal to zero - return 'true'          if(GetLastError()==0)             return(true);            PrintFormat("%s: Ticks are not synchronized yet, %d ticks received for %d ms. Error=%d",                       symbol, received, GetTickCount()-start, GetLastError());         }       //--- count attempts        attempts++;        //--- a one-second pause to wait for the end of synchronization of the tick database        Sleep(1000);      } //--- failed to copy ticks in 3 attempts    return(false);   } //+------------------------------------------------------------------+  //| return the string description of a tick                          |  //+------------------------------------------------------------------+  string GetTickDescription(MqlTick &tick)    {     string desc=StringFormat("%s.%03u ", TimeToString(tick.time, TIME\_DATE|TIME\_MINUTES|TIME\_SECONDS),tick.time\_msc%1000);     //--- check tick flags    bool buy\_tick   = ((tick.flags &TICK\_FLAG\_BUY)   == TICK\_FLAG\_BUY);     bool sell\_tick  = ((tick.flags &TICK\_FLAG\_SELL)  == TICK\_FLAG\_SELL);     bool ask\_tick   = ((tick.flags &TICK\_FLAG\_ASK)   == TICK\_FLAG\_ASK);     bool bid\_tick   = ((tick.flags &TICK\_FLAG\_BID)   == TICK\_FLAG\_BID);     bool last\_tick  = ((tick.flags &TICK\_FLAG\_LAST)  == TICK\_FLAG\_LAST);     bool volume\_tick= ((tick.flags &TICK\_FLAG\_VOLUME)== TICK\_FLAG\_VOLUME);      //--- check the tick for trading flags first (there are none for CustomTicksAdd())    if(buy\_tick || sell\_tick)       {        //--- form an output for a trading tick        desc += (buy\_tick ? StringFormat("Buy Tick: Last=%G Volume=%d ", tick.last, tick.volume)  : "");        desc += (sell\_tick? StringFormat("Sell Tick: Last=%G Volume=%d ",tick.last, tick.volume) : "");        desc += (ask\_tick ? StringFormat("Ask=%G ", tick.ask) : "");        desc += (bid\_tick ? StringFormat("Bid=%G ", tick.ask) : "");        desc += "(Trade tick)";       }     else       {        //--- form an output for an info tick a bit differently        desc += (ask\_tick   ? StringFormat("Ask=%G ",  tick.ask)    : "");        desc += (bid\_tick   ? StringFormat("Bid=%G ",  tick.ask)    : "");        desc += (last\_tick  ? StringFormat("Last=%G ", tick.last)   : "");        desc += (volume\_tick? StringFormat("Volume=%d ",tick.volume): "");        desc += "(Info tick)";       }  //--- return tick description     return(desc);    } |

 

See also

[CustomRatesDelete](/en/docs/customsymbols/customratesdelete), [CustomRatesUpdate](/en/docs/customsymbols/customratesupdate), [CustomTicksReplace](/en/docs/customsymbols/customticksreplace), [CopyTicks](/en/docs/series/copyticks), [CopyTicksRange](/en/docs/series/copyticksrange)

[CustomRatesUpdate](/en/docs/customsymbols/customratesupdate "CustomRatesUpdate")

[CustomTicksDelete](/en/docs/customsymbols/customticksdelete "CustomTicksDelete")