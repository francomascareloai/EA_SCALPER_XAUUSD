# TradeAlgorithms - library for MetaTrader 5

Source: https://www.mql5.com/en/code/1578

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/1578) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Libraries](https://c.mql5.com/i/code/library.png)

# TradeAlgorithms - library for MetaTrader 5

[Nikolay Kositsin](/en/users/godzilla)  |
[English](javascript:void(false);)

[Русский](/ru/code/1578) [中文](/zh/code/1578) [Español](/es/code/1578) [Deutsch](/de/code/1578) [日本語](/ja/code/1578) [Português](/pt/code/1578)

Views:
:   21912

Rating:
:   (57)

Published:
:   12 March 2013, 08:18

Updated:
:   22 November 2016, 07:32
:   [tradealgorithms\_1.zip](/en/code/download/1578/tradealgorithms_1.zip "tradealgorithms_1.zip")
    (8.02 KB)

    [tradealgorithms\_2.zip](/en/code/download/1578/tradealgorithms_2.zip "tradealgorithms_2.zip")
    (8.02 KB)

    [tradealgorithms\_3.zip](/en/code/download/1578/tradealgorithms_3.zip "tradealgorithms_3.zip")
    (8.24 KB)

    [tradealgorithms\_4.zip](/en/code/download/1578/tradealgorithms_4.zip "tradealgorithms_4.zip")
    (8.24 KB)

    [Download as ZIP](/en/code/download/1578.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Trade functions library designed for use in the code of scripts and Expert Advisors depending on a broker.

You can get acquainted with the Expert Advisors drawn on the basis of this library in the article ["Simple Trading Systems Using Semaphore Indicators"](/en/articles/358).

As a large number of the Expert Advisors using this library was placed in [Code Base](/en/code), it was decided to perform four variants of its program code to use these Expert Advisors with any broker who offers trading on financial markets using MetaTrader 5 Client Terminal:

1. For brokers who offer **nonzero spread** and ability to set Stop Loss and Take Profit **simultaneously opening** a position;
2. For brokers who offer **zero spread** and ability to set Stop Loss and Take Profit **simultaneously opening** a position;
3. For brokers who offer **nonzero spread** and Stop Loss and Take Profit setting **after opening** a position;
4. For brokers who offer **zero spread** and Stop Loss and Take Profit setting **after opening** a position;

All files placed in archives have one unique name - **TradeAlgorithms.mqh**. For the Expert Advisors in [Code Base](/en/code) which use this library, only one variant of TradeAlgorithms.mqh file is allowed to use under its name in the terminal\_data\_folder\MQL5\Include\ of one client terminal!

After moving the library file all the Expert Advisors which use it should be compiled. For this, restart MetaEditor, open the Navigator window, right click on the MQL5 label and select "Compile" in the pop-up menu.

**Functions**

The library contains the following main trading functions:

```mql5
bool BuyPositionOpen
(
    bool &BUY_Signal,          // deal permission flag
    const string symbol,       // deal's trading pair
    const datetime &TimeLevel, // time after which the following deal after the current deal will be performed
    double Money_Management,   // MM
    int Margin_Mode,           // way of lot value calculation
    uint deviation,            // slippage
    int StopLoss,              // Stop Loss in points
    int Takeprofit             // Take Profit in points
);

bool SellPositionOpen
(
    bool &SELL_Signal,         // deal permission flag
    const string symbol,       // deal's trading pair
    const datetime &TimeLevel, // time after which the following deal after the current deal will be performed 
    double Money_Management,   // MM
    int Margin_Mode,           // way of lot value calculation
    uint deviation,            // slippage
    int StopLoss,              // Stop Loss in points
    int Takeprofit             // Take Profit in points
);

bool BuyPositionOpen
(
    bool &BUY_Signal,          // deal permission flag
    const string symbol,       // deal's trading pair
    const datetime &TimeLevel, // time after which the following deal after the current deal will be performed
    double Money_Management,   // MM
    int Margin_Mode,           // way of lot value calculation
    uint deviation,            // slippage
    double dStopLoss,          // Stop Loss in price chart units
    double dTakeprofit         // Take Profit in price chart units
);

bool SellPositionOpen
(
    bool &SELL_Signal,         // deal permission flag
    const string symbol,       // deal's trading pair
    const datetime &TimeLevel, // time after which the following deal after the current deal will be performed
    double Money_Management,   // MM
    int Margin_Mode,           // way of lot value calculation
    uint deviation,            // slippage
    double dStopLoss,          // Stop Loss in price chart units
    double dTakeprofit         // Take Profit in price chart units
);

bool BuyPositionClose
(
    bool &Signal,        // deal permission flag
    const string symbol, // deal's trading pair
    uint deviation       // slippage
);

bool SellPositionClose
(
    bool &Signal,        // deal permission flag
    const string symbol, // deal's trading pair
    uint deviation       // slippage
);

bool BuyPositionModify
(
    bool &Modify_Signal, // modification permission flag
    const string symbol, // deal's trading pair
    uint deviation,      // slippage
    int StopLoss,        // Stop Loss in points
    int Takeprofit       // Take Profit in points
);

bool SellPositionModify
(
    bool &Modify_Signal, // modification permission flag
    const string symbol, // deal's trading pair
    uint deviation,      // slippage
    int StopLoss,        // Stop Loss in points
    int Takeprofit       // Take Profit in points
);
```

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/1578](/ru/code/1578)

**Last comments |
[Go to discussion](/en/forum/11076)**
(9)

![Paulo Campozana](https://c.mql5.com/avatar/2015/12/5682D025-165A.jpg "Paulo Campozana")

**[Paulo Campozana](/en/users/hegde)**
|
11 Mar 2018 at 22:45

**Otavio Konmin Clemente:**  
 Hello friends,

I'm adapting a forex EA that uses this library for use on the BMF&Bovespa. I'm not sure which variant to use. Although there is a spread on the Bovespa, it has a different meaning to the forex spread. I believe that the correct variant for BMF&Bovespa is 1. Can anyone confirm this?

Abs,

Otávio

Otávio, your statement is correct. It is option 1.

![Ilya_B](https://c.mql5.com/avatar/avatar_na2.png "Ilya_B")

**[Ilya\_B](/en/users/ilya_b)**
|
12 Sep 2019 at 20:59

In my case:

Invalid data for [trade request structure](https://www.mql5.com/en/docs/constants/structures/mqltraderequest "MQL5 Documentation: Structure of a trade request")!

OrderCheck(): Unsupported type of order execution by balance is specified

I tried all 4 options too) The values of request.type, request.price, request.action, etc. seem to be correct.

![andreevang](https://c.mql5.com/avatar/avatar_na2.png "andreevang")

**[andreevang](/en/users/andreevang)**
|
30 Oct 2019 at 23:13

**Paulo Campozana:**  

Otávio, your statement is correct. It's option 1.

Good evening, Paulo. I'm trying to use this karacatica robot, but I have a question. In which folder should I [put](https://www.mql5.com/en/articles/1171 "Why Virtual Hosting on the MetaTrader 4 and MetaTrader 5 platforms is better than the usual VPSs") the file for option 1? Can you help?

![andreevang](https://c.mql5.com/avatar/avatar_na2.png "andreevang")

**[andreevang](/en/users/andreevang)**
|
21 Feb 2020 at 01:57

Gentlemen, I'm trying to use this robot, but in the tests it doesn't enter any position although it works. What could it be?

![nfatoye22](https://c.mql5.com/avatar/avatar_na2.png "nfatoye22")

**[nfatoye22](/en/users/nfatoye22)**
|
1 Sep 2020 at 08:00

Hello,  I tried to stop the multiple entries but it failed I think its because of the recount command,  any assistant on that please.

![WeeklyPivot](https://c.mql5.com/i/code/indicator.png)
[WeeklyPivot](/en/code/1572)

The indicator of reversal points drawn on the week candlesticks

![TrendRange](https://c.mql5.com/i/code/indicator.png)
[TrendRange](/en/code/1573)

The trend indicator with three states.

![MinPriceChange](https://c.mql5.com/i/code/indicator.png)
[MinPriceChange](/en/code/1582)

The indicator of the minimum sum of price changes which forms signals after flat movements and before potential breakthrough in this or that side

![The scripts for opening long positions](https://c.mql5.com/i/code/script.png)
[The scripts for opening long positions](/en/code/1574)

These scripts are designed to buy with fixed values of Stop Loss and Take Profit in points from the current price