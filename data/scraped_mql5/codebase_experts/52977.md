# Economic Calendar CSV - script for MetaTrader 5

Source: https://www.mql5.com/en/code/52977

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/52977) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# Economic Calendar CSV - script for MetaTrader 5

[Stanislav Korotky](/en/users/marketeer)  |
[English](javascript:void(false);)

[Русский](/ru/code/52977) [中文](/zh/code/52977) [Español](/es/code/52977) [Deutsch](/de/code/52977) [日本語](/ja/code/52977) [Português](/pt/code/52977) [한국어](/ko/code/52977) [Français](/fr/code/52977) [Italiano](/it/code/52977) [Türkçe](/tr/code/52977)

Views:
:   9077

Rating:
:   (9)

Published:
:   22 October 2024, 16:31

Updated:
:   22 November 2024, 20:23
:   \MQL5\Include\MQL5Book\

    [AutoPtr.mqh](/en/code/download/52977/autoptr.mqh "AutoPtr.mqh")
    (1.86 KB)
    [view](# "view")

    [CalendarDefines.mqh](/en/code/download/52977/calendardefines.mqh "CalendarDefines.mqh")
    (4.66 KB)
    [view](# "view")

    [CalendarFilterCached.mqh](/en/code/download/52977/calendarfiltercached.mqh "CalendarFilterCached.mqh")
    (2.38 KB)
    [view](# "view")

    [Defines.mqh](/en/code/download/52977/defines.mqh "Defines.mqh")
    (0.71 KB)
    [view](# "view")

    [IS.mqh](/en/code/download/52977/is.mqh "IS.mqh")
    (0.98 KB)
    [view](# "view")

    [QuickSortStructT.mqh](/en/code/download/52977/quicksortstructt.mqh "QuickSortStructT.mqh")
    (3.97 KB)
    [view](# "view")

    [QuickSortStructTRef.mqh](/en/code/download/52977/quicksortstructtref.mqh "QuickSortStructTRef.mqh")
    (7.86 KB)
    [view](# "view")

    [StringUtils.mqh](/en/code/download/52977/stringutils.mqh "StringUtils.mqh")
    (1.91 KB)
    [view](# "view")

    [CalendarFilter.mqh](/en/code/download/52977/calendarfilter.mqh "CalendarFilter.mqh")
    (28.8 KB)
    [view](# "view")

    [TimeServerDST.mqh](/en/code/download/52977/timeserverdst.mqh "TimeServerDST.mqh")
    (15.68 KB)
    [view](# "view")

    [CalendarCache.mqh](/en/code/download/52977/calendarcache.mqh "CalendarCache.mqh")
    (28.54 KB)
    [view](# "view")

    [CalendarCSVForDates.mq5](/en/code/download/52977/calendarcsvfordates.mq5 "CalendarCSVForDates.mq5")
    (11.88 KB)
    [view](# "view")

    [Expand (12)](javascript:void(false))
    [Collapse (12)](javascript:void(false))

    [Download as ZIP](/en/code/download/52977.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

This is an extended version of the script *CalendarForDates.mq5* presented in [the algotrading book](/en/book/advanced/calendar/calendar_records_by_country_currency).

Input variables allows you to specify a country code, a currenty code, and a time range to filter required records. If the inputs are left empty, a complete calendar can be requested (if the calendar is requested first time after the terminal started, it can take a while for downloading its base or even time out and produce no results - then please run the script once again).

As a result, you'll get a CSV-file with calendar records with most important fields (not all fields are exported - feel free to adjust the source code according to your needs).

Optionally, one can input a \*.cal-file (archived copy of the calendar for specific time) created by the indicator *CalendarMonitorCached.mq5* also [introduced in the book](/en/book/advanced/calendar/calendar_cache_tester), which is now obsolete in favor of its extended version [CalendarMonitorCachedTZ.mq5](/en/code/53393/) (recommended and required for the new feature, described next).

[![MetaTrader's Economic Calendar in CSV](https://c.mql5.com/18/156/calcsv__1.png "MetaTrader's Economic Calendar in CSV")](https://c.mql5.com/18/156/calcsv.png "https://c.mql5.com/18/156/calcsv.png")

The most interesting feature: the script demonstrates the usage of [TimeServerDST.mqh](/en/code/52557/) for adjusting historical events' timestamps in accordance with the server's time zone changes in past, which are persistently reflected in candles' timestamps. This mode is enabled by settings the input **FixCachedTimesBySymbolHistory** to *true*.

Saving events into CSV-files with and without the correction makes it easy to compare effects of time correction on the history.

For proper usage of this feature, it's recommended to run the script on XAUUSD or EURUSD H1 charts. When used programmatically, these symbols should be passed to *TimeServerDST*'s functions.

The same approach is used in the indicator [CalendarMonitorCachedTZ.mq5](/en/code/53393/) for exporting time-corrected calendar events into archived cal-files, ready for loading from inside the tester, that ensures accurate backtests and optimizations of news robots.

**Range of dates in which the time corrections are performed is limited to the maximal number of bars on the chart for timeframe H1**. This is the specificity of the empirical method used inside *TimeServerDST.mqh*.

Let us consider a specific event type, preferably with a large impact on the market, such as a release of US Nonfarm Payrolls (NFP).

On a European server with DST schedule (MQ Demo) it occurs at 14:30 in winter and at 15:30 in summer. On the screenshot below you can see side by side 2 versions of complete calendar history exported to CSV-files, with specific summer date 2023.08.04 in view. Both exports were performed on 8-th of November (winter, standard time), so GMT+2 offset was applied by default for all events, including summer of 2023 (and any other seasons and years as well). Without correction (shown at the right) the exported times for summer NFPs are 14:30. This is incorrect.

[![Economic Calendar Events with corrected timestamps](https://c.mql5.com/18/157/mt5calfix__1.png "Economic Calendar Events with corrected timestamps")](https://c.mql5.com/18/157/mt5calfix.png "https://c.mql5.com/18/157/mt5calfix.png")

After empirical autodetection of the server's time zone, which was in effect during the summer, the library performs calendar export with time correction (shown at the left). As a result, the summer NFPs are moved to 15:30, as it should be. You can take a look at the chart for this period to make sure that correction is appropriate.

![Nonfarm Payrolls on EURUSD H1 chart](https://c.mql5.com/18/157/EURUSDH1NFP.png "Nonfarm Payrolls on EURUSD H1 chart")

This specific case is not so dramatic, because the non-corrected announced time 14:30 goes before 15:30, so expert advisers could probably keep waiting for the news and open trades. But when the server time zone is switched to summer, all winter events registered in the calendar contain timestamps delayed by 1 hour (!).

The stuff is still experimental. Feel free to send your feedback.

Further research on an impact of time corrections on news trading is planned. Stay tuned.

The attached mqh-files (*CalendarFilter.mqh, CalendarCache.mqh, QuickSortStructT(Ref).mqh*) contain bugfixes and improvements compared to their original versions from the book.

04.10.2024 - added writing/reading server time zone offset into cal-files and csv-files.

10.11.2024 - added an option to correct timestamps of events in the history in accordance to retrospective timezone changes of the server.

11.11.2024 - small bugfix and refinement in CalendarCache.mqh and CalendarFilter.mqh.

22.11.2024 - small bugfixes and improvements in CalendarCache.mqh.

**Last comments |
[Go to discussion](/en/forum/475156)**
(1)

![Stanislav Korotky](https://c.mql5.com/avatar/2010/10/4CA7CFA0-1F0C.jpg "Stanislav Korotky")

**[Stanislav Korotky](/en/users/marketeer)**
|
10 Nov 2024 at 20:29

New version incorporates and demonstrates an important feature (implemeted in [the TimeServerDaylightSavings lib](/en/code/52557)) of time correction for historical events to align them with corresponding bars in past, which could be (and in most cases did) formed under different time zones, if the broker switches daylight saving mode on/off or even changed server time zone completely. With adjusted times news events can be accurately used during backtests on the history.

![Push Notification for Opened / Closed Trades (Netting)](https://c.mql5.com/i/code/library.png)
[Push Notification for Opened / Closed Trades (Netting)](/en/code/52899)

This code provides a simple function for sending push notifications to your mobile device whenever trades are opened or closed in MetaTrader 5. It's designed for netting accounts (where only one position per symbol is allowed).

![Script to extract Candlesticks data from all time frames to CSV.](https://c.mql5.com/i/code/script.png)
[Script to extract Candlesticks data from all time frames to CSV.](/en/code/52766)

This MQL5 script exports candlestick data for various timeframes into a CSV file, capturing essential market information like open, high, low, and close prices. It analyzes each candlestick's characteristics, including body and wick sizes, while calculating additional metrics such as candle gaps. After processing the latest 21 bars, it notifies the user upon successful data export.

![Swap Monitor](https://c.mql5.com/i/code/services.png)
[Swap Monitor](/en/code/53007)

This service periodically checks swaps for predefined symbols and saves detected changes into CSV-files for further analysis and potential replay (not implemented here). Also it monitors and alerts swap changes of existing positions.

![AutoFibo indicator of two last swings based on ZigZag](https://c.mql5.com/i/code/indicator.png)
[AutoFibo indicator of two last swings based on ZigZag](/en/code/53041)

The AutoFibo indicator is an advanced Fibonacci retracement tool that automatically draws Fibonacci levels based on the ZigZag pattern. This indicator is designed to help traders quickly identify potential support and resistance levels in trending markets.