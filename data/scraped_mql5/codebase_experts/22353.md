# MA Envelopes - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/22353

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/22353) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# MA Envelopes - expert for MetaTrader 5

Scriptor  |
[English](javascript:void(false);)

[Русский](/ru/code/22353) [中文](/zh/code/22353) [Español](/es/code/22353) [Deutsch](/de/code/22353) [日本語](/ja/code/22353) [Português](/pt/code/22353)

Published by:
:   [Vladimir Karputov](/en/users/barabashkakvn)

Views:
:   6101

Rating:
:   (16)

Published:
:   25 October 2018, 18:17
:   [MA Envelopes.mq5](/en/code/download/22353/ma_envelopes.mq5 "MA Envelopes.mq5")
    (44.33 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/22353.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

**The author of the idea** - [Scriptor](/en/users/scriptor "Scriptor (Scriptor)")

**mq5 code author** - [barabashkakvn](/en/users/barabashkakvn)

**NOTE: The EA works on hedge accounts only! Netting is prohibited!**

The Expert Advisor sets pending Buy limit and Stop limit orders. The robot uses data of the iMA (Moving Average, MA) and iEnvelopes (Envelopes) indicators. The EA works only when a new bar appears and has a limitation of the working time range: from **Start hour** to **End hour.**

It is able to set up to three pending limit orders in each direction forming a grid: a separate magic number is assigned to each order. Magic number assignment rule: 

* for BUY #1: **magic number** + 1
* for BUY #2: **magic number** + 2
* for BUY #3: **magic number** +3
* for SELL#1: **magic number** - 1
* for SELL#2: **magic number** - 2
* for SELL#3: **magic number** - 3

If there are non-activated pending orders, and the server time exceeds **End hour**, all pending orders are removed.

The default parameters, EURUSD M5:

![](https://c.mql5.com/18/74/2018-09-17_12h06_22.png)

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/22353](/ru/code/22353)

**Last comments |
[Go to discussion](/en/forum/285665)**
(3)

![Evgenij Litvintsev](https://c.mql5.com/avatar/2017/5/5926DD11-1A12.jpg "Evgenij Litvintsev")

**[Evgenij Litvintsev](/en/users/alex0779)**
|
26 Nov 2021 at 12:10

good day, the description is unclear or not fully formed

![Vladimir Karputov](https://c.mql5.com/avatar/2024/2/65d8b5a2-f9d9.jpg "Vladimir Karputov")

**[Vladimir Karputov](/en/users/barabashkakvn)**
|
26 Nov 2021 at 12:16

**Evgenij Litvintsev [#](/ru/forum/279743#comment_26117998):**  
 good afternoon, the description is unclear or not fully formed

Is this your first time uploading a robot? What exactly is not clear?

![Vladimir Gulakov](https://c.mql5.com/avatar/2025/3/67c4a5ad-1b40.png "Vladimir Gulakov")

**[Vladimir Gulakov](/en/users/fobuysel)**
|
5 Jan 2022 at 20:41

As always a great trading idea in itself. But this indicator deviation is in per cent..., and it should be in pips. I'm aware of the rest.

![Market_Direction_Indicator](https://c.mql5.com/i/code/indicator.png)
[Market\_Direction\_Indicator](/en/code/22359)

Market Direction Indicator

![Murreys_Math_Oscillator](https://c.mql5.com/i/code/indicator.png)
[Murreys\_Math\_Oscillator](/en/code/22361)

Murreys Math Oscillator

![Internal_Strength](https://c.mql5.com/i/code/indicator.png)
[Internal\_Strength](/en/code/22351)

Internal Strength indicator

![Extreme_TMA_line_indicator](https://c.mql5.com/i/code/indicator.png)
[Extreme\_TMA\_line\_indicator](/en/code/22350)

Extreme TMA Line indicator