# Exp_IBS_RSI_CCI_v4_X2 - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/17692

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/17692) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Exp\_IBS\_RSI\_CCI\_v4\_X2 - expert for MetaTrader 5

[Nikolay Kositsin](/en/users/godzilla)  |
[English](javascript:void(false);)

[Русский](/ru/code/17692) [中文](/zh/code/17692) [Español](/es/code/17692) [Deutsch](/de/code/17692) [日本語](/ja/code/17692) [Português](/pt/code/17692)

Views:
:   6530

Rating:
:   (21)

Published:
:   22 March 2017, 16:18
:   \MQL5\Include\

    [TradeAlgorithms.mqh](/en/code/download/17692/tradealgorithms.mqh "TradeAlgorithms.mqh")
    (178.46 KB)
    [view](# "view")

    \MQL5\Indicators\

    [IBS\_RSI\_CCI\_v4.mq5](/en/code/download/17692/ibs_rsi_cci_v4.mq5 "IBS_RSI_CCI_v4.mq5")
    (18.33 KB)
    [view](# "view")

    [IBS\_RSI\_CCI\_v4\_HTF.mq5](/en/code/download/17692/ibs_rsi_cci_v4_htf.mq5 "IBS_RSI_CCI_v4_HTF.mq5")
    (21.75 KB)
    [view](# "view")

    \MQL5\Experts\

    [Exp\_IBS\_RSI\_CCI\_v4\_X2.mq5](/en/code/download/17692/exp_ibs_rsi_cci_v4_x2.mq5 "Exp_IBS_RSI_CCI_v4_X2.mq5")
    (21.86 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/17692.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The Exp\_IBS\_RSI\_CCI\_v4\_X2 trend-following trading system is based on the signals of two [IBS\_RSI\_CCI\_v4](/en/code/17471 "IBS_RSI_CCI_v4 - indicator for MetaTrader 5") indicators. The first indicator determines the direction of the slow trend based on the position of the main and signal lines. The second indicator determines the moment for opening a trade, when the lines are crossed or touched. The signal is formed when a bar is closing if two conditions are met:

1. Signals of the fast and slow trend match;
2. Direction of the fast trend has changed.

### Input parameters of the Expert Advisor

```mql5
//+-------------------------------------------------+
//| Input parameters of the EA indicator            |
//+-------------------------------------------------+
input string Trade="Trade management";    //+================ TRADE MANAGEMENT ================+  
input double MM=0.1;               //Share of a deposit in a deal
input MarginMode MMMode=LOT;      //Lot value detection method
input uint    StopLoss_=1000;      //Stop Loss in points
input uint    TakeProfit_=2000;    //Take Profit in points
input string MustTrade="Trade permissions";    //+=============== TRADE PERMISSIONS ===============+  
input int    Deviation_=10;       //Max price deviation in points
input bool   BuyPosOpen=true;     //Permission to enter long positions
input bool   SellPosOpen=true;    //Permission to enter short positions
//+-------------------------------------------------+
//| Input parameters of the filter indicator        |
//+-------------------------------------------------+
input string Filter="SLOW TREND PARAMETERS";    //+============== TREND PARAMETERS ==============+  
input ENUM_TIMEFRAMES TimeFrame=PERIOD_H8;  //1 Chart period for the trend
//---- Middle line parameters
input uint      IBSPeriod=5;
input  ENUM_MA_METHOD   MAType=MODE_SMA;
//---- RSI parameters
input uint   RSIPeriod=14;
input ENUM_APPLIED_PRICE   RSIPrice=PRICE_CLOSE;
//---- CCI parameters
input uint   CCIPeriod=14;
input ENUM_APPLIED_PRICE   CCIPrice=PRICE_MEDIAN;

input int      porog=50; //Threshold
//---- VKWB line filter parameter 
input  ENUM_MA_METHOD   MAType_VKWB=MODE_SMA;     
input int      RangePeriod_VKWB  = 25;
input int      SmoothPeriod_VKWB =  3;
//----
input uint SignalBar=1; //Bar index to get receive signal
input bool   BuyPosClose=true;     //Permission to exit long positions by trend
input bool   SellPosClose=true;    //Permission to exit short positions by trend
//+-------------------------------------------------+
//| Input parameters of the entry indicator         |
//+-------------------------------------------------+
input string Input="ENTRY PARAMETERS";       //+=============== ENTRY PARAMETERS ==============+  
input ENUM_TIMEFRAMES TimeFrame_=PERIOD_H1;  //2 Chart period for the entry 
//---- Middle line parameters
input uint      IBSPeriod_=5;
input  ENUM_MA_METHOD   MAType_=MODE_SMA;
//---- RSI parameters
input uint   RSIPeriod_=14;
input ENUM_APPLIED_PRICE   RSIPrice_=PRICE_CLOSE;
//---- CCI parameters
input uint   CCIPeriod_=14;
input ENUM_APPLIED_PRICE   CCIPrice_=PRICE_MEDIAN;

input int      porog_=50; //порог
//---- VKWB line filter parameter 
input  ENUM_MA_METHOD   MAType_VKWB_=MODE_SMA;     
input int      RangePeriod_VKWB_  = 25;
input int      SmoothPeriod_VKWB_ =  3;
//----
input uint SignalBar_=1;//Bar index to receive an entry signal
input bool   BuyPosClose_=false;     //Permission to exit long positions by signal
input bool   SellPosClose_=false;    //Permission to exit short positions by signal
//+-------------------------------------------------+
```

String variables containing text in the inputs code are included only for better visual display of the EA inputs window.

The IBS\_RSI\_CCI\_v4\_HTF indicators in the EA are only intended for a more convenient visualization of trends in the strategy tester, in other operation modes they are inactive.

In order to provide proper operation of the compiled Expert Advisor, you should add the compiled IBS\_RSI\_CCI\_v4.ex5 and IBS\_RSI\_CCI\_v4\_HTF.ex5 indicator files to <terminal\_data \_folder>\MQL5\Indicators.

Note that the TradeAlgorithms.mqh library file allows using Expert Advisors with brokers who offer **nonzero spread** and the option of setting Stop Loss and Take Profit **together with position opening**. You can download more variants of the library at the following link: [Trade Algorithms](/en/code/1578 "TradeAlgorithms - Library for MetaTrader 5").

Default Expert Advisor's input parameters have been used during the tests shown below. Stop Loss and Take Profit have not been used during the tests.

![Fig. 1. Examples of deals on the chart](https://c.mql5.com/18/57/xTesterGraph.png "Fig. 1. Examples of deals on the chart")

Fig. 1. Examples of deals on the chart

Testing results for 2015 on USDCHF, slow trend on H8, entry by fast trend on H1:

![Fig. 2. Chart of testing results](https://c.mql5.com/18/57/8TesterGraphReport.png "Fig. 2. Chart of testing results")

Fig. 2. Chart of testing results

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/17692](/ru/code/17692)

**Last comments |
[Go to discussion](/en/forum/187815)**
(1)

![Random Pattern](https://c.mql5.com/avatar/avatar_na2.png "Random Pattern")

**[Random Pattern](/en/users/random_pattern)**
|
8 Mar 2017 at 16:48

Not sure how to contact you directly but maybe this will work. I'm looking for a simple HTF session background candle for MT5 like the shadeNY\_candle but the shadeNY\_candle does not plot correctly in realtime for the current candle. It Only plots long and shows the high / close bottom. Thanks

![ColorSTD_Histogram_HTF](https://c.mql5.com/i/code/indicator.png)
[ColorSTD\_Histogram\_HTF](/en/code/17687)

The ColorSTD\_Histogram indicator with the timeframe selection option available in the input parameters.

![JuiceZ](https://c.mql5.com/i/code/indicator.png)
[JuiceZ](/en/code/17686)

An indicator of financial asset volatility using the OSMA oscillator.

![KI_signals](https://c.mql5.com/i/code/indicator.png)
[KI\_signals](/en/code/17694)

The indicator receives trade signals from the MACD histogram.

![ColorXDeMarker_Histogram_HTF](https://c.mql5.com/i/code/indicator.png)
[ColorXDeMarker\_Histogram\_HTF](/en/code/17695)

The ColorXDeMarker\_Histogram indicator with the timeframe selection option available in the input parameters.