# N trades per set Martingale - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/27085

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/27085) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# N trades per set Martingale - expert for MetaTrader 4

[Brian Rumbles](/en/users/ea_research_development)

Views:
:   14269

Rating:
:   (14)

Published:
:   9 November 2019, 12:11

Updated:
:   9 November 2019, 13:33
:   [N trades per set martingale.mq4](/en/code/download/27085/n_trades_per_set_martingale.mq4 "N trades per set martingale.mq4")
    (345.81 KB)
    [view](# "view")

    [N trades per set martingale + Close and reset on equity increase.mq4](/en/code/download/27085/n_trades_per_set_martingale_7_close_and_reset_on_equity_increase.mq4 "N trades per set martingale + Close and reset on equity increase.mq4")
    (358.72 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/27085.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The EA does a set of N number of trades and then:

This EA will scale up if all the trades were consec losses and will reset after

a set with all consec wins has occurred.

The set size is set by the parameter (N\_trades\_per\_set)

If any other lower number of consec wins or losses occur per a set, the EA will not change the lot size, but will just start the new set with the
same lot size as the previous set.

The idea is to increase the N\_trades\_per\_set number higher to make the EA safer.

Try to test on strategy tester with N number of say 3 and then increase this number if the EA fails.

Some things it will depend on is the currency pair and the TP to SL ratio.

A TP and SL of 50 pips (4 digit pips) will be a good starting point. 100 may work well too.

The scale factor is the martingale scaling eg. 2x

The equity/100 000 is the initial lot size eg. $1000 /100 000= 0.01 and $3000/ 100 000= 0.03 etc.

[![USDJPY backtest no close on equity](https://c.mql5.com/18/86/USDJPY_backtest_no_close_on_equity__1.PNG "USDJPY backtest no close on equity")](https://c.mql5.com/18/86/USDJPY_backtest_no_close_on_equity.PNG "https://c.mql5.com/18/86/USDJPY_backtest_no_close_on_equity.PNG")

USDJPY
backtest no close on equity control points

[![backtest settings](https://c.mql5.com/18/86/backtest_settings__1.PNG "backtest settings")](https://c.mql5.com/18/86/backtest_settings.PNG "https://c.mql5.com/18/86/backtest_settings.PNG")

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Second EA file: N trades per set martingale + close and reset on equity increase:

has that extra parameter added. This EA seems more consistent and stable than the version with no close.

Default setting is equity +10 (if equity is $10 more than previous highest equity, close trades and reset)

[![USDJPY Backtest](https://c.mql5.com/18/86/USDJPY_backtest__1.PNG "USDJPY Backtest")](https://c.mql5.com/18/86/USDJPY_backtest.PNG "https://c.mql5.com/18/86/USDJPY_backtest.PNG")

Back test on USDJPY standard settingsÂ N
trades per set martingale + close and reset on equity increase 2016 to 2019

start eq $2000

**Last comments |
[Go to discussion](/en/forum/326080)**
(3)

![Osiris](https://c.mql5.com/avatar/2024/7/669ce3b5-8b4d.jpg "Osiris")

**[Osiris](/en/users/kebaya)**
|
27 Nov 2019 at 20:40

very interesting .... seems you used FXDreema for this...

Can you upload a clean MQL code for us to understand the logic

Thank you

![Barry Hendriks](https://c.mql5.com/avatar/2018/11/5BFED188-6A0C.jpg "Barry Hendriks")

**[Barry Hendriks](/en/users/forex-id10t)**
|
19 Mar 2020 at 07:53

It seems that this EA only place BUY trades when doing a [backtest](https://www.mql5.com/en/articles/2612 "Article \"Testing trading strategies on real ticks\"")?

If this is true, then this EA only performs at 50% of potential :)

Maybe you could fix this?

![Pertinacious](https://c.mql5.com/avatar/avatar_na2.png "Pertinacious")

**[Pertinacious](/en/users/pertinacious)**
|
9 Nov 2020 at 16:26

I like the code, but I could not get it to make anything but buy trades, whether the pair was going up or down. I am another that would like to see this [code fixed](/go?link=https://forge.mql5.io/help/en/guide "MQL5 Algo Forge: Cloud Workspace for Algorithmic Trading Development") and perform with some profit! :)

![Smart AC Trader](https://c.mql5.com/i/code/expert.png)
[Smart AC Trader](/en/code/27033)

The "Smart AC Trader" EA trades with 2 moving averages , If we lose a trade then the EA will take a new trade with the opposite conditions

![Martingale Smart](https://c.mql5.com/i/code/expert.png)
[Martingale Smart](/en/code/26948)

The "Martingale Smart" EA trades with 2 strategies , If we lose a trade then the EA will change strategy and take a new trade with a multiplied/increased lot size,

![Gonna Scalp](https://c.mql5.com/i/code/expert.png)
[Gonna Scalp](/en/code/27088)

The "Gonna Scalp" EA is a scalper , works with all time frames major forex pairs and stocks NASDAQ.

![Updated Meta Neural Dashboard](https://c.mql5.com/i/code/indicator.png)
[Updated Meta Neural Dashboard](/en/code/27223)

An old forum indicator that's been updated