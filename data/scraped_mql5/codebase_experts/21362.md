# Virtual Trailing Stop - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/21362

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/21362) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Virtual Trailing Stop - expert for MetaTrader 5

cmillion  |
[English](javascript:void(false);)

[Русский](/ru/code/21362) [中文](/zh/code/21362) [Español](/es/code/21362) [Deutsch](/de/code/21362) [日本語](/ja/code/21362) [Português](/pt/code/21362)

Published by:
:   [Vladimir Karputov](/en/users/barabashkakvn)

Views:
:   20979

Rating:
:   (49)

Published:
:   13 July 2018, 16:10
:   [Virtual Trailing Stop.mq5](/en/code/download/21362/virtual_trailing_stop.mq5 "Virtual Trailing Stop.mq5")
    (26.43 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/21362.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

**Idea by**: [Vladimir Khlystov](/en/users/cmillion "Vladimir Khlystov (cmillion)").

**MQL5 code by**: [barabashkakvn](/en/users/barabashkakvn).

Virtual trailing can place stop loss and take profit, and trail the position in such a manner that stop orders are not visible to broker, i.e., they are not place with your dealing center, but on your PC; so nobody, except of your PC and yourself, can see your plans.

Along with the invisibility, there is another very useful thing: Many brokers have very large spreads and the levels of placing stop orders, so now these levels cannot harm you, the EA just ignores them.

As far as I can judge, everything is clear regarding stop loss and take profit. I'm going to describe trailing only.

Trailing is managed with three variables:

1. trailing length;
2. minimum profit for starting;
3. trailing step.

Virtual stop loss follows the price at the distance equalling to the trailing length. Minimum profit is when to start placing the virtual stop loss. Trailing step is upon which interval we will move the virtual stop loss.

Assume, we have set the values to 5, 2, and 3, respectively.

As soon as the position profit reaches 7 points, the virtual stop loss will move by the position open price [;us 2 points of the minimum profit. Further, when the price goes 3 points in the profitable direction, the Stop Loss will be moved by 5 points to profit, and so on, following the price at a distance of 3 points. If the price rolls back to the stop level, the position will be closed.

Trailing stops are shown as dashed lines.

To understand the EA easier and faster, you can install it in the tester and see how it works there in the visualization mode:

![](https://c.mql5.com/18/70/Virtual_Trailing_Stop.gif)

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/21362](/ru/code/21362)

**Last comments |
[Go to discussion](/en/forum/265407)**
(65)

![Igor Freire](https://c.mql5.com/avatar/2020/6/5EF6D623-4C12.jpg "Igor Freire")

**[Igor Freire](/en/users/igorfreire)**
|
20 Apr 2023 at 19:59

I don't understand the function of: 1-Trailing Size, could you please explain?

![MAS-Trading](https://c.mql5.com/avatar/2025/8/688c528e-cb90.jpg "MAS-Trading")

**[MAS-Trading](/en/users/mas-trading)**
|
6 Oct 2023 at 05:40

Hi  [Vladimir](/en/users/barabashkakvn)  
  
So? Is this placed in the Script folder??   
Or? Is this placed in the Experts Folder??

![Fernando Carreiro](https://c.mql5.com/avatar/2025/9/68d40cf8-38fb.png "Fernando Carreiro")

**[Fernando Carreiro](/en/users/fmic)**
|
6 Oct 2023 at 06:03

**[@MAS-Trading](/en/users/mas-trading) [#](/en/forum/265407/page6#comment_49782177):** So? Is this placed in the Script folder??  Or? Is this placed in the Experts Folder??

It's in the "Experts" folder. It states that in the publication title ... "*Virtual Trailing Stop - **expert** for MetaTrader 5*".

![kosem66](https://c.mql5.com/avatar/avatar_na2.png "kosem66")

**[kosem66](/en/users/kosem66)**
|
1 Dec 2023 at 17:22

It gives error when I compile it in the metaeditor??

![anuj71](https://c.mql5.com/avatar/avatar_na2.png "anuj71")

**[anuj71](/en/users/anuj71)**
|
6 Apr 2025 at 06:22

This only work, when there is only one open order. what if there is multiple buy or multiple sell trade? Will it still work?

![Exp_SilverTrend_ColorJFatl_Digit_MMRec](https://c.mql5.com/i/code/expert.png)
[Exp\_SilverTrend\_ColorJFatl\_Digit\_MMRec](/en/code/21361)

Two independent trading systems using indicators SilverTrend\_V2 and ColorJFatl\_Digit within one EA, with an option of changing the size of the future trade depending on the results of the previous ones for this trading system.

![Exp_BykovTrend_ColorX2MA_MMRec](https://c.mql5.com/i/code/expert.png)
[Exp\_BykovTrend\_ColorX2MA\_MMRec](/en/code/21359)

Two independent trading systems using indicators BykovTrend\_V2 and ColorX2MA within one EA, with an option of changing the size of the future trade depending on the results of the previous ones.

![Exp_BrainTrend2_AbsolutelyNoLagLwma_MMRec](https://c.mql5.com/i/code/expert.png)
[Exp\_BrainTrend2\_AbsolutelyNoLagLwma\_MMRec](/en/code/21363)

Two independent trading systems using indicators BrainTrend2 and AbsolutelyNoLagLWMA within one EA, with an option of changing the size of the future trade depending on the results of the previous ones for this trading system

![DEMA_Range_Channel](https://c.mql5.com/i/code/indicator.png)
[DEMA\_Range\_Channel](/en/code/21364)

A channel formed by two Double Exponential Moving Averages based on averaged High and Low timeseries