# EMA - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/17741

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/17741) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# EMA - expert for MetaTrader 5

Scriptor  |
[English](javascript:void(false);)

[Русский](/ru/code/17741) [中文](/zh/code/17741) [Español](/es/code/17741) [Deutsch](/de/code/17741) [日本語](/ja/code/17741) [Português](/pt/code/17741)

Published by:
:   [Vladimir Karputov](/en/users/barabashkakvn)

Views:
:   8716

Rating:
:   (27)

Published:
:   22 March 2017, 16:22

Updated:
:   26 June 2018, 12:46
:   [EMA.mq5](/en/code/download/17741/ema.mq5 "EMA.mq5")
    (22.16 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/17741.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

**Author of the idea** — [John Smith](/en/users/scriptor "John Smith (Scriptor)"), **author of the MQL5 code** — [barabashkakvn](/en/users/barabashkakvn).

The Expert Advisor is based on the intersection of two Moving Averages. Take Profit and Stop Loss levels are virtual. The parameters of the indicators are hard coded and cannot be adjusted.

Timeframe M5, optimization based on "Balance + max Sharpe Ratio", testing period from 2017.01.01 to 2017.02.27. The testing result of all pairs with the default settings:

![Timeframe M5](https://c.mql5.com/18/57/2017-02-27_09h23_24.png "Timeframe M5")

Testing of all pairs with the default parameters, now on the M15 timeframe:

![Timeframe M15](https://c.mql5.com/18/57/2017-02-27_09h30_06.png "Timeframe M15")

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/17741](/ru/code/17741)

**Last comments |
[Go to discussion](/en/forum/187826)**
(13)

![Vladimir Karputov](https://c.mql5.com/avatar/2024/2/65d8b5a2-f9d9.jpg "Vladimir Karputov")

**[Vladimir Karputov](/en/users/barabashkakvn)**
|
6 Jun 2021 at 12:00

**Cristian Ţari :**  

Hi Vladimir,

The test has been performed on every tick or [open prices only](/en/articles/239 "Article: The Fundamentals of Testing in MetaTrader 5") ?

Thank you,

Cristian

Tests are carried out either in the "Every tick based on real ticks" mode or in the "Every tick" mode.

![Cristian Ţari](https://c.mql5.com/avatar/2021/3/6056A09C-9A90.jpg "Cristian Ţari")

**[Cristian Ţari](/en/users/cristiant)**
|
8 Jun 2021 at 15:50

**Vladimir Karputov:**  

Tests are carried out either in the "Every tick based on real ticks" mode or in the "Every tick" mode.

Hi Vladimir,

Thank you for your quick response.

I've been forward testing on a [demo account](/en/docs/constants/environment_state/accountinformation#enum_account_trade_mode "MQL5 documentation: Account Properties") this EA for two days and I've noticed today that the EA opened two positions simultanousely on EURUSD.

Is this an error or is how it should be?

Thank you,

Cristian

![Vladimir Karputov](https://c.mql5.com/avatar/2024/2/65d8b5a2-f9d9.jpg "Vladimir Karputov")

**[Vladimir Karputov](/en/users/barabashkakvn)**
|
8 Jun 2021 at 15:53

**Cristian Ţari :**  

Hi Vladimir,

Thank you for your quick response.

I've been forward testing on a [demo account](/en/docs/constants/environment_state/accountinformation#enum_account_trade_mode "MQL5 documentation: Account Properties") this EA for two days and I've noticed today that the EA opened two positions simultanousely on EURUSD.

Is this an error or is how it should be?

Thank you,

Cristian

The code was written in 2018 - a lot has changed since then (at the moment I switched to a modern trading engine).

![Cristian Ţari](https://c.mql5.com/avatar/2021/3/6056A09C-9A90.jpg "Cristian Ţari")

**[Cristian Ţari](/en/users/cristiant)**
|
11 Jun 2021 at 12:01

**Vladimir Karputov:**  

The code was written in 2018 - a lot has changed since then (at the moment I switched to a modern trading engine).

Hi Vladimir,

How much do you want to rewrite the code to a modern engine in order to prevent this error of opening up two trades instead of only one?

Also, would be nice to have a risk percentage option along with constant lot.

I like the idea of having hidden stop loss and take profit orders and so far its working nicely on the [demo account](https://www.mql5.com/en/docs/constants/environment_state/accountinformation#enum_account_trade_mode "MQL5 documentation: Account Properties").

Thank you,

Cristian

![Vladimir Karputov](https://c.mql5.com/avatar/2024/2/65d8b5a2-f9d9.jpg "Vladimir Karputov")

**[Vladimir Karputov](/en/users/barabashkakvn)**
|
11 Jun 2021 at 12:54

**Cristian Ţari:**  

Hi Vladimir,

How much do you want to rewrite the code to a modern engine in order to prevent this error of opening up two trades instead of only one?

Also, would be nice to have a risk percentage option along with constant lot.

I like the idea of having hidden stop loss and take profit orders and so far its working nicely on the [demo account](https://www.mql5.com/en/docs/constants/environment_state/accountinformation#enum_account_trade_mode "MQL5 documentation: Account Properties").

Thank you,

Cristian

There are other codes in CodeBase on a modern engine, please search.

![Exp_ICHI_OSC](https://c.mql5.com/i/code/expert.png)
[Exp\_ICHI\_OSC](/en/code/17713)

Trading system based on the signals of the ICHI\_OSC indicator

![SSL](https://c.mql5.com/i/code/indicator.png)
[SSL](/en/code/17711)

A simple trend indicator of the NRTR type that uses the breakout of a channel drawn based on the Moving Averages of the High and Low price series.

![SuperSR6_HTF](https://c.mql5.com/i/code/indicator.png)
[SuperSR6\_HTF](/en/code/17742)

The SuperSR6 indicator with the timeframe selection option available in input parameters.

![StrangeIndicator](https://c.mql5.com/i/code/indicator.png)
[StrangeIndicator](/en/code/17743)

The smoothed StrangeIndicator oscillator with the color indication of overbought/oversold level breakouts and of the histogram direction.