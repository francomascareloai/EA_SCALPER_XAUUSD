# Exp_AbsolutelyNoLagLwma_X2 - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/20976

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/20976) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Exp\_AbsolutelyNoLagLwma\_X2 - expert for MetaTrader 5

[Nikolay Kositsin](/en/users/godzilla)  |
[English](javascript:void(false);)

[Русский](/ru/code/20976) [中文](/zh/code/20976) [Español](/es/code/20976) [Deutsch](/de/code/20976) [日本語](/ja/code/20976) [Português](/pt/code/20976)

Views:
:   3525

Rating:
:   (14)

Published:
:   9 July 2018, 10:31
:   \MQL5\Include\

    [TradeAlgorithms.mqh](/en/code/download/20976/tradealgorithms.mqh "TradeAlgorithms.mqh")
    (223.62 KB)
    [view](# "view")

    \MQL5\Indicators\

    [AbsolutelyNoLagLwma.mq5](/en/code/download/20976/absolutelynolaglwma.mq5 "AbsolutelyNoLagLwma.mq5")
    (19.73 KB)
    [view](# "view")

    [AbsolutelyNoLagLwma\_HTF.mq5](/en/code/download/20976/absolutelynolaglwma_htf.mq5 "AbsolutelyNoLagLwma_HTF.mq5")
    (17.12 KB)
    [view](# "view")

    [Exp\_AbsolutelyNoLagLwma\_X2.mq5](/en/code/download/20976/exp_absolutelynolaglwma_x2.mq5 "Exp_AbsolutelyNoLagLwma_X2.mq5")
    (20.24 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/20976.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Trend-following trading system Exp\_AbsolutelyNoLagLwma\_X2 is based on the signals of two indicators [AbsolutelyNoLagLwma](/en/code/20775 "AbsolutelyNoLagLWMA - an indicator for MetaTrader 5"). The first indicator determines the direction of the slow trend based on the line color. The second indicator determines the moment for opening a trade, when the line color changes. The signal is formed when a bar is closing if two conditions are met:

1. Signals of the fast and slow trend match;
2. Direction of the fast trend has changed.

### Input parameters of the Expert Advisor

```mql5
//+-------------------------------------------------+
//| Input parameters of the EA indicator            |
//+-------------------------------------------------+
sinput string Trade="Trade Management";    //+============== TRADE MANAGEMENT ==============+  
input double MM=0.1;               //Share of a deposit in a deal
input MarginMode MMMode=LOT;       //lot size detection method
input uint    StopLoss_=1000;      //Stop Loss in points
input uint    TakeProfit_=2000;    //Take Profit in points
sinput string MustTrade="Trade Permissions";    //+============== TRADE PERMISSIONS ==============+  
input int    Deviation_=10;       //Max price deviation in points
input bool   BuyPosOpen=true;     //Permission to enter long positions
input bool   SellPosOpen=true;    //Permission to enter short positions
//+-------------------------------------------------+
//| Input parameters of the filter indicator        |
//+-------------------------------------------------+
sinput string Filter="SLOW TRADE PARAMETERS";    //+============== TRADE PARAMETERS ==============+  
input ENUM_TIMEFRAMES TimeFrame=PERIOD_H6;  //1 Chart period for the trend
input uint Length=7;                        // smoothing depth                   
input Applied_price_ IPC=PRICE_CLOSE_;      // price constant 
input uint SignalBar=1;                     // bar number for getting the entry signal
input bool   BuyPosClose=true;              // Permission to close long positions by trend
input bool   SellPosClose=true;             // Permission to close short positions by trend
//+-------------------------------------------------+
//| Input parameters of the entry indicator         |
//+-------------------------------------------------+
sinput string Input="ENTRY PARAMETERS";       //+=============== ENTRY PARAMETERS ===============+  
input ENUM_TIMEFRAMES TimeFrame_=PERIOD_M30;  //2 Chart period for entry
input uint Length_=7;                         // smoothing depth                   
input Applied_price_ IPC_=PRICE_CLOSE_;       // price constant 
input uint SignalBar_=1;                      // bar number to get an entry signal
input bool   BuyPosClose_=false;              // Permission to close long positions by signal
input bool   SellPosClose_=false;             // Permission to close short positions by signal
//+-------------------------------------------------+
```

String parameters with text in the code of input parameters are only for better visualization of the input parametera window of the expert.

Indicators [AbsolutelyNoLagLwma\_HTF](/en/code/20777 "AbsolutelyNoLagLwma_HTF - an indicator for MetaTrader 5") in the EA are only designed for a more convenient visualization of trends in the Strategy Tester; and they do not work in any other modes.

For the generated EA to operate correctly, the compiled files of indicators **AbsolutelyNoLagLwma.ex5** and **AbsolutelyNoLagLwma\_HTF.ex5** must be in the **<terminal\_data\_directory>\MQL5\Indicators** folder.

Note that the TradeAlgorithms.mqh library file allows using Expert Advisors with brokers who offer **nonzero spread** and the option of setting Stop Loss and Take Profit **together with position opening**. You can download more variants of the library at the following link: [Trade Algorithms](/en/code/1578 "TradeAlgorithms - Library for MetaTrader 5").

Default Expert Advisor's input parameters have been used during the tests shown below. Stop Loss and Take Profit have not been used during the tests.

Testing results for USDJPY over the year 2016, slow trend on H6, and entry by fast trend on M30:

![Fig 1. Examples of deals on the chart](https://c.mql5.com/18/68/nTesterGraph.png "Fig 1. Examples of deals on the chart")

Fig 1. Examples of deals on the chart

![Fig. 2. Testing results chart](https://c.mql5.com/18/68/qTesterGraphReport.png "Fig. 2. Testing results chart")

Fig. 2. Testing results chart

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/20976](/ru/code/20976)

**Last comments |
[Go to discussion](/en/forum/263775)**
(1)

![N.Soares](https://c.mql5.com/avatar/avatar_na2.png "N.Soares")

**[N.Soares](/en/users/nilvs)**
|
1 Mar 2019 at 04:27

'SellPositionClose' - [function](https://www.mql5.com/en/docs/constants/namedconstants/compilemacros "MQL5 documentation: Predefined macro replacements") not defined  Exp\_AbsolutelyNoLagLwma\_X2.mq5  219  4

'MMMode' - undeclared identifier  Exp\_AbsolutelyNoLagLwma\_X2.mq5  222  54

'BuyPositionOpen' - function not defined  Exp\_AbsolutelyNoLagLwma\_X2.mq5  222  4

'SellPositionOpen' - function not defined  Exp\_AbsolutelyNoLagLwma\_X2.mq5  225  4

'GlobalVariableDel\_' - function not defined  Exp\_AbsolutelyNoLagLwma\_X2.mq5  138  4

13 error(s), 0 warning(s)  14  1

![UltraAbsolutelyNoLagLwma](https://c.mql5.com/i/code/indicator.png)
[UltraAbsolutelyNoLagLwma](/en/code/20975)

This indicator is based on indicator AbsolutelyNoLagLwma and on the analysis of its multiple signal lines

![PCI](https://c.mql5.com/i/code/indicator.png)
[PCI](/en/code/20974)

Indicator Phase Change Index - the market phase change index

![ColorJFatl_x2_cloud_HTF](https://c.mql5.com/i/code/indicator.png)
[ColorJFatl\_x2\_cloud\_HTF](/en/code/20977)

Two indicators ColorJFatl from different timeframes, the area between lines being filled with a cloud, the color of which corresponds with the trend direction on the market

![EF](https://c.mql5.com/i/code/indicator.png)
[EF](/en/code/20978)

Indicator Ehlers Filter