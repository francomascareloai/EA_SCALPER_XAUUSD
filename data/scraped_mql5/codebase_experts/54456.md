# Perfect Trailing StopLoss - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/54456

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/54456) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Perfect Trailing StopLoss - expert for MetaTrader 5

[Lamont Simone Reynecke](/en/users/trickster247)  |
[English](javascript:void(false);)

[Русский](/ru/code/54456) [中文](/zh/code/54456) [Español](/es/code/54456) [Deutsch](/de/code/54456) [日本語](/ja/code/54456) [Português](/pt/code/54456) [한국어](/ko/code/54456) [Français](/fr/code/54456) [Italiano](/it/code/54456) [Türkçe](/tr/code/54456)

Views:
:   8615

Rating:
:   (10)

Published:
:   25 December 2024, 11:43

Updated:
:   22 August 2025, 06:39
:   [Trailing Sl.mq5](/en/code/download/54456/trailing_sl.mq5 "Trailing Sl.mq5")
    (2.99 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/54456.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Copy these into any EA you are busy coding and you"ll have a trailing SL.  
The only things you'll need to change would probably be InpMagic for your magic number or you could just copy my code as is , Remember to add COrderinfo ord; and CPositionInfo pos;

![On tick function](https://c.mql5.com/18/167/1__1.JPG "On tick function") [![Trailing sl](https://c.mql5.com/18/167/2__2.JPG "Trailing sl")](https://c.mql5.com/18/167/2__1.JPG "https://c.mql5.com/18/157/2__1.JPG")

![Inputs](https://c.mql5.com/18/167/Capture__1.JPG "Inputs")

**Last comments |
[Go to discussion](/en/forum/478723)**
(3)

![Ugochukwu Nwoko](https://c.mql5.com/avatar/2019/5/5CE80B1D-463A.jpg "Ugochukwu Nwoko")

**[Ugochukwu Nwoko](/en/users/georgemagnus78)**
|
2 Jan 2025 at 18:01

This EA is not working

[![Trailing Xl on XAuusd](https://c.mql5.com/3/451/trailing_sl__1.png "Trailing Xl on XAuusd")](https://c.mql5.com/3/451/trailing_sl.png "https://c.mql5.com/3/451/trailing_sl.png")

Please rectify.

Thank you

![Lamont Simone Reynecke](https://c.mql5.com/avatar/2024/11/6746273c-5443.jpg "Lamont Simone Reynecke")

**[Lamont Simone Reynecke](/en/users/trickster247)**
|
4 Jan 2025 at 07:27

**Ugochukwu Nwoko [#](/en/forum/478723#comment_55523796):**  

This EA is not working

Please rectify.

Thank you

Hi sir, please read the post again, this is coding that you can use to add to your own ea if you need a trailing sl

I didn't add a bot it's just coding for the trailing sl

![Lamont Simone Reynecke](https://c.mql5.com/avatar/2024/11/6746273c-5443.jpg "Lamont Simone Reynecke")

**[Lamont Simone Reynecke](/en/users/trickster247)**
|
4 Jan 2025 at 07:31

**Ugochukwu Nwoko [#](/en/forum/478723#comment_55523796):**  

This EA is not working

Please rectify.

Thank you

And also remember the reason why the trailing sl is not working is because of the magic number

If you are coding a bot, the bot uses magic numbers, then the trailing sl looks for trades places by the ea and if the magic numbers are the same the trailing sl will work

![Buffers for each hour (binary) and an hour buffer from 0-23 - for data collection purposes](https://c.mql5.com/i/code/indicator.png)
[Buffers for each hour (binary) and an hour buffer from 0-23 - for data collection purposes](/en/code/54446)

Prototype for data collection.
Dummy buffers for the data window (for data collection purposes) for the hour of the day, and an additional buffer for the hour of the day. Comments the hour of the day.

![Profit labels for closed trades (deals)](https://c.mql5.com/i/code/expert.png)
[Profit labels for closed trades (deals)](/en/code/54352)

Creating profit labels on deals (closed trades) which also show in the strategy tester

![Script to Map Market Watch Symbols Based on Similarity](https://c.mql5.com/i/code/script.png)
[Script to Map Market Watch Symbols Based on Similarity](/en/code/54554)

This script is a reference solution for mapping symbol names configured by users in MetaTrader 5 EAs or scripts to the actual names provided by the broker.
It uses the Levenshtein distance algorithm to automatically identify the most similar symbol in Market Watch.
It is ideal for developers facing compatibility issues with prefixes or suffixes in symbol names.
This is a customizable starting point to adapt to any specific needs.

![BollingerBandsEA](https://c.mql5.com/i/code/expert.png)
[BollingerBandsEA](/en/code/54612)

BollingerBandsEA trades according to Bollinger Bands.