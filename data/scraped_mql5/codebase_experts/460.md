# Spearman's Rank Correlation - indicator for MetaTrader 5

Source: https://www.mql5.com/en/code/460

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/460) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# Spearman's Rank Correlation - indicator for MetaTrader 5

Rosh  |
[English](javascript:void(false);)

[Русский](/ru/code/460) [中文](/zh/code/460) [Español](/es/code/460) [Deutsch](/de/code/460) [日本語](/ja/code/460) [Português](/pt/code/460) [한국어](/ko/code/460) [Français](/fr/code/460) [Italiano](/it/code/460) [Türkçe](/tr/code/460)

Published by:
:   [Nikolay Kositsin](/en/users/godzilla)

Views:
:   14565

Rating:
:   (27)

Published:
:   6 October 2011, 16:58

Updated:
:   22 November 2016, 07:32
:   [spearmanrankcorrelation.mq5](/en/code/download/460/spearmanrankcorrelation.mq5 "spearmanrankcorrelation.mq5")
    (7.23 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/460.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

**Real author:**

Rosh

Spearman's Rank Correlation is a non-parametrical method used for
statistical analysis of the correlation.

Practical calculation of the Spearman's Rank Correlation ratio includes the following steps:

1. An index number (a rank) must be assigned to each of the parameters in ascending (or descending) order;
2. The differences of each pair ranks of the compared values must be determined;
3. Each difference must be squared and the gained results must be summed up;
4. The ranks correlation ratio must be calculated as follows:

![](https://c.mql5.com/18/28/formulaS__4.gif)

where ![](https://c.mql5.com/18/28/Sum__4.gif) is a sum of the ranks difference and ![](https://c.mql5.com/18/30/n.gif) is a number of paired observations.

When using the rank correlation ratio, the tightness of the correlation between the parameters is conventionally evaluated. The ratio values equal to 0.3 or lower are deemed to show weak correlation tightness, the values more than 0.4 but less than 0.7 show moderate
correlation tightness and the values equal to 0.7 or higher indicate high correlation tightness.

The power of the Spearman's Rank Correlation is a bit lower than the power of the correlation parametrical ratio. It is reasonable to use the rank correlation ratio in case there is a small amount of observation results.

This method can be used not only for quantitative data but also when registered values are determined by descriptive features of different intensity. The description is taken from [here](https://www.mql5.com/go?link=http://www.infamed.com/stat/s05.html "http://www.infamed.com/stat/s05.html").

This indicator is a type of an oscillator but it is more smooth unlike [Stochastic](https://www.metatrader5.com/en/terminal/help/indicators/oscillators/so), while not lagging at the reverse points.

The only external parameter affecting the calculation algorithm is rangeN setting the number of bars, for which we are looking for regularity. If rangeN = 14, we use the close prices sequence Close[i], Close[i+1], ... Close[i+rangeN-1] and create a sequence of ranks for
them, i.e. the place each close price is located at, in case this sequence is sorted. In this case we have one real chart compared with a steadily increasing one.

The direction parameter means sorting in descending (true) or ascending (false) order. The value of the true parameter shows more traditional picture, while false shows a mirror image.

The CalculatedBars parameter is implemented to limit the number of the bars the calculation is performed for and to save CPU resources (though it may not be so important). Zero value means the calculation refers to the whole available history. The Maxrange parameter that is
equal to 30 sets the maximum calculation period. This parameter is also implemented to save resources and it can be useful for some traders.

![Spearman's Rank Correlation](https://c.mql5.com/18/3/SpearmanRankCorrelation.png "Spearman's Rank Correlation")

Spearman's Rank Correlation indicator

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/460](/ru/code/460)

**Last comments |
[Go to discussion](/en/forum/4841)**
(2)

![okwh](https://c.mql5.com/avatar/2011/9/4E7F67FD-3C19.jpg "okwh")

**[okwh](/en/users/dxdcn)**
|
7 Oct 2011 at 07:21

Would you mind to explain what is d  ?

How to calculate it or [rank](https://www.mql5.com/en/docs/matrix/matrix_characteristics/matrix_rank " MQL5 Documentation: function Rank") it ?

:

sort ;

default rank is the order;

if (eq)  then rank is everage of all rank of eqs;

![Sergey Vedmanov](https://c.mql5.com/avatar/2021/7/60DD90BB-04AD.jpg "Sergey Vedmanov")

**[Sergey Vedmanov](/en/users/switch)**
|
3 Apr 2014 at 08:35

There's a version for four? The old one doesn't want to work properly anymore.

![ZigZag](https://c.mql5.com/i/code/indicator.png)
[ZigZag](/en/code/453)

The variant of the ZigZag indicator optimized by its operation rate.

![Chaikin Volatility Index With a Smoothing Algorithm Selection](https://c.mql5.com/i/code/indicator.png)
[Chaikin Volatility Index With a Smoothing Algorithm Selection](/en/code/471)

Chaikin Volatility Index determines volatility on the basis of the range width between minimum and maximum. The presented variant of this popular indicator allows to select the smoothing algorithm out of ten possible variants.

![Chaikin Oscillator](https://c.mql5.com/i/code/indicator.png)
[Chaikin Oscillator](/en/code/476)

Chaikin Oscillator with a smoothing algorithm selection.

![AT_CF](https://c.mql5.com/i/code/indicator.png)
[AT\_CF](/en/code/456)

Four digital filters that form the basis of the V. Kravchuk's AT&CF method in one separate window.