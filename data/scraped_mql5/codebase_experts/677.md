# sSyncScroll - script for MetaTrader 5

Source: https://www.mql5.com/en/code/677

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/677) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# sSyncScroll - script for MetaTrader 5

[Dmitry Fedoseev](/en/users/integer)  |
[English](javascript:void(false);)

[Русский](/ru/code/677) [中文](/zh/code/677) [Español](/es/code/677) [Deutsch](/de/code/677) [日本語](/ja/code/677) [Português](/pt/code/677) [한국어](/ko/code/677) [Français](/fr/code/677) [Italiano](/it/code/677) [Türkçe](/tr/code/677)

Views:
:   6524

Rating:
:   (47)

Published:
:   13 January 2012, 13:09

Updated:
:   22 November 2016, 07:32
:   [ssyncscroll.mq5](/en/code/download/677/ssyncscroll.mq5 "ssyncscroll.mq5")
    (7.72 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/677.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Script for the charts simultaneous scrolling.

The script is launched on one chart. When scrolling any of the charts, the rest ones are also shifted. Such a position is marked by vertical lines.

It is better to turn on the "Shift end of the chart from the right border" option when using the script.

![Script for the charts simultaneous scrolling](https://c.mql5.com/18/5/123.png "Script for the charts simultaneous scrolling")

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/677](/ru/code/677)

**Last comments |
[Go to discussion](/en/forum/5889)**
(15)

![Дима Джумок](https://c.mql5.com/avatar/avatar_na2.png "Дима Джумок")

**[Дима Джумок](/en/users/dzhumok)**
|
23 Jan 2023 at 03:33

Indeed, when trying to scroll the chart back and view the history, when a new tick arrives, the chart returns to the very beginning. In this case, why do I need it? I already know that when drawing the last candle on M1, it is also the last candle for all other TFs. And without this indicator in all windows the last candlesticks are redrawn automatically.

![Dmitry Fedoseev](https://c.mql5.com/avatar/2014/9/54056F23-4E95.png "Dmitry Fedoseev")

**[Dmitry Fedoseev](/en/users/integer)**
|
23 Jan 2023 at 04:52

**Дима Джумок [#](/ru/forum/5332#comment_44532894):**  
 Indeed, when trying to scroll the chart back and view the history, when a new tick arrives, the chart returns to the very beginning. In this case, why do I need it? I already know that when drawing the last candle on M1, it is also the last candle for all other TFs. And without this indicator in all windows the last candlesticks are redrawn automatically.

It broke after the next changes in the language, I have another one here, also broken. Look for more, there are working ones here.

![Дима Джумок](https://c.mql5.com/avatar/avatar_na2.png "Дима Джумок")

**[Дима Джумок](/en/users/dzhumok)**
|
23 Jan 2023 at 05:22

**Dmitry Fedoseev [#](/ru/forum/5332#comment_44534728):**  

It broke after another change in the language, I have another one here, also broken. Look for more, there are some working ones here.

Dmitry, thank you for your reply. To my regret google gives links only to your developments. Forum also did not offer me anything alternative. Admiral Market offers such a function but only on their platform and it is not MT5. Dear [fxsaber](/en/users/fxsaber) offered in 2017 his variant [Simultaneous autoscrolling of charts for one instrument in different timeframes for MT5 - Technical Indicators and Forex Market Analysis - MQL5 Algo-Traders Forum](/ru/forum/222207) (there is the indicator text in the last comment), but I don't know how to convert it for MT5 terminal, so I can't determine if it is a working variant. If you don't mind, please convert it, maybe it is working.

```mql5
// MQL4&5-code
// Synchronisation of all charts by right time

sinput int TimerInterval = 1; // Update interval in milliseconds

// Disables autoscroll and shift on all charts
bool AutoShiftOff( void )
{
  long handle = ChartFirst();

  while (handle != INVALID_HANDLE)
  {
    ChartSetInteger(handle, CHART_SHIFT, false);
    ChartSetInteger(handle, CHART_AUTOSCROLL, false);

    handle = ChartNext(handle);
  }

  return(true);
}

const bool Init = EventSetMillisecondTimer(TimerInterval) && AutoShiftOff();

void OnTimer()
{
  SyncCharts();
}

// Returns true if there is no bar with this time ("hole")
bool IsHole( const string Symb, const ENUM_TIMEFRAMES TimeFrame, const datetime time )
{
  return(Bars(Symb, TimeFrame, SeriesInfoInteger(_Symbol, PERIOD_CURRENT, SERIES_FIRSTDATE), time) +
         Bars(Symb, TimeFrame, time, SeriesInfoInteger(_Symbol, PERIOD_CURRENT, SERIES_LASTBAR_DATE)) ==
         SeriesInfoInteger(_Symbol, PERIOD_CURRENT, SERIES_BARS_COUNT));
}

// Returns the time bar
int iBarShift( const string Symb, const ENUM_TIMEFRAMES TimeFrame, datetime time )
{
  int Res = -1;
  datetime LastBar;

  time -= time % PeriodSeconds(TimeFrame);

  if (SeriesInfoInteger(Symb, TimeFrame, SERIES_LASTBAR_DATE, LastBar))
  {
    if (time > LastBar)
      Res = (int)((LastBar - time) / PeriodSeconds(TimeFrame));
    else
    {
      const int Shift = Bars(Symb, TimeFrame, time, LastBar);

      if (Shift > 0)
      {
        Res = Shift - 1;

        if (IsHole(Symb, TimeFrame, time))
          Res++;
      }
    }
  }

  return(Res);
}

// Returns the bar time
datetime iBarShift( const string Symb, const ENUM_TIMEFRAMES TimeFrame = PERIOD_CURRENT, const int Pos = 0 )
{
  datetime Tmp[1];

  CopyTime(Symb, TimeFrame, (Pos < 0) ? 0 : Pos, 1, Tmp);

  return(Tmp[0] - ((Pos < 0) ? Pos * PeriodSeconds(TimeFrame) : 0));
}

// Returns the right chart bar
int ChartBarRight( const long chartID = 0 )
{
  return((int)(ChartGetInteger(chartID, CHART_FIRST_VISIBLE_BAR) - ChartGetInteger(chartID, CHART_WIDTH_IN_BARS) + 1));
}

// Returns the right chart time
datetime GetChartTimeRight( const long chartID = 0 )
{
  return(iBarShift(ChartSymbol(chartID), ChartPeriod(chartID), ChartBarRight(chartID)));
}

// Sets the right chart time, returns the set time
datetime SetChartTimeRight( datetime time, const long chartID = 0, const ulong MaxTime = 1 e5 )
{
  const string Symb = ChartSymbol(chartID);
  const ENUM_TIMEFRAMES period = ChartPeriod(chartID);

  const int Pos = iBarShift(Symb, period, time);
  const int PrevPos = ChartBarRight(chartID);

  if ((Pos != PrevPos) && ChartNavigate(chartID, CHART_END, -1 - Pos))
  {
    const ulong StartTime = GetMicrosecondCount();
    int NewPos = ChartBarRight(chartID);

    while (((NewPos != Pos)|| (NewPos == PrevPos)) && (GetMicrosecondCount() - StartTime < MaxTime) && !IsStopped())
    {
      Sleep(0);
      
      NewPos = ChartBarRight(chartID);
    }
  }

  return(GetChartTimeRight(chartID));
}

// Add an element to the end of an arbitrary array
template <typename T>
void AddArrayElement( T &Array[], const T Value, const int Reserve = 0 )
{
  const int Size = ArraySize(Array);

  ArrayResize(Array, Size + 1, Reserve);

  Array[Size] = Value;
}

// Gets the time of the right bar of each chart
int GetChartsTimeRight( datetime &RightTime[], long &Handles[] )
{
  ArrayFree(RightTime);
  ArrayFree(Handles);

  long handle = ChartFirst();

  while (handle != INVALID_HANDLE)
  {
    AddArrayElement(RightTime, GetChartTimeRight(handle));
    AddArrayElement(Handles, handle);

    handle = ChartNext(handle);
  }

  return(ArraySize(RightTime));
}

// Sets the right time for all charts
int SetChartsTimeRight( const datetime time, datetime &RightTime[], const long ExcludeHandle = 0 )
{
  ArrayFree(RightTime);

  long handle = ChartFirst();

  while (handle != INVALID_HANDLE)
  {
    AddArrayElement(RightTime, (ExcludeHandle == handle) ? GetChartTimeRight(handle) : SetChartTimeRight(time, handle));

    handle = ChartNext(handle);
  }

  return(ArraySize(RightTime));
}

// Returns the chart that the time of the right bar has changed
long GetChangeChart( const datetime &PrevRightTime[])
{
  datetime Handles[];
  datetime RightTime[];

  long Res = ArraySize(PrevRightTime) ? 0 : ChartID();

  for (int i = MathMin(ArraySize(PrevRightTime), GetChartsTimeRight(RightTime, Handles)) - 1; i >= 0; i--)
    if (RightTime[i] != PrevRightTime[i])
    {
      Res = Handles[i];

      break;
    }

  return(Res);
}

// Synchronise all charts by right time, returns the number of charts synchronised
int SyncCharts()
{
  static datetime PrevRightTime[];

  const long handle = GetChangeChart(PrevRightTime);

  return(handle ? SetChartsTimeRight(GetChartTimeRight(handle), PrevRightTime, handle) : 0);
}
```

![Dmitry Fedoseev](https://c.mql5.com/avatar/2014/9/54056F23-4E95.png "Dmitry Fedoseev")

**[Dmitry Fedoseev](/en/users/integer)**
|
23 Jan 2023 at 06:07

**Дима Джумок [#](/ru/forum/5332#comment_44534822):**  

Dmitry, thank you for your reply. To my regret google gives links only to your developments. The forum also did not offer me anything alternative. Admiral Market offers such a function but only on their platform and it is not MT5. Dear [fxsaber](/en/users/fxsaber) offered in 2017 his variant [Simultaneous autoscrolling of charts for one instrument in different timeframes for MT5 - Technical Indicators and Forex Market Analysis - MQL5 Algo-Traders Forum](/ru/forum/222207) (there is the indicator text in the last comment), but I don't know how to convert it for MT5 terminal, so I can't determine if it is a working variant. If you don't mind, please convert it, maybe it is working.

Then it's better to fix your own.

I downloaded mine now, it works. One inconvenience - if indents are not enabled, the required bar on the scrolling chart goes over the edge and the line is not visible. This will have to be corrected.

What do you have going on, how is it not working? The script disables auto-scrolling with the arrival of a new tick.

This button on the toolbar should be automatically pressed on all charts when the script is attached:

![](https://c.mql5.com/3/400/qbzpskc8ds.png)

![Denis K.](https://c.mql5.com/avatar/2023/3/64138BCA-DC7E.jpg "Denis K.")

**[Denis K.](/en/users/deniskdm)**
|
21 Jul 2025 at 10:35

Bombshell! It works! Thank you so much!

![ElderImpulseSystem_HTF_Signal](https://c.mql5.com/i/code/indicator.png)
[ElderImpulseSystem\_HTF\_Signal](/en/code/693)

ElderImpulseSystem\_HTF\_Signal displays trend directions from the last bars of the ElderImpulseSystem as a sequence of graphical objects. The number of bars to be used is set in the input parameters.

![IncCHOOnArray](https://c.mql5.com/i/code/library.png)
[IncCHOOnArray](/en/code/670)

CCHOOnArray class is designed for calculation of Chaikin Oscillator (CHO) values on indicator buffers. Test\_CHOOnArray indicator is provided as the example of the class use.

![IncRVIOnArray](https://c.mql5.com/i/code/library.png)
[IncRVIOnArray](/en/code/654)

CRVIOnArray class is designed for calculation of RVI (Relative Vigor Index) values on indicator buffers. Test\_RVIOnArray indicator is provided as the example of the class use.

![Quotes Monitoring  (memory-mapped file)](https://c.mql5.com/i/code/expert.png)
[Quotes Monitoring (memory-mapped file)](/en/code/817)

This Expert Advisor is example of use of the Memory Mapping DLL for working with File Mapping functions. In this example the Expert Advisor create a virtual (memory-mapped) file and start to update the quotes on symbol. Using this way, Expert Advisors can exchange data (for example, quotes) using common memory-mapped file.