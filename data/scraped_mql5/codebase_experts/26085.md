# Wedge pattern - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/26085

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/26085) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Wedge pattern - expert for MetaTrader 4

[Aharon Tzadik](/en/users/aharontzadik1)

Views:
:   21476

Rating:
:   (22)

Published:
:   14 July 2019, 20:53

Updated:
:   12 November 2025, 22:06
:   [Wedge pattern.mq4](/en/code/download/26085/Wedge_pattern.mq4 "Wedge pattern.mq4")
    (131.63 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/26085.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

"Wedge pattern" naked trading price action EA draws 2 mini Trend Lines with "Fractals" on chart and trades with Wedge pattern strategy,has Trailing Stop Loss &Take Profit works with all time frames major forex pairs and stocks NASDAQ.

### The concept of this price action EA is:

* In a falling wedge, both boundary lines slant down from left to right.
* The upper descends at a steeper angle than the lower line.
* Volume keeps on diminishing and trading activity slows down due to narrowing prices.
* There comes the breaking point, and trading activity after the breakout differs.

![Wedge pattern](https://c.mql5.com/18/159/untitled__5.png "Wedge pattern")

![Wedge pattern](https://c.mql5.com/18/159/untitled__6.png "Wedge pattern")

### 

* Try it on demo first.
* This EA trades only with the price of open candle!
* If you do not want to trade with increasing lot size when you lose  a trade set:"IncreaseFactor=0"

* I combined together a simple EA with two moving averages and Trend Line,
* The Trend Line do not work on test mode,
* The optimization tests can be performed only with moving averages,
* In live trading only, Trend Line and moving averages will work together,
* During tests, the EA  only draws the Trend Line on the screen in  visual mode without considering it in the creation of trades,
* The Trend Line will function as a filter .
* In this situation the probability of winning trades increases.

### Inputs

+ Use\_TP\_In\_Money- Use Take Profit In Money (values:true/false).
+ TP\_In\_Money- Take Profit In Money   (values: 10-100).
+ Use\_TP\_In\_percent- Use Take Profit In Percent (values:true/false).
+ TP\_In\_Percent- Take Profit In Percent (values: 10-100).
+ ------------[Money Trailing Stop For Multiple Trades]----------------------
+ Enable\_Trailing-Enable\_Trailing with money  (values:true/false).
+ Take Profit In Money (in current currency) (values: 25-300).
+ Stop Loss In Money(in current currency) (values: 1-20).
+ --------------------------------------------------------------------------------------
+ Exit= Close trades if the trend is against you and control draw dwon (values:true/false).
+ Lots - Lots size (values: 0.01-1).
+ Lots size Exponent  (values: 1.01-2).
+ IncreaseFactor -how much to increase lots from total margin if you lose a trade (values: 0.001-0.1).
+ Stop\_Loss - Stop Loss (values: 30-500).  /set value 600 for  Multiple Trades
+ MagicNumber - Magic number (values: 1-100000).
+ TakeProfit - Take Profit (values: 50-200).  /set value 600 for  Multiple Trades
+ FastMA - Fast Moving Average (values: 1-20).
+ SlowMA - Slow Moving Average (values: 50-200).
+ Mom\_Sell-Momentum\_Sell trigger(values: 0.1-0.9).
+ Mom\_Buy-Momentum\_Buy trigger(values: 0.1-0.9).
+ ---------------------CONTROL DRAW DOWN-----------------------------
+ UseEquityStop -  (values: true).
+ TotalEquityRisk- (values: 0.01-20).
+ -------------------------------------------------------------------------------
+ Max\_Trades(1-12).
+ FractalNum= Number Of High And Low(values: 1-10).
+ ----------------IF YOU USE ONLY 1 TRADE:-----------------------
+ /////////////////////////////////////////////////////////////////////
+ USETRAILINGSTOP-If use trailing stop (values:true/false).
+ WHENTOTRAIL-When to trail (values: 40-100).
+ TRAILAMOUNT-Trail amount (values: 40-100).
+ Distance From Candle -Distance From Candle (values: 1-100).
+ USECANDELTRAIL=If use trailing stop (values:true/false).
+ X=2-number of candles (values: 1-100).
+ USEMOVETOBREAKEVEN-Enable " break even " (values: true/false).
+ WHENTOMOVETOBE-When to move break even (values: 1-30).
+ PIPSTOMOVESL=30-How much pips to move stop loss  (values: 1-30).

-You should optimize this EA every few months and use the exact same  inputs from above .  
-You can use it as  hedging grid EA or a single trade EA.  
-How to perform back test:[https://bit.ly/2CD7XWD](/go?link=https://bit.ly/2CD7XWD "https://bit.ly/2CD7XWD")

[![Wedge pattern back test op](https://c.mql5.com/18/159/4dzqh3x_w9l_f615__1.png "Wedge pattern back test op")](https://c.mql5.com/18/159/j6adff8_qud_w61w__1.png "https://c.mql5.com/18/84/j6adff8_qud_w61w.png")

**Last comments |
[Go to discussion](/en/forum/317918)**
(11)

![Aleksey Ivanov](https://c.mql5.com/avatar/2020/1/5E12216A-1588.png "Aleksey Ivanov")

**[Aleksey Ivanov](/en/users/60000382)**
|
20 Sep 2019 at 17:56

A good idea. It is necessary to collect statistics of such transitions to it.

![aalaarajy](https://c.mql5.com/avatar/avatar_na2.png "aalaarajy")

**[aalaarajy](/en/users/aalaarajy)**
|
20 Sep 2019 at 19:11

Also, could some one tell me if it is enough just to atatch the ea to the char or I have also to atatch necessary indicators, and which?

![Aharon Tzadik](https://c.mql5.com/avatar/2018/7/5B4AA594-75A6.jpg "Aharon Tzadik")

**[Aharon Tzadik](/en/users/aharontzadik1)**
|
21 Sep 2019 at 23:32

**aalaarajy:**

  

Hello

You are right the "trailing [take profit](https://www.metatrader5.com/en/terminal/help/trading/general_concept "User Guide: Types of orders")" does not allow to take profit ,it always run faster and in the end you go out from a trade by stop loss,

So I have upgraded the EA and changed it, now there is only simple take profit, i need to do the same with all of my published EAs, and it will take
some time.

About  "enable
no loss" system, actually you have here two functions of " trailing stop loss", the first one is the 
 "enable
no loss" system and this function works only one time to prevent loss, for example : if the price goes with your trade for 20 pips ("when to move
break even" parameter)  then it will move for 10 pips("How much pips to move sl" parameter) to protect your trade if the price goes
against you with a value that should be smaller then the other trailing stop loss, the second trailing stop loss should have a bigger value,
say "Trailingstop=30" pips, if you disable the 
 "enable
no loss" variable and set "false" then you will stay only with the second "
Trailingstop"
function.

![Aharon Tzadik](https://c.mql5.com/avatar/2018/7/5B4AA594-75A6.jpg "Aharon Tzadik")

**[Aharon Tzadik](/en/users/aharontzadik1)**
|
21 Sep 2019 at 23:39

**aalaarajy:**  
 Also, could some one tell me if it is
enough just to atatch the ea to the char or I have also to atatch necessary indicators, and which?

Hello

You just need to attach the EA to the chart , no additional indicators are needed.

![aalaarajy](https://c.mql5.com/avatar/avatar_na2.png "aalaarajy")

**[aalaarajy](/en/users/aalaarajy)**
|
13 Dec 2019 at 13:55

Hi Aharon Tzadik

I really appreciate all your ideas and eas that you are posting. I really thankful for all those you are sharing.

But I have an idea based on only grid and mathemathical calculations. I could not find out how to get in touch with you, so I choosed to add it here maybe you could take a look on it and maybe you have time to create an ea for it.

My idea is based on a grid that should rely on [stop orders](https://www.metatrader5.com/en/terminal/help/trading/general_concept "User Guide: Types of orders") instead of limit orders as the most of the grid ideas are right now.

So the ea place stop orders in both directions according to a user defined steps. And it should take the profit also according to a user defined tp. But it have to move the tp every time a new trade get opened in the grid. So if the user set the tp to 50 and the ea opens every 5 pips trades and if we get 13 trades opened then the ea should look for 650 pips as profit for all the opened trades in order for closing.

Then if it close the trades then it remove the grid and start again.

But if the price go against you then of course should a user defined sl be responsible for closing the trades that got opened from the negative direction. But this time the ea do not have to worry about moving the sl, and just let it be individual sl for every trade.

Also if hedging could be added to the ea where it is up to user to either turn it on or off and from the grid level the user find appropriate will make the ea more profitable. But the hedgingg should work as the grid, so if the price after a good movement begin to go against you and your hedging begin to open trades, then the price continued in your right direction and acheaved your profits, then the EA should not close the hedged trades, but let them open and build the new grid according to them.

Ok, maybe a quick ea parameters that can make the idea clear

Starting lot:

multiplyer:

grid steps:

grid trades number:

tp:

sl:

hedging false or true

Hedging from level:

The most important in this EA should be the tp movement, hedging and the restarting. This will make the EA fully automatic. Such an EA will be good with pairs that do not have so much ranging and mostly have big movements in one direction. The idea is build on that you catch the correct trend and trade with it. Of course if the market have many ranging will make you suffer big losses, but here come the money management to work.

I hope you have the time to code such an idea.

And again thanks for your grate work.

![Head and Shoulders](https://c.mql5.com/i/code/expert.png)
[Head and Shoulders](/en/code/26066)

"Head and Shoulders" naked trading price action EA draws 2 mini Trend Lines with "Fractals" on chart and trades with "Head and Shoulders" strategy,has Trailing Stop Loss &Take Profit works with all time frames major forex pairs and stocks NASDAQ.

![Quarters Theory](https://c.mql5.com/i/code/indicator.png)
[Quarters Theory](/en/code/26057)

Divides whole levels into Halfs and Quarters.

![Camarilla Flat and Clear](https://c.mql5.com/i/code/indicator.png)
[Camarilla Flat and Clear](/en/code/26120)

The code consists of lines created according to the opening, closing, low and high values of prices.

![MAxCD](https://c.mql5.com/i/code/indicator.png)
[MAxCD](/en/code/26128)

Three Moving Averages Convergence/Divergence - Indicator for MT4