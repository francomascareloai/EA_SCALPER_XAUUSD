# Expert Advisor based on the rollback from the MA channel boundary - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/12375

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/12375) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Expert Advisor based on the rollback from the MA channel boundary - expert for MetaTrader 4

[LeonLexx](/en/users/leonlexx)  |
[English](javascript:void(false);)

[Русский](/ru/code/12375) [Español](/es/code/12375) [Deutsch](/de/code/12375) [日本語](/ja/code/12375) [Português](/pt/code/12375)

Views:
:   14215

Rating:
:   (26)

Published:
:   1 February 2016, 08:47

Updated:
:   22 November 2016, 07:32
:   [range\_ea.mq4](/en/code/download/12375/range_ea.mq4 "range_ea.mq4")
    (33.59 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/12375.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The [Moving Average](https://www.metatrader5.com/en/terminal/help/indicators/trend_indicators/ma) indicator data is used for trading. If the price goes away from the Moving Average by a certain number of points, then an order is placed in the direction of the Moving Average line.

The EA can make profit, but only a small one. It also requires a large deposit.

Idea of this EA was mine. The code of the EA was written by [Sergey Diubakin](/en/users/diubakin "Diubakin").

![](https://c.mql5.com/18/39/001.png)

The solid red line on the figure is the value of the [Moving Average](https://www.metatrader5.com/en/terminal/help/indicators/trend_indicators/ma) indicator, the dotted red line is the boundary of the channel (Range), which is calculated using the indicator value, and at the crossing of which a corresponding order is opened.

At the lower boundary of the channel (Range) the EA opens a Buy order, at the upper boundary — Sell order.

In order for the EA to open a Buy or Sell order on a candlestick/bar that touches the channel boundary (Range), the High or Low of the previous candlestick/bar (the "first" bar that precedes the "zero" bar) must be below/above the Range level: the High of the "first" bar must be below the upper boundary of the Range level o open a Sell order, the Low of the "first" bar must be above the lower boundary of the Range level to open a Buy order.

Also this EA additional plug-in modules: Turn, Step Down and Trade Time.

* **The Turn module** — places limit orders at the Stop Loss level of the main order in the opposite direction. I thought that this module would be helpful in the case when the price keeps moving away from the MA line once reaching the channel boundary.
* **The Step Down module** — places additional order in the direction of the main order. This module was used in another [Expert Advisor](/en/code/13617).
* **The Trade Time module** — sets the time interval for the EA to trade (does not apply to the orders of the Step Down module).

**Expert Advisor Settings:**

1. **Moving Average**

   * **Period** – parameter from the Moving Average indicator menu.
   * **Shift** – parameter from the Moving Average indicator menu.
   * **Method MA** – parameter from the Moving Average indicator menu.
   * **Apply to** – parameter from the Moving Average indicator menu.
   * **Range** – the distance (measured to the above and below) from the Moving Average indicator value at this point in time. Once the price reaches the Range level, the EA can open the first main order.
2. **Initial lot**

   * **LotConst\_or\_not** – allows the user to choose whether to start trading with the same lot or to recalculate the initial lot depending on the changes of the deposit:  
     *true* – the first lot will be fixed and equal to the value of Lots specified below.
   * **Lots** – sets the initial trading lot.
   * **RiskPercent** – sets the initial trading lot depending on the deposit.
3. **Take Profit** – profit level of an order (specified in points of the chart the EA is attached to).
4. **Stop Loss** – loss level of an order (specified in points of the chart the EA is attached to).
5. **Trailing stop** – automatically moved Stop Loss level.

   * *true* – module is activated (enabled);
   * *false* – module is deactivated (disabled).
6. ****Module** Turn**

   * *true* – module is activated (enabled);
   * *false* – module is deactivated (disabled).
   * **Turn** – distance after which an opposite pending order is placed.
   * **LotMultiplicator** – lot increase ratio.
   * **Turn\_TakeProfit** – profit level of an order which will be opened using this module (specified in points of the chart the EA is attached to).
7. ****Module** Step Down**

   * *true* – module is activated (enabled);
   * *false* – module is deactivated (disabled).
   * **Step Down** – distance (gap) between the opened orders in the order grid, which is placed against the "trend".
8. **Module Trade time**

   * *true* – module is activated (enabled);
   * *false* – module is deactivated (disabled).
   * **Open trade** – time, starting from which the EA may open the first main order, if there is a signal.
   * **Close trade** – time, after which the EA can not open the first main order.
9. **Magic (Magic Number)** – the program code of the EA, which allows it to distinguish its own orders from others.
10. **Logo and data output** – the module allows to enable/disable the table (earnings today, yesterday etc.):

    * *true* – module is activated (enabled);
    * *false* – module is deactivated (disabled).
11. **Time frame** – program code, which allows to specify the time frame of the chart for the EA to use for trading.

    * Current – the time frame, which is specified in the terminal.
    * M1, M5, M15, M30, H1, H4, D1, W1, MN1 – fixed time frames.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/12375](/ru/code/12375)

**[Go to discussion](/en/forum/72278)**

![RSI Bollinger Bands EA](https://c.mql5.com/i/code/expert.png)
[RSI Bollinger Bands EA](/en/code/14628)

RSI Bollinger Bands are used to establish overbought and oversold RSI regions for generation of short and long trading signals.

![ScalpWiz 9001](https://c.mql5.com/i/code/expert.png)
[ScalpWiz 9001](/en/code/14502)

Trades on price spikes around important financial announcements.

![Tick Chart](https://c.mql5.com/i/code/indicator.png)
[Tick Chart](/en/code/12891)

Tick chart of the price/spread/volume. Saves tick data in a file.

![Grid](https://c.mql5.com/i/code/expert.png)
[Grid](/en/code/12947)

Arrangement of the pending orders at equal intervals (steps).