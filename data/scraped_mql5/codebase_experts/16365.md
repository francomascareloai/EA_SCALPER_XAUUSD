# Vertical histograms constructor - library for MetaTrader 5

Source: https://www.mql5.com/en/code/16365

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/16365) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Libraries](https://c.mql5.com/i/code/library.png)

# Vertical histograms constructor - library for MetaTrader 5

[Sergey Pavlov](/en/users/dc2008)  |
[English](javascript:void(false);)

[Русский](/ru/code/16365) [中文](/zh/code/16365) [Español](/es/code/16365) [Deutsch](/de/code/16365) [日本語](/ja/code/16365) [Português](/pt/code/16365)

Views:
:   8446

Rating:
:   (30)

Published:
:   18 January 2017, 09:25
:   \MQL5\Include\

    [Histogram.mqh](/en/code/download/16365/histogram.mqh "Histogram.mqh")
    (30.65 KB)
    [view](# "view")

    \MQL5\Indicators\

    [histogram\_bid\_ask\_2\_indicators.mq5](/en/code/download/16365/histogram_bid_ask_2_indicators.mq5 "histogram_bid_ask_2_indicators.mq5")
    (10.02 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/16365.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

A histogram is a bar chart of frequencies. One of the axes represents variable values, while another — the frequency of these values' occurrence. The height of each bar shows the frequency (number) of values ​​belonging to the respective interval equal to the column width. Such diagrams are usually displayed horizontally, i.e. variable values are located on a horizontal axis, while frequency — on a vertical one.

In this library, we will focus on the vertical histograms of the order statistics: price values of the analyzed parameters are to be located on the vertical axis in ascending order, while frequency is to be located on the horizontal axis. Incoming price data are distributed and grouped on the current bar and can be displayed relative to its axis from the left, right or both sides simultaneously.

![Fig. 1. Vertical histogram of Bid and Ask prices distribution.](https://c.mql5.com/18/54/0_1.png "Fig. 1. Vertical histogram of Bid and Ask prices distribution.")

Fig. 1. Vertical histogram of Bid and Ask prices distribution.

Constructor of vertical histograms is based on the **CHistogram** class. Implementation of all its methods are based on the use of so-called "graphic" memory.

Method: class constructor **CHistogram**.

Initializes an instance of the class.

void CHistogram(  
   string name,                     // unique name prefix  
   int    hsize,                    // chart scale  
   int    width,                    // width of the histogram line bars

Parameters:

*name*

   [in] The unique name prefix for the columns of the histogram.

*hsize*

   [in] The scale of the histogram display.

*width*

   [in] The width of the histogram line bars

*active*

   [in] The color of the histogram columns updated on the current bar.

*passive*

   [in] The color of the histogram columns not updated on the current bar.

*Left\_Right=true*

   [in] The direction of the histogram display. false — histogram to the left of the current bar, true — to the right.

*relative\_frequency=false*

   [in] The method of accounting the frequency values. false — absolute frequency values, true — relative frequency values.

*sub\_win=0*

   [in] The index of the window for plotting the histogram. 0 — main chart window.

Returned value:

   No return value. If successful, it creates an instance of the class with the specified parameters.

Method: histogram display **DrawHistogram**.

Displays the histogram bars: creates new bars; edits existing bars; stores the frequency values to the graphic memory; displays the histogram on the current bar.

void DrawHistogram(  
   double price,  // value of the variant  
   datetime time  // time of the current bar  
   );

Parameters:

*price*

   [in] Value of the variant of the studied market characteristics.

*time*

   [in] Time of the current bar. This bar will be the histogram axis.

Returned value:

   No return value. If successful, creates new or adjusts existing histogram column. If a new bar appeared, the histogram is shifted so that the axis is on the current bar.

Method: calculation of the histogram characteristics **HistogramCharacteristics**.

Returns the calculated characteristics of the order statistic in a variable of type sVseries.

sVseries HistogramCharacteristics();

Parameters:

   No input parameters.

Returned value:

   If successful, it returns the value of a variable of type sVseries.

Structure for getting the current values of the histogram characteristics (**sVseries**).

Structure for storing past values of the characteristics of the statistical distribution. Designed for getting the most demanded information on the order statistic.

struct sVseries  
  {  
   long     N;    // total number of observations  
   double   Na;   // average value of frequencies  
   double   Vmax; // maximum value of the variant  
   double   Vmin; // minimum value of the variant  
   double   A;    // amplitude of the order statistic  
   double   Mean; // weighted arithmetic mean  
   double   D;    // variance  
   double   SD;   // standard deviation  
  };

Variable of **sVseries** type allows to obtain the values of all main characteristics of the order statistic displayed as a histogram by using a single call to the **HistogramCharacteristics()** function.

Method: visualization of the mean value **DrawMean**.

Displays the value of the weighted arithmetic mean of order statistic on the chart.

void DrawMean(  
   double coord,     // value of the weighted arithmetic mean  
   datetime time,    // time of the current bar  
   bool marker=false,// display the marker or not  
   bool save=false   // store the value to history or not  
   );

Parameters:

*coord*

   [in] The value of the weighted arithmetic mean.

*time*

   [in] Time of the current bar. The value of the weighted arithmetic mean will be measured on this bar.

*marker=false*

   [in] Display marker on the chart or not. false — marker is not displayed, true — marker is displayed on the chart.

*save=false*

   [in]  Store the value of the weighted arithmetic mean to history. false — do not display, true — display the value on the chart.

Returned value:

   If successful, a horizontal line is displayed on the chart, which corresponds to the value of the weighted arithmetic mean.

Method: visualization of the standard deviation **DrawSD**.

Displays the value of standard deviation as a rectangle. The rectangle width matches the average frequency and its height matches the standard deviation plotted up and down of the weighted arithmetic mean value.

void DrawSD(  
   sVseries &coord,        // variable of type sVseries  
   datetime time,          // time of the current bar  
   double deviation=1.0,   // deviation  
   color clr=clrYellow     // display color  
   );

Parameters:

*coord*

   [in] The value of a variable of type sVseries.

*time*

   [in] Time of the current bar.

*deviation=1.0*

   [in] Coefficient to increase the value of the standard deviation.

*clr=clrYellow*

   [in] Color of the rectangle that visualizes the standard deviation.

Returned value:

   If successful, displays a rectangle on the chart, which characterizes the standard deviation from the value of the weighted arithmetic mean.

Capabilities of the class are demonstrated in the video. Code of the test sample is provided in the attachment.

The provided code shows how to call a particular method (function) of the class.

**Tips:**

* It is better to use the class on the smaller timeframes.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/16365](/ru/code/16365)

**[Go to discussion](/en/forum/167144)**

![Exp_AFL_WinnerV2](https://c.mql5.com/i/code/expert.png)
[Exp\_AFL\_WinnerV2](/en/code/16359)

The Exp\_AFL\_WinnerV2 Expert Advisor that uses the AFL\_WinnerV2 indicator.

![AFL_WinnerV2_HTF](https://c.mql5.com/i/code/indicator.png)
[AFL\_WinnerV2\_HTF](/en/code/16358)

The AFL\_WinnerV2 indicator with the timeframe selection option available in input parameters.

![JSatl_Digit_System](https://c.mql5.com/i/code/indicator.png)
[JSatl\_Digit\_System](/en/code/16370)

The indicator implements a breakout system using a channel based on the High and Low price series processed by the algorithm of JSatl\_Digit.

![Exp_JSatl_Digit_System](https://c.mql5.com/i/code/expert.png)
[Exp\_JSatl\_Digit\_System](/en/code/16371)

Trading system based on the signals of the JSatl\_Digit\_System indicator.