# ExpPinBar - Expert Advisor for Pin Bar Price Action patterns - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/63971

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/63971) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# ExpPinBar - Expert Advisor for Pin Bar Price Action patterns - expert for MetaTrader 5

[Artyom Trishkin](/en/users/artmedia70)  |
[English](javascript:void(false);)

[Русский](/ru/code/63971) [中文](/zh/code/63971) [Español](/es/code/63971) [Deutsch](/de/code/63971) [日本語](/ja/code/63971) [Português](/pt/code/63971) [한국어](/ko/code/63971) [Français](/fr/code/63971) [Italiano](/it/code/63971) [Türkçe](/tr/code/63971)

Views:
:   2296

Rating:
:   (6)

Published:
:   22 October 2025, 13:03
:   [ExpPinBar.mq5](/en/code/download/63971/ExpPinBar.mq5 "ExpPinBar.mq5")
    (93.63 KB)
    [view](# "view")

    \MQL5\Indicators\PriceAction\

    [iPinBars.mq5](/en/code/download/63971/iPinBars.mq5 "iPinBars.mq5")
    (17.27 KB)
    [view](# "view")

    \MQL5\Include\Trailings\

    [Trailings.mqh](/en/code/download/63971/Trailings.mqh "Trailings.mqh")
    (107.4 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/63971.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

ExpPinBar Expert Advisor implements a trading strategy based on the [Price Action PinBar indicator](/en/code/63672). Positions are opened based on signals from the indicator. To manage open positions, an extended trailing functionality provided by the [trailing library](/en/code/63926) is available: classic, by Parabolic SAR indicator, moving averages AMA, DEMA, FRAMA, MA, TEMA, VIDYA, as well as by the levels of High and Low candlestick shadows.

**Settings for the pin-bar indicator:**

* **Minimum size of a candle from low to high** - *Minimum size of***a candle** *(in pips).*  
   Sets the minimum allowed height of a candle being analysed (the difference between High and Low). Candles of smaller size are ignored by the indicator, which allows excluding insignificant or "noise" candles.  
   Increase the value to filter weak signals on low-volatility markets;
* **Maximum size of the candle body relative to its shadows** - *Maximum size of the candle body (relative to the size of the whole candle, from 0 to 1).*  
   Defines the maximum allowable size of the candle body (difference between Open and Close) relative to the full height of the candle. The smaller the value, the more pronounced will be the signals with long shadows and a small body - classic Pin Bars.  
   To find the most "clean" Pin Bars, use values 0.2 -  0.4;
* **Position of the body relative to the previous** *candle (from 0 to 1).*  
   The parameter defines how deep the Pin Bar body can go into the range of the previous candle. The smaller the value, the closer the body will be to the edge of the range, which corresponds to classic reversal patterns.  
   Use values 0.2-0.4 to search for signals where the Pin Bar body is located near the border of the previous candle;
* **Aspect ratio of the shadows** *(coefficient)*  
   Sets the minimum ratio between the length of the main shadow (upper for Pin Bar for Sell, lower for Pin Bar for Buy) and the opposite shadow. The higher the value, the more pronounced should be the main shadow compared to the opposite shadow.  
   Values 1.5 -  2.5 allow filtering signals, leaving only candles with a pronounced long shadow.

**Advisor settings:**

* **Position volume** - Position volume;
* **Slippage (in points)** - maximum allowable price deviation during execution, set in points;
* **Magic number** -**magic number**;
* **Stop loss (in points), 0 - none, -1 - by PinBar shadow** - Stop loss (in points), 0 - none, -1 - by PinBar shadow price;
* Take profit (**in points), 0** - none - Take profit (in points), 0 - none;
* **Stop loss deviation (in points)** - Stop loss**deviation** from the Pin Bar shadow in points.

**Trails settings:**

* **Trailing type** - Trailing type
* Trailing**start** - Profit in points for trailing start
* Trailing**step in points** - Trailing step in points of price
* **Trailing offset in points - Trailing offset from price in points**

**Settings of indicators used in trails:**  

* **Indicator's timeframe** - Timeframe of the indicator used in trawl calculation.
* **MA** Period - Moving Average Calculation Period
* **MA Shift** - Horizontal shift of the moving average.
* **AMA Fast** EMA Period - Period of calculation of fast EMA adaptive moving average.
* **AMA Slow** EMA Period - Period of calculation of slow EMA of adaptive moving average
* **VIDYA CMO** Period - CMO period of moving average with dynamic averaging period.
* Parabolic**SAR Step** - Parabolic SAR Step
* Parabolic SAR**Max** - Maximum of Parabolic SAR
* **MA Applied Price** - Price for moving average calculation
* **MA Smoothing Method** - Type of moving average smoothing.
* **Indicator data index** - Bar of data received from the indicator

The [iPinBars indicator](/en/code/63672) and the [library of trailing classes](/en/code/63926) are required for the Expert Advisor to work.

An example of the work of the Expert Advisor for the last year on EURUSD H4 with fixed stop levels and using a simple trawl:

![](https://c.mql5.com/18/168/terminal64_IzQDGpQwPT.gif)

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/63971](/ru/code/63971)

![Simple Expert Advisor based on WPR, Bollinger Bands and ATR indicators](https://c.mql5.com/i/code/expert.png)
[Simple Expert Advisor based on WPR, Bollinger Bands and ATR indicators](/en/code/63916)

A simple strategy based on the signals of two indicators: Williams' Percent Range (WPR) and Bollinger Bands (BB). A position is opened only when the signals of both indicators coincide.

![Bollinger Bands Squeeze](https://c.mql5.com/i/code/indicator.png)
[Bollinger Bands Squeeze](/en/code/65117)

It signals a period of low market volatility that is about to end, foreshadowing a significant price move.

![ATR without iATR() with smoothing Wilder by William210.mq5](https://c.mql5.com/i/code/indicator.png)
[ATR without iATR() with smoothing Wilder by William210.mq5](/en/code/50547)

The goal is to show a code that shows the calculation of the ATR with Wilder smoothing

![Wave Weis Bar Force](https://c.mql5.com/i/code/indicator.png)
[Wave Weis Bar Force](/en/code/64084)

WaveWeisBarForce is a custom indicator based on Weis Waves logic. It accumulates volume into directional waves (bullish or bearish) and displays them as histograms with intensity levels. Bullish waves: 4 levels of green, from light to Lime. Bearish waves: 4 levels of red, from light to Red. WaveMax (white): shows the bar with the highest volume inside each wave. WaveClimax (yellow): highlights record accumulated volume across waves. This indicator helps traders visualise market pressure by volume accumulation and wave intensity, improving intraday and swing analysis.