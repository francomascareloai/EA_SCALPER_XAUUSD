# RBF Neural Network Class - library for MetaTrader 5

Source: https://www.mql5.com/en/code/1267

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/1267) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Libraries](https://c.mql5.com/i/code/library.png)

# RBF Neural Network Class - library for MetaTrader 5

[Yury Kulikov](/en/users/yurich)  |
[English](javascript:void(false);)

[Русский](/ru/code/1267) [中文](/zh/code/1267) [Español](/es/code/1267) [Deutsch](/de/code/1267) [日本語](/ja/code/1267) [Português](/pt/code/1267)

Views:
:   8000

Rating:
:   (46)

Published:
:   19 December 2012, 13:06
:   [class\_netrbf.mqh](/en/code/download/1267/class_netrbf.mqh "class_netrbf.mqh")
    (22.75 KB)
    [view](# "view")

    [test\_rbfn\_xor.mq5](/en/code/download/1267/test_rbfn_xor.mq5 "test_rbfn_xor.mq5")
    (2.48 KB)
    [view](# "view")

    [test\_rbfn\_mul\_add.mq5](/en/code/download/1267/test_rbfn_mul_add.mq5 "test_rbfn_mul_add.mq5")
    (2.14 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/1267.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Class implements neural network of radial basis functions (Radial Basis Function Network - RBFN).

Here is represented the classic realization of RBFN consisted of two layers of neurons: hidden layer neurons with radially symmetric activation function and exit layer of linear and sigmoid activation function.

Activation function of the output layer is automatically selected for training the network depending on the test output data. For the range of -1 to 1 the hyperbolic tangent applies, to the range 0 .. 1 sigmoid applies. If the test output data is beyond the range -1 .. 1, the activation function is not used.

Creation of the network is declared to be the class parametric constructor.

```mql5
CNetRBF * net =new CNetRBF (the size of the input vector, the maximum number of neurons in the hidden layer, the size of the output vector);
```

When creating a network the maximum number of neurons in the hidden layer is set which can be used by the network. The actual number of neurons required is determined by learning network.

Learning network is provided by calling the Learn method (the number of learning patterns, input data array, output data array, the number of learning cycles, the maximum learning error).

Input and output learning data are located in one-dimensional arrays vector by vector. The learning process is limited either by the number of learning epochs or admissible error.

The Learn method returns the following values:

      0 - complete network learning and learning result can be checked through the class variables: mse – learning error, epoch – number of accomplished learning cycles and neurons - number of neurons in the hidden layer;  
     -3 - not enough neurons in the hidden layer;  

     -4 - not enough memory.

The Calculate method (input vector array, network response array) is used for getting the network response.

Save (open file handle with FILE\_WRITE and FILE\_BIN flags) and Load (open file handle with FILE\_READ and FILE\_BIN flags) methods are intended for saving the network to a file and loading the network from the file respectively. Network topology, learning errors and array weights are saved to the file. If parameters of the loaded network topology differ from the parameters of the established network topology, the network will not be loaded and the Load method will return false.

Using of the class is shown in the attached specimens:Test\_RBFN\_XOR - learning network function "excluding OR", Test\_RBFN\_MUL\_ADD - learning network to multiplication and adding integers. It is implied that class and example files are placed in one folder.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/1267](/ru/code/1267)

**[Go to discussion](/en/forum/9519)**

![LeManChanel](https://c.mql5.com/i/code/indicator.png)
[LeManChanel](/en/code/1264)

The indicator displays the possible boundaries and direction of the bar looking forward to one bar

![LeManSystem](https://c.mql5.com/i/code/indicator.png)
[LeManSystem](/en/code/1263)

The system using the internal channel from High to Low

![OsHMA](https://c.mql5.com/i/code/indicator.png)
[OsHMA](/en/code/1265)

The OsHMA oscillator is the indicator of the difference between two HMA (between two Hull Moving Averages).

![PriceChanel_HTF](https://c.mql5.com/i/code/indicator.png)
[PriceChanel\_HTF](/en/code/1266)

The Price Channel indicator. It draws the line of high and low price values for the last N bars from high timeframe