# Close_on_PROFIT_or_LOSS_inAccont_Currency - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/48818

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/48818) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Close\_on\_PROFIT\_or\_LOSS\_inAccont\_Currency - expert for MetaTrader 4

[Deleted]

Views:
:   7323

Rating:
:   (3)

Published:
:   24 March 2024, 18:17

Updated:
:   7 April 2024, 20:20
:   [Close\_on\_PROFIT\_or\_LOSS\_inAccont\_Currency.mq4](/en/code/download/48818/close_on_profit_or_loss_inaccont_currency.mq4 "Close_on_PROFIT_or_LOSS_inAccont_Currency.mq4")
    (5.31 KB)
    [view](# "view")

    [Close\_on\_PROFIT\_or\_LOSS\_inAccont\_Currency\_V2.mq4](/en/code/download/48818/close_on_profit_or_loss_inaccont_currency_v2.mq4 "Close_on_PROFIT_or_LOSS_inAccont_Currency_V2.mq4")
    (14.42 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/48818.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

//+------------------------------------------------------------------------------------------------------------------------------+

//|Close\_on\_PROFIT\_or\_LOSS\_inAccont\_Currency\_V2 optimization: what's new:

//|

//|1. Added Error Handling: The code includes error handling to deal with situations where orders cannot be closed or deleted.

//|2. Code Optimization: The code is optimized to avoid repetition and improve readability.

//|3. Efficiency: Removed unnecessary loops or computations.

//|4. Clear all chart objects upon EA deinitialization

//+------------------------------------------------------------------------------------------------------------------------------+

![](https://c.mql5.com/18/154/Screenshot_2024-03-29_184037.png)

At 0 set EA will do nothing.

Positive\_Closure\_in\_Account\_Currency must be higher than the current Equity amount, otherwise, the trades will be executed immediately.

Example: Equity is 55000$ and Positive\_Closure\_in\_Account\_Currency set to 55500$ to gain 500$

Positive\_Closure\_in\_Account\_Currency  > O && <  55000$ = immediate execution

Negative\_Closure\_in\_Account\_Currency must be lower than the current Equity amount, otherwise, the trades will be executed immediately.

Example: Equity is 55000$ and Negative\_Closure\_in\_Account\_Currency set to 54500$ to loose only 500$

Negative\_Closure\_in\_Account\_Currency  >55000$ = immediate execution

Spread spikes can be avoided by reducing the spread number but the market will do what it wants and higher gains or losses can occure.

Also if the spread is set lower than the average spread for the pairs traded those positions will not be executed.

WARNING: Use this software at your own risk. The Forex market is very volatile!

#property copyright     "Copyright 2024, MetaQuotes Ltd."

#property link          "https://www.mql5.com"

#property version       "1.01"

#property description   "persinaru@gmail.com"

#property description   "IP 2024 - free open source"

#property description   "This EA closes all trades on Profit and Losses calculated in Account Currency."

#property description   ""

#property description   "WARNING: Use this software at your own risk."

#property description   "The creator of this script cannot be held responsible for any damage or loss."

#property description   ""

#property strict

#property show\_inputs

extern string  Closures = "EA closes all trades and pending orders when a profit or loss is reached. Profit and Losses are calculated in Account Currency.";

extern int Positive\_Closure\_in\_Account\_Currency     = 0;

extern int Negative\_Closure\_in\_Account\_Currency     = 0;

extern int Spread = 10;

**[Go to discussion](/en/forum/464554)**

![Hedge_Dollar_Index_Against_Forex_Pairs_V1](https://c.mql5.com/i/code/script.png)
[Hedge\_Dollar\_Index\_Against\_Forex\_Pairs\_V1](/en/code/48817)

Hedge Dollar index USIDX against its constitutive FOREX pairs EURUSD GBPUSD USDJPY USDCAD USDSEK USDCHF

![Error_Break_Script_V2  - This script is a general example of using error brake in any strategy - Break on Code Error Sample Strategy](https://c.mql5.com/i/code/script.png)
[Error\_Break\_Script\_V2 - This script is a general example of using error brake in any strategy - Break on Code Error Sample Strategy](/en/code/48803)

Break on Code Error !
This script is a general example of using error brake in any strategy.

![Correlation Gaps Trading AUDJPY CADJPY NZDJPY](https://c.mql5.com/i/code/script.png)
[Correlation Gaps Trading AUDJPY CADJPY NZDJPY](/en/code/48848)

Short description.

![Multiple Buys and Sells ORDERS based on a currency pair strength.](https://c.mql5.com/i/code/script.png)
[Multiple Buys and Sells ORDERS based on a currency pair strength.](/en/code/48879)

Short description.