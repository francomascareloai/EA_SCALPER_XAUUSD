# Collect Data (Date, Time and Close Price) - script for MetaTrader 5

Source: https://www.mql5.com/en/code/56064

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/56064) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# Collect Data (Date, Time and Close Price) - script for MetaTrader 5

[samuk1000](/en/users/samuk1000)  |
[English](javascript:void(false);)

[Русский](/ru/code/56064) [中文](/zh/code/56064) [Español](/es/code/56064) [Deutsch](/de/code/56064) [日本語](/ja/code/56064) [Português](/pt/code/56064) [한국어](/ko/code/56064) [Français](/fr/code/56064) [Italiano](/it/code/56064) [Türkçe](/tr/code/56064)

Views:
:   3591

Rating:
:   (3)

Published:
:   15 February 2025, 20:08

Updated:
:   19 February 2025, 09:51
:   [GrabCloses.mq5](/en/code/download/56064/grabcloses.mq5 "GrabCloses.mq5")
    (3.9 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/56064.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

As you can see this is a short script used to collect close price and place it in a column after a date string and a time (hour and minute) string.

The data is saved to a comma separated values (CSV) file in the MQL5/Files folder by default, for outside use as needed.

There are no frills, bells or whistles on this and I am not yet familiar enough to know whether it would be better (or if it is possible) to use CopyTime and CopyRates built-in functions rather than the iClose and iTime functions.

There are more than one ways to skin a cat as they say.

**[Go to discussion](/en/forum/481509)**

![Print massive information (PrintXYZ) from the terminal](https://c.mql5.com/i/code/library.png)
[Print massive information (PrintXYZ) from the terminal](/en/code/56055)

PrintXYZ() library to print massive information from the terminal.

![A 3 line script that tells you how many bars are on your chart](https://c.mql5.com/i/code/script.png)
[A 3 line script that tells you how many bars are on your chart](/en/code/55976)

A script which when dragged onto the chart will print out in the experts window the number of bars that are on that chart - like magic.

![Self Optimized SMA](https://c.mql5.com/i/code/indicator.png)
[Self Optimized SMA](/en/code/56289)

The indicator plots two lines. The lower line is calculated based on the latest SMA period that caused a bounce up. The upper line is calculated based on the latest SMA period that caused a bounce down.

![Useful #define statements](https://c.mql5.com/i/code/script.png)
[Useful #define statements](/en/code/56149)

These are some #define statements that are useful to perform operations in your EA. You only need to assign the name of your variables at the beginning of the file, and then let the other #define statements do the work.
In order to use this file, add #include <DEFINE\_statements.mqh> to the first line in your EA file.