# Spazm - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/8683

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/8683) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Spazm - expert for MetaTrader 4

[Евгений](/en/users/space_cowboy)  |
[English](javascript:void(false);)

[Русский](/ru/code/8683)

Views:
:   14985

Rating:
:   (10)

Published:
:   1 July 2016, 11:11
:   [Spazm.mq4](/en/code/download/8683/Spazm.mq4 "Spazm.mq4")
    (5.23 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/8683.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

```mql5
extern double k=5.0;// multiplier for opening a trade relative to the current volatility, i.e. movement_for_opening=volatility_over_period*k
extern int period=24;// period to calculate the volatility in bars
extern int exp=0;// volatility smoothing mode, 0-simple moving average, 1-linearly weighted
extern int open.close=0;// mode of volatility calculation by 1-open/close, 0-High/Low
extern double SL_pp=0;// set stop loss as a percentage of the movement that took place (from 0 to 1, 0-stop loss is not set at all)
extern bool visualize=true; // plot movements
```

Large drawdowns, suggestions on improvements are welcome

**Strategy Tester Report**

**Spazm**

**TeleTrade-Server (Build 220)**

  

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
| Symbol | | EURUSD (Euro vs US Dollar) | | | |
| Period | | 1 Hour (H1) 2008.01.02 10:00 - 2009.01.16 17:00 (2008.01.01 - 2010.01.01) | | | |
| Model | | Every tick (the most accurate mode based on the shortest available time frames) | | | |
| Parameters | | k=6; period=24; exp=0; open.close=0; SL\_pp=0; visualize=false; | | | |
|  | |
| Bars in test | 7413 | Ticks modelled | 3693207 | Modelling quality | 90.00% |
| Mismatched chart errors | 15 |  |  |  |  |
|  | | | | | |
| Initial deposit | 1000000.00 |  |  |  |  |
| Net profit | 35223.60 | Gross profit | 89637.40 | Gross loss | -54413.80 |
| Profit factor | 1.65 | Expected payoff | 451.58 |  |  |
| Absolute drawdown | 2399.60 | Maximum drawdown | 19886.20 (1.93%) | Relative drawdown | 1.93% (19886.20) |
|  | | | | | |
| Total trades | 78 | Short positions (won %) | 39 (53.85%) | Long positions (won %) | 39 (43.59%) |
|  | | Profit trades (% of total) | 38 (48.72%) | Loss Trades (% of total) | 40 (51.28%) |
| Largest | | profit trade | 14433.60 | loss trade | -3496.80 |
| Average | | profit trade | 2358.88 | loss trade | -1360.34 |
| Maximum | | consecutive wins (profit in money) | 6 (24475.80) | consecutive losses (loss in money) | 8 (-10623.20) |
| Maximal | | consecutive profit (count of wins) | 24475.80 (6) | consecutive loss (count) | -10623.20 (8) |
| Average | | consecutive wins | 2 | consecutive losses | 2 |

[![](https://c.mql5.com/18/19/StrategyTester_2_small.gif)](https://c.mql5.com/18/19/StrategyTester_2.gif)

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/8683](/ru/code/8683)

**Last comments |
[Go to discussion](/en/forum/90355)**
(1)

![Jodie Hank](https://c.mql5.com/avatar/2012/11/50962019-D8A4.jpg "Jodie Hank")

**[Jodie Hank](/en/users/jhp2025)**
|
18 Aug 2018 at 12:15

Hi Space-Cowboy, great idea ant thanks gotta a chance to try it! Is it possible to add break-even profit and or trailing stops on it please, since, perhaps I'm wrong, we've wasted too many points as profits, what do you think?

![The Cronex T Demarker GFC (Color) indicator](https://c.mql5.com/i/code/indicator.png)
[The Cronex T Demarker GFC (Color) indicator](/en/code/8682)

Modification of the DeMarker indicator with additional color indication based on the histogram

![2pbIdealMA](https://c.mql5.com/i/code/indicator.png)
[2pbIdealMA](/en/code/8681)

Moving average

![Grid](https://c.mql5.com/i/code/indicator.png)
[Grid](/en/code/8684)

Alternative grid

![Ma_Parabolic_st2](https://c.mql5.com/i/code/indicator.png)
[Ma\_Parabolic\_st2](/en/code/8686)

Parabolic plotted based on Lows and Highs of a moving average. Efficiently displays the trends on smaller timeframes, and allows to mostly eliminate frequent switches, inherent to the "Parabolic SAR" indicator.