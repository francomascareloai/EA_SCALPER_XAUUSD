# Simple candle filter martingale EA - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/26220

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/26220) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Simple candle filter martingale EA - expert for MetaTrader 4

[Brian Rumbles](/en/users/ea_research_development)

Views:
:   18544

Rating:
:   (9)

Published:
:   30 July 2019, 21:10

Updated:
:   24 September 2019, 10:54
:   [Buy Now+Candle filter.mq4](/en/code/download/26220/buy_now7candle_filter.mq4 "Buy Now+Candle filter.mq4")
    (295.99 KB)
    [view](# "view")

    [Bull and Bear candle martingale EA.mq4](/en/code/download/26220/bull_and_bear_candle_martingale_ea.mq4 "Bull and Bear candle martingale EA.mq4")
    (323.3 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/26220.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

This EA uses a candle size filter to initiate a trade.

Attribution: Ideas are mine, code is compiled using fxdreema.

Concept

If the Candle size is > x pips, then the EA will enter into a buy trade.

The candle size is an input in the EA settings.

If the buy trade results in a loss, The EA will enter into the next trade at a scaled up lot size.

The scale factor is adjustable in the EA settings.

Main principle of the concept

The main principle behind all EAs that I design is to control the number of consecutive losses (Rather than to predict where the price is moving
next).

This control is accomplished by increasing the Candle size required in the settings until a sufficiently low (safe) amount of consecutive
losses occur over a long test period.  (The reason for controlling the consecutive losses is so that we can safely use the martingale
strategy).

Settings

I use USDJPY and 4hr chart for testing. Other timeframes will work too.

I usually set the settings for candle size to be 20 or more , preferably 30.

10 or less will usually not work.

TP and SL

The TP and SL I use are normally a ratio of 1:1

and the settings are 50 TP and 50 SL

Settings of 75TP 50SL; 100TP 50SL, work if you use a lower scale factor such as 1.5.

This is because when the Ratio of TP to SL changes, the probability of winning to losing on average changes, and so do the number of consecutive
losses (important).

I find as a rule of thumb that the max consec losses is usually 6 times the average losses, and that average losses in a similar ratio of TP:SL
ratio (the same or a multiple of the TP:SL ratio or a less favourable ratio).

EXample a TP:SL of 50pips:50pips gives average wins to losses of 2:2 or worse 2:3 due to spread

And max consec losses of example 2x6=12. (We aim to lower these to less than 8, perhaps 6 would be good- using the candle filter)

Feedback is welcome. We can develop more advanced ideas to control consecutive losses and unleash the power of martingale in a random market
environment.

**Last comments |
[Go to discussion](/en/forum/318987)**
(4)

![Hafiz Muhammad Rizwan](https://c.mql5.com/avatar/2017/9/59B69512-AE3F.jpg "Hafiz Muhammad Rizwan")

**[Hafiz Muhammad Rizwan](/en/users/rizwan37007)**
|
31 Aug 2019 at 12:25

Thanks for your EA,  
I have one suggestion Sir,  
Is it possible to work on both Side?  
When there is bullish candle more
than given candle range it works bullish ( Buy ) and if candle is Bearish then it can open Sell .
  
Really grateful if you could add this in this EA.

![animalhandler](https://c.mql5.com/avatar/avatar_na2.png "animalhandler")

**[animalhandler](/en/users/animalhandler)**
|
7 Oct 2020 at 15:51

I am so sad. I finally find an EA that makes sense to me and does not rely on lagging wiggly indicators. My problem is my dealer uses a suffix on the pair symbol and I think that is why this EA does not trade in my environment.

If the coder has time it would be really a nice thing for me if there could be an update.

Mb

![SedeVacante Gracias](https://c.mql5.com/avatar/2021/9/6144DB00-ACBD.png "SedeVacante Gracias")

**[SedeVacante Gracias](/en/users/sedevacante)**
|
17 May 2022 at 23:25

**animalhandler [#](/en/forum/318987#comment_18636326):**  

I am so sad. I finally find an EA that makes sense to me and does not rely on lagging wiggly indicators. My problem is my dealer uses a suffix on the pair symbol and I think that is why this EA does not trade in my environment.

If the coder has time it would be really a nice thing for me if there could be an update.

Mb

What does you need about changes for this EA?  
maybe I could handle it...

![Maksim Grishko](https://c.mql5.com/avatar/2024/10/66ff5e38-339c.jpg "Maksim Grishko")

**[Maksim Grishko](/en/users/currencyea)**
|
3 Oct 2022 at 12:14

Hello! Nice idea! Add the calculation of TP and SL by ATR ... for better ratio .. thanks

![dTrends](https://c.mql5.com/i/code/indicator.png)
[dTrends](/en/code/26216)

Arrow trends by iBearsPower and iBullsPower indicator for MT4.

![Price Time Correlation Trading Model](https://c.mql5.com/i/code/expert.png)
[Price Time Correlation Trading Model](/en/code/26189)

A Price Time correlation model is used for Trend and Reversal trading

![Automatically enable or disable the automated trading button](https://c.mql5.com/i/code/expert.png)
[Automatically enable or disable the automated trading button](/en/code/26270)

Let say you have an EA and you want it to trade in between an interval of time but you do not have the source codes to modify the EA.
This utility allows you to automatically enable or disable the automated trading button. You can use the codes as an EA, Indicator or script but I used as an EA.
You can remove Ordersend command because I set it only for the codes to past the test but it is meaningless.

![Evenly weighted DXY and changeable base currency](https://c.mql5.com/i/code/indicator.png)
[Evenly weighted DXY and changeable base currency](/en/code/26287)

Currency Index that calculates evenly on all 7 major pairs. Can also change base currency. Based on No Nonsense Forex podcast.