# Doubles comparer - library for MetaTrader 5

Source: https://www.mql5.com/en/code/29615

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/29615) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Libraries](https://c.mql5.com/i/code/library.png)

# Doubles comparer - library for MetaTrader 5

[DMITRII PECHERITSA](/en/users/dmipec)

Views:
:   3656

Rating:
:   (9)

Published:
:   10 June 2020, 12:54

Updated:
:   13 June 2020, 12:55
:   [FloatingPoint.mq5](/en/code/download/29615/floatingpoint.mq5 "FloatingPoint.mq5")
    (1.05 KB)
    [view](# "view")

    [FloatingPoint.mqh](/en/code/download/29615/floatingpoint.mqh "FloatingPoint.mqh")
    (1.14 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/29615.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

A tiny class to compare floating point variables the right way with desired precision.

```mql5
template<typename T>class FloatingPoint
  {
public:
                     FloatingPoint() {Precision(sizeof(T));}
   int               Compare(const T x, const T y) {return (((fabs(x-y)<min))?0:((x-y>=min))?1:-1);}
   void              Precision(int digits) {min=pow(10,-fabs(digits));}
protected:
   double            min;
  };
```

Let's say you have two doubles with a value of 1.15.

When you compare them, you expect them to be equal.

But doubles in computer behave the strange way.

1.15 may be stored as 1.14999999999.

So comparing will fail your expectations.

The proper way to compare floating point variables, is by checking their subtraction with some minimum value.

FlatingPoint must be initialized with double or float datatype.

Comparer method returns 0 if x = y; 1 if x > y; and -1 if x < y.

Precision can be changed.

Deafult precision is 8 digits after fp for doubles, and 4 for floats.

Example of FloatingPoint class usage.

```mql5
void OnStart()
  {
   FloatingPoint<double>fp;
   double a=1.15,b=1.14999999999;
   for(int i=15; i>5; i--)
     {
      fp.Precision(i);
      int compare=fp.Compare(a,b);
      string res=(compare==0)?"=":(compare==1)?">":"<";
      PrintFormat("%g %s %g at %d digit precision",a,res,b,i);
     }
  }
```

Output:

```mql5
/**
   you do not expect this:
      1.15 > 1.15 at 15 digit precision
      1.15 > 1.15 at 14 digit precision
      1.15 > 1.15 at 13 digit precision
      1.15 > 1.15 at 12 digit precision
      1.15 > 1.15 at 11 digit precision
   
   you expect this:
      1.15 = 1.15 at 10 digit precision
      1.15 = 1.15 at 9 digit precision
      1.15 = 1.15 at 8 digit precision
      1.15 = 1.15 at 7 digit precision
      1.15 = 1.15 at 6 digit precision
/**/
```

**[Go to discussion](/en/forum/343621)**

![WaveMTF MT5](https://c.mql5.com/i/code/indicator.png)
[WaveMTF MT5](/en/code/29614)

Indicator WaveMTF Bull and Bear System with Signal and Alert for MetaTrader 5 with options to display signal on the chart.

![Basket Closer Profit/Loss](https://c.mql5.com/i/code/expert.png)
[Basket Closer Profit/Loss](/en/code/29607)

Basket Closer Type EA.

![Arrays class](https://c.mql5.com/i/code/library.png)
[Arrays class](/en/code/29630)

Frequent array operation methods.

![Bar Time Count Down](https://c.mql5.com/i/code/indicator.png)
[Bar Time Count Down](/en/code/29647)

This MT5 indicator is to count down the remaining time of the current bar as the format HH:MM:SS