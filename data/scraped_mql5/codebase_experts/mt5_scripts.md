# MQL5 Source Codes of Scripts for MetaTrader 5

Source: https://www.mql5.com/en/code/mt5/scripts

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Access the CodeBase from your [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

Couldn't find the right code? Order it in the [Freelance](https://www.mql5.com/en/job) section

[How to Write](https://www.mql5.com/en/articles/100) an Expert Advisor or an Indicator

# MQL5 Source Codes of Scripts for MetaTrader 5

![icon](https://c.mql5.com/i/code/code-icon.png)

Scripts perform one-time actions in MetaTrader 5 using an MQL5 program and are deleted from the chart immediately afterwards. Sample functions include uploading trading history, generating a report and sending it by email, downloading and processing data from a file. Scripts can also be used to create graphical interface or quickly execute single-type trading operations, for example, close all positions immediately.

You can download and launch offered scripts in MetaTrader 5. The library of scripts is also available directly from MetaEditor development environment allowing you to learn MQL5 programming.

[Submit your code](/en/code/new)

![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

You are missing trading opportunities:

* Free trading apps
* Over 8,000 signals for copying
* Economic news for exploring financial markets

Registration
Log in

latin characters without spaces

a password will be sent to this email

An error occurred

* [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

Allow the use of cookies to log in to the MQL5.com website.

Please enable the necessary setting in your browser, otherwise you will not be able to log in.

 

[Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

* [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)

[1](/en/code/mt5/scripts)[2](/en/code/mt5/scripts/page2)[3](/en/code/mt5/scripts/page3)[4](/en/code/mt5/scripts/page4)[5](/en/code/mt5/scripts/page5)[6](/en/code/mt5/scripts/page6)[7](/en/code/mt5/scripts/page7)[8](/en/code/mt5/scripts/page8)

latest |

[best](/en/code/mt5/scripts/best)

[Positions Summary Info byPairs](/en/code/48663 "Positions Summary Info byPairs")

Script for displaying updating data on open positions.

[Script with example functions for creating graphical objects](/en/code/65311 "Script with example functions for creating graphical objects")

The script provides a set of functions for creating all standard graphical objects for use in your own developments. The functions presented in the script can be used "as is" or modified to your requirements.

[Report by Magic and currency MT5 indicator for account PNL and trade statistics exported to CSV](/en/code/66158 "Report by Magic and currency MT5 indicator for account PNL and trade statistics exported to CSV")

Exports comprehensive trading statistics to a CSV file.

[Candlestick Analysis Report](/en/code/49150 "Candlestick Analysis Report")

This script helps traders understand the distribution and breadth of candlesticks over a specific period, which can be useful in making trading decisions such as which Take Profit or Stop Loss to use based on historical values.

[Clean Market Watch - Removes All Symbols In the Market Watch Windows In One Go](/en/code/65997 "Clean Market Watch -  Removes All Symbols In the Market Watch Windows In One Go")

The Clean Market Watch script is a simple utility tool designed to quickly remove all symbols from your MetaTrader 5 Market Watch window with a single click. This is particularly useful when you want to start fresh with a clean workspace or when your Market Watch has become cluttered with too many symbols.
Purpose
Over time, traders often accumulate numerous symbols in their Market Watch window, making it difficult to focus on the instruments they actively trade. Manually removing symbols one by one can be tedious and time-consuming. This script automates the entire process, clearing all symbols in seconds.

[Simple Bar Timer](/en/code/65666 "Simple Bar Timer")

It is a script to display the time remaining until next bar arrives.

[Delete Trading History](/en/code/63519 "Delete Trading History")

The script removes all autotrading icons from the current chart

[Trading Session Mapping](/en/code/64546 "Trading Session Mapping")

A tool to align the trading sessions names with broker server time, and local time

[A script for a tester that extends the standard MetaTrader 5 optimisation features](/en/code/63121 "A script for a tester that extends the standard MetaTrader 5 optimisation features")

This is a tester script that extends the standard MetaTrader 5 optimisation capabilities, allowing you to evaluate strategies according to complex user-defined criteria (with separation into in-sample and out-of-sample periods, advanced metrics and statistical tests).

[3 way Aroon value calculation](/en/code/64175 "3 way Aroon value calculation")

Showing different ways of the Aroon values calculation

[Simplest CSV file writer](/en/code/63261 "Simplest CSV file writer")

Provide simplest class to write CSV file

[Similarity Based Market Watch Symbol Mapping Script](/en/code/54553 "Similarity Based Market Watch Symbol Mapping Script")

This script is a reference solution for mapping symbol names configured by users in MetaTrader 5 EAs or scripts to the actual names provided by the broker.
It uses the Levenshtein distance algorithm to automatically identify the most similar symbol in Market Watch.
Ideal for developers facing compatibility issues with prefixes or suffixes in symbol names.
It is a customisable starting point to suit any specific need.

[Ascending Sort A Struct Array By A Field Example](/en/code/62366 "Ascending Sort A Struct Array By A Field Example")

This is an example of ascending sort a struct list by a field. You can find out and customize the above algorithm depending on the purpose of use, this is the most basic example is also a direction to resolve the arrangement in an array of structure.
The algorithm used in this example is Quick Sort and Merge Sort.

[Checking the time change on the server due to daylight saving time transition](/en/code/55087 "Checking the time change on the server due to daylight saving time transition")

Unfortunately, I found that some brokers Changing the time on the server is a bit incorrect, which I didn't expect. and which surprised me a lot. Here is a script that anyone can use to check their broker.

[Checking the server time changes due to the summer time changeover](/en/code/55086 "Checking the server time changes due to the summer time changeover")

Unfortunately I had to realise that some brokers are a bit careless with the server time changeover, which I had not expected and which surprised me a lot. Here is a script with which everyone can check their broker.

[Creat Button Close BuySell On Chart](/en/code/61708 "Creat Button Close BuySell On Chart")

MQL5 script for MetaTrader 5 that adds two buttons to close all buy or sell positions for the current symbol.

[LotSize Calculation](/en/code/61684 "LotSize Calculation")

This is a simple script file to compute lot size either using risk percentage approach or the actual amount to risk.

[Quick Chart Setter: Instant Color Themes for MT5 Traders](/en/code/61452 "Quick Chart Setter: Instant Color Themes for MT5 Traders")

A quick little script to make traders' lives easier. The one thing that always annoys me is resetting the properties like colors for a new chart, to make it look the way i like it. So Here is a script to make things smoother.

[Check And Delete Chart Object Script](/en/code/60281 "Check And Delete Chart Object Script")

Script

[TradeReportExporter](/en/code/56662 "TradeReportExporter")

The TradeReportExporter script is designed to export the history of trades (trades) into a convenient CSV file. It automatically collects data on all trades for the last year for the instrument it is installed on. The file includes such data as date and time, transaction type (buy/sell), price, volume, commission and profit/loss. The result is saved in a file that can be opened in Excel or any other spreadsheet editor.

[Partial close Sell Orders](/en/code/60233 "Partial close Sell Orders")

Partially close active sell orders

[Partial Close Buy Orders](/en/code/60232 "Partial Close Buy Orders")

Script for partially close active buy orders

[Population-based optimisation algorithms](/en/code/49355 "Population-based optimisation algorithms")

Population-based optimisation algorithms are collected here. The archive contains all necessary files to run the algorithms on test functions.

[Function for checking whether the market is open for trading at the moment by the current symbol](/en/code/57948 "Function for checking whether the market is open for trading at the moment by the current symbol")

The function can be useful to not overload the server with trade requests at times when the market is closed for trading

[Auto SL TP by Risk Reward Ratio](/en/code/59610 "Auto SL TP by Risk Reward Ratio")

The Auto SL TP by Risk Reward Ratio script is a simple yet powerful tool designed for MetaTrader 5 traders who want to streamline their risk management process. This script automates the process of setting Stop Loss (SL) and Take Profit (TP) levels for open positions based on a user-defined Risk:Reward ratio and Stop Loss in pips. Whether you're a beginner or an experienced trader, this script saves time and ensures consistent risk management.

[Function for converting the number of seconds to years, months, days, hours, minutes, seconds](/en/code/58198 "Function for converting the number of seconds to years, months, days, hours, minutes, seconds")

It is taken into account that there are 30 days in a month, 365 days in a year The script demonstrates the counter of time until the beginning of the new year

[Creating a Simple News Filter for XAUUSD Trading on MT5](/en/code/59130 "Creating a Simple News Filter for XAUUSD Trading on MT5")

Trading XAUUSD (Gold) is often influenced by major economic news events like USD, GBP, or EUR releases. To mitigate risks during these volatile periods, using a News Filter in your Expert Advisor (EA) is essential. In this article, I’ll share how to create a simple News Filter on MT5 and apply it to XAUUSD trading.

[Stoch Cross EA – Buy Below 20, Sell Above 80 (H1)](/en/code/58942 "Stoch Cross EA – Buy Below 20, Sell Above 80 (H1)")

A simple and effective Expert Advisor based on Stochastic Oscillator reversal signals on the H1 timeframe.
Buy signals are triggered when %K crosses above %D below the 20 level.
Sell signals are triggered when %K crosses below %D above the 80 level.
Risk is calculated based on the account balance, with the lot size set to 0.1 (adjustable as needed).
Take Profit (TP) is set to 300 points for all positions.
Stop Loss (SL) is dynamically calculated based on the opposite crossover signal. The position is closed when a crossover in the opposite direction occurs, as well as when TP or SL is reached

[Panel for Calculating History Profit](/en/code/52528 "Panel for Calculating History Profit")

This CalculateHistoryProfit script version 1.0 is designed to calculate profit for a specified period using a chart panel.

[Candle Signature](/en/code/58219 "Candle Signature")

Candle Signature with Example | For Research and Development

[Useful #define statements](/en/code/56149 "Useful #define statements")

These are some #define statements that are useful to perform operations in your EA. You only need to assign the name of your variables at the beginning of the file, and then let the other #define statements do the work.
In order to use this file, add #include <DEFINE\_statements.mqh> to the first line in your EA file.

[Collect Data (Date, Time and Close Price)](/en/code/56064 "Collect Data (Date, Time and Close Price)")

A simple starting-point script to collect data and send to a CSV in oldest-newest ordering. In this example only the close price data is collected.

[A 3 line script that tells you how many bars are on your chart](/en/code/55976 "A 3 line script that tells you how many bars are on your chart")

A script which when dragged onto the chart will print out in the experts window the number of bars that are on that chart - like magic.

[Checking the server time changes due to the daylight saving time (DST) changeover](/en/code/55056 "Checking the server time changes due to the daylight saving time (DST) changeover")

Unfortunately, I discovered that some brokers are a bit sloppy with the server time
change due to the daylight saving time (DST), which I did not expect and which surprised me a lot.
Here is a script with which anyone can check their broker.

[Strategy report output into a chart](/en/code/54706 "Strategy report output into a chart")

This script was developed for displaying saved Strategy report from the Strategy Tester into a chart.

[Script to Map Market Watch Symbols Based on Similarity](/en/code/54554 "Script to Map Market Watch Symbols Based on Similarity")

This script is a reference solution for mapping symbol names configured by users in MetaTrader 5 EAs or scripts to the actual names provided by the broker.
It uses the Levenshtein distance algorithm to automatically identify the most similar symbol in Market Watch.
It is ideal for developers facing compatibility issues with prefixes or suffixes in symbol names.
This is a customizable starting point to adapt to any specific needs.

[Get min margin in to csv](/en/code/53550 "Get min margin in to csv")

The script MinMargins.mq5 is designed to help traders quickly calculate and document the minimum amount of money required to open a position with the smallest lot size for all symbols available in the Market Watch. This data is saved to a CSV file for easy review and analysis.

[Economic Calendar CSV](/en/code/52977 "Economic Calendar CSV")

This script saves a predefined set of economic events from the MetaTrader's built-in economic calendar into CSV file.

[Script to extract Candlesticks data from all time frames to CSV.](/en/code/52766 "Script to extract Candlesticks data from all time frames to CSV.")

This MQL5 script exports candlestick data for various timeframes into a CSV file, capturing essential market information like open, high, low, and close prices. It analyzes each candlestick's characteristics, including body and wick sizes, while calculating additional metrics such as candle gaps. After processing the latest 21 bars, it notifies the user upon successful data export.

[TimeServerDaylightSavings](/en/code/52557 "TimeServerDaylightSavings")

Time-related functions for empirical detection of server time zone and daylight savings mode (DST) from history of quotes

[1](/en/code/mt5/scripts)[2](/en/code/mt5/scripts/page2)[3](/en/code/mt5/scripts/page3)[4](/en/code/mt5/scripts/page4)[5](/en/code/mt5/scripts/page5)[6](/en/code/mt5/scripts/page6)[7](/en/code/mt5/scripts/page7)[8](/en/code/mt5/scripts/page8)