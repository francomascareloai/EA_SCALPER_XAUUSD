# YURAZ_CreateCSV_HistoryFile_From_MT5_For_MT4 - script for MetaTrader 5

Source: https://www.mql5.com/en/code/232

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/232) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# YURAZ\_CreateCSV\_HistoryFile\_From\_MT5\_For\_MT4 - script for MetaTrader 5

YURAZ  |
[English](javascript:void(false);)

[Русский](/ru/code/232) [中文](/zh/code/232) [Español](/es/code/232) [Deutsch](/de/code/232) [日本語](/ja/code/232) [Português](/pt/code/232) [한국어](/ko/code/232) [Français](/fr/code/232) [Italiano](/it/code/232) [Türkçe](/tr/code/232)

Published by:
:   [Yuriy Zaytsev](/en/users/yuraz)

Views:
:   21069

Rating:
:   (46)

Published:
:   15 December 2010, 10:32

Updated:
:   22 November 2016, 07:32
:   [yuraz\_create\_history\_csv\_from\_mt5\_for\_mt4.mq5](/en/code/download/232/yuraz_create_history_csv_from_mt5_for_mt4.mq5 "yuraz_create_history_csv_from_mt5_for_mt4.mq5")
    (3.85 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/232.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

When I used the history quotes data from MetaTrader4 client terminal, I have found that some brokers doesn't have the full history.

The quality of the historical bar data is better, so I have decided to export the historical quotes from MetaTrader 5 and import them in MetaTrader 4.

This script will help you to get the full history for MetaTrader 4.

![Script for export historical data from MetaTrader 5 to MetaTrader 4](https://c.mql5.com/18/1/bigproblem2010__1.gif "Script for export historical data from MetaTrader 5 to MetaTrader 4")

The script creates .CSV file with historical bar data.

The steps:

* 1 - Install MetaTrader 5 client terminal [http://files.metaquo...t5/mt5setup.exe](https://download.mql5.com/cdn/web/metaquotes.software.corp/mt5/mt5setup.exe "Download MetaTrader 5")
* 2 - Enter the Main Menu->Tools->Options->Max bars in chart, and set MaxBars in chart depending on the historical bars needed:

![Script for export historical data from MetaTrader 5 to MetaTrader 4](https://c.mql5.com/18/1/p11.png "Script for export historical data from MetaTrader 5 to MetaTrader 4")

  

* 3 - Load this script and place it to MQL5\Scripts folder  
   in WINDOWS7/VISTA copy it to the Roaming folder instead of Program Files folder:  
   for example c:\Users\<administrator\AppData\Roaming\MetaQuotes\Terminal\D0E8209F77C8CF37AD8BF550E51FF075\MQL5\Scripts\  
    
  </administrator
* 4 - Compile the script and attach it to the charts for each MetaTrader 4 timeframes: M1 M5 M15 M30 H1 H4 D1 W1

![Script for export historical data from MetaTrader 5 to MetaTrader 4](https://c.mql5.com/18/1/p12.png "Script for export historical data from MetaTrader 5 to MetaTrader 4")

  

![Script for export historical data from MetaTrader 5 to MetaTrader 4](https://c.mql5.com/18/1/post-2895-0-28234000-1291872163_thumb.png "Script for export historical data from MetaTrader 5 to MetaTrader 4")

  

* 5 - Close MetaTrader 5;
* 6 - Open MetaTrader 4;
* 7 - Press F2;
* 8 - Choose currency pair;
* 9 - Select timeframe;

![Script for export historical data from MetaTrader 5 to MetaTrader 4](https://c.mql5.com/18/1/post-2895-0-08898900-1291872931_thumb.png "Script for export historical data from MetaTrader 5 to MetaTrader 4")

Let's consider how to dow it for M15 timeframe.  

* 10 - Select the file, created for M15 timeframe;
* 11 - Press the "Import" button:

![Script for export historical data from MetaTrader 5 to MetaTrader 4](https://c.mql5.com/18/1/post-2895-0-80251600-1291873521_thumb.png "Script for export historical data from MetaTrader 5 to MetaTrader 4")

* 12 - Repeat the step №10 for each pair. Repeat Step №11 for each timeframe of the pair:

![Script for export historical data from MetaTrader 5 to MetaTrader 4](https://c.mql5.com/18/1/post-2895-0-37996700-1291874418_thumb.png "Script for export historical data from MetaTrader 5 to MetaTrader 4")

LET'S CHECK IT!  
  
Before:  

![Script for export historical data from MetaTrader 5 to MetaTrader 4](https://c.mql5.com/18/1/post-2895-0-47263400-1291870736_thumb.gif "Script for export historical data from MetaTrader 5 to MetaTrader 4")

After:  

![Script for export historical data from MetaTrader 5 to MetaTrader 4](https://c.mql5.com/18/1/post-2895-0-99927800-1291873896_thumb.png "Script for export historical data from MetaTrader 5 to MetaTrader 4")

  

YURAZ

yzh@mail.ru

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/232](/ru/code/232)

**Last comments |
[Go to discussion](/en/forum/2766)**
(15)

![Andrey Khatimlianskii](https://c.mql5.com/avatar/2022/10/63528ae6-0b8c.jpg "Andrey Khatimlianskii")

**[Andrey Khatimlianskii](/en/users/komposter)**
|
25 Jan 2013 at 22:22

**VVK:**  

Thank you for your hard work.

I reinstalled the system, downloaded a new mt5 terminal and I can't convert quotes. Took down the new terminal, installed the old one from the archive, everything works until the first reload of the terminal. As soon as you reload the terminal everything, the script writes that it works and that's it.

In the last build there were improvements related to the maximum number of bars in the settings. Probably, this is the reason.

Try my script - [sHistoryExport - a convenient script for exporting historical data in MT4 format.](/en/code/1252)

![mrtk73](https://c.mql5.com/avatar/avatar_na2.png "mrtk73")

**[mrtk73](/en/users/mrtk73)**
|
26 Oct 2015 at 23:10

hi ...

help me, please.

what's the problem?

![](https://c.mql5.com/3/79/1__1.PNG)

![yunka52](https://c.mql5.com/avatar/avatar_na2.png "yunka52")

**[yunka52](/en/users/yunka52)**
|
4 May 2017 at 20:44

Bu kodu bir dakika içinde otomatik olarak çalıştırmak için ne yapmam gerekir?

![yunka52](https://c.mql5.com/avatar/avatar_na2.png "yunka52")

**[yunka52](/en/users/yunka52)**
|
4 May 2017 at 20:44

```mql5
What should i do to automatically run this code on a minute
```

![Yuriy Zaytsev](https://c.mql5.com/avatar/2011/11/4ECD90EB-D242.jpg "Yuriy Zaytsev")

**[Yuriy Zaytsev](/en/users/yuraz)**
|
5 May 2017 at 17:36

**Wackena:**  

Good idea and script. To expedite the process, you can use the [YURAZ\_CreateCSV\_HistoryFile\_From\_MT5\_For\_MT4](/en/code/232) script to produce only the M1 TimeFrame file.  F-Y-I: Running the script today (2010.12.17) with Max bars in chart in MT-5 set to 900000 produced an M1 file from 2008.06.09 to 2010.12.17. Import this M1 file into MT-4 History Center and then use the [period\_converter\_auto](/en/code/9560) script to produce the remaining M5, M15, M30, H1, H4, Day, Week & Month TimeFrame files.

For a Great idea and script would be to modify [YURAZ\_CreateCSV\_HistoryFile\_From\_MT5\_For\_MT4](/en/code/232) script to auto produce all TimeFrame files.

Oh hello to old friends!  
What was your steep 2007 adviser 2 place in the championship  
Respect and respect from me!

![ChartReinit](https://c.mql5.com/i/code/expert.png)
[ChartReinit](/en/code/224)

Chart reinitialization with recalculation of all chart indicators.

![FantailVMA](https://c.mql5.com/i/code/indicator.png)
[FantailVMA](/en/code/227)

This indicator is a combination of moving average and ATR indicators.

![Graphic Panel Contest](https://c.mql5.com/i/code/expert.png)
[Graphic Panel Contest](/en/code/231)

Graphic Panel Contest submission.

![Exp5-VirtualTradePad for mt5 v 4 (Contest version)](https://c.mql5.com/i/code/expert.png)
[Exp5-VirtualTradePad for mt5 v 4 (Contest version)](/en/code/223)

This Expert Advisor will simplify the manual trading. It supports the One-Click trading.