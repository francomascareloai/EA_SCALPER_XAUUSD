# NTK 07 - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/8706

MetaTrader 4 /
Experts

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

# NTK 07 - expert for MetaTrader 4

[Николай](/en/users/runik)

25471

(17)

How it works:

places two pending orders at the distance of netstep from the current price  
 if one of them triggers, the other one is deleted  
 places one more pending order in the direction of the price movement at the direction of netstep, but with the lot multiplied by mul  
 etc. until it reaches the maxtrades number of opened trades or LotLim  
 after that it trails the stop losses and take profits in the direction of the price, i.e. the task is to catch the trend and not to lose on the flat  
 therefore, maxtrades, stop losses, take profits depend on the market volatility, and mul should be less than two, in order not to lose too much due to the accumulated margin  
 in short, the EA operation is the most stable when using the least possible values of these parameters

  

![](https://c.mql5.com/18/19/pic1_1.gif)

Figure 1 shows a chart of daily price changes in EURUSD (daily bars), the EA parameters are optimized for the period of 01.01.2008 - 01.11.2008.  
 The EA works normally both the last two months of 2007, which is confirmed by the chart (high volatility), any timeframe

  
  

![](https://c.mql5.com/18/19/pic2.gif)

**NTK 07**

**(Build 220)**

  

|  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- |
| Symbol | | EURUSD (Euro vs US Dollar) | | | |
| Period | | 5 Minutes (M5) 2008.01.02 10:00 - 2009.01.09 22:55 (2008.01.01 - 2009.02.10) | | | |
| Model | | Every tick (the most accurate mode based on the shortest available time frames) | | | |
| Parameters | | g1="Main parameters"; netstep=20; sl=155; tp=300; TrailingStop=120; mul=1.6; trailprofit=1; gg="Money management"; mm=2; Lots=1; LotLim=7; maxtrades=5; percent=14; minsum=5000; bezub=0; deltalast=10; bq="Filters"; usema=0; MovingPeriod=1000; MovingShift=0; bb="Insignificant variables"; chas1=0; chas2=24; per=0; center=1; c10=10; c20=10000; | | | |
|  | |
| Bars in test | 75940 | Ticks modelled | 3560250 | Modelling quality | 90.00% |
| Mismatched chart errors | 0 |  |  |  |  |
|  | | | | | |
| Initial deposit | 100000.00 |  |  |  |  |
| Net profit | 693097.81 | Gross profit | 1543563.29 | Gross loss | -850465.48 |
| Profit factor | 1.81 | Expected payoff | 892.02 |  |  |
| Absolute drawdown | 12220.72 | Maximum drawdown | 181549.10 (26.06%) | Relative drawdown | 38.08% (53982.46) |
|  | | | | | |
| Total trades | 777 | Short positions (won %) | 405 (53.09%) | Long positions (won %) | 372 (47.31%) |
|  | | Profit trades (% of total) | 391 (50.32%) | Loss Trades (% of total) | 386 (49.68%) |
| Largest | | profit trade | 33920.76 | loss trade | -8097.62 |
| Average | | profit trade | 3947.73 | loss trade | -2203.28 |
| Maximum | | consecutive wins (profit in money) | 15 (115978.94) | consecutive losses (loss in money) | 38 (-104370.94) |
| Maximal | | consecutive profit (count of wins) | 115978.94 (15) | consecutive loss (count) | -104370.94 (38) |
| Average | | consecutive wins | 6 | consecutive losses | 6 |

I ask for help of those who liked this EA or those who found it rational.

Main problems:

1. Large drawdown, you can put filters based on some indicators in order to close earlier, later or move stop losses, take profits  
 (I am unable to do that, or rather it does not get any better)

2. If anyone has a good experience of live trading, please, I would really like the EA to reach that state ...

  

(for example, on fxstart demo it does not modify orders (in tester everything is normal), and on forex4u everything is OK)

**I would be grateful for any feedback, comments and suggestions!**

Send the modified experts, set files for different instruments, found errors  
 I will not lock or sell the EA, and I will send the latest versions to anyone who can make it work.  
 And I am against selling this EA!  
 (not because it is good/bad, but because IMHO only the author(s) have the right to do so)

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/8706](/ru/code/8706)

Hany Amin:

I have some error

Jaime Inostroza:

it does not work

stephanb:

I'm a newbie and found this does not work.

Jurry3:

trailling Stop in this code NTK\_7 does works and time limit, can You correct it, Ty

Jurry3:

does not works

[Read more comments and leave your own ones >>](/en/forum/90371)