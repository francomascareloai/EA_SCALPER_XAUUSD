# VR---SETKA---3 - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/16898

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/16898) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# VR---SETKA---3 - expert for MetaTrader 5

VOLDEMAR  |
[English](javascript:void(false);)

[Русский](/ru/code/16898) [中文](/zh/code/16898) [Español](/es/code/16898) [Deutsch](/de/code/16898) [日本語](/ja/code/16898) [Português](/pt/code/16898)

Published by:
:   [Vladimir Karputov](/en/users/barabashkakvn)

Views:
:   13072

Rating:
:   (53)

Published:
:   19 January 2017, 17:10

Updated:
:   14 June 2018, 16:55
:   [VR---SETKA---3.mq5](/en/code/download/16898/vr---setka---3.mq5 "VR---SETKA---3.mq5")
    (28.34 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/16898.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

**Author of the idea** — [Vladimir Pastushak](/en/users/voldemar "Vladimir Pastushak (VOLDEMAR)"), **author of the mq5 code** — [barabashkakvn](/en/users/barabashkakvn).

I have developed this EA based on my own trading experience. The market and the price are chaotic entities with no laws, therefore forecasting future movements is meaningless. However, there is one law that never changes: the chaos can never produce regular permanent sequences (the chaos remains the chaos). This can be used to catch movements of different size receiving a small profit.

The EA is based on three components:

1 — Good entry. I went through more than a dozen trade tactics to find the one to have at least 8 successful entries against 2 unsuccessful ones.

2 — Hold a position until a planned profit is received.

3 — Positive exit by profit and leading 2 statistical loss-making trades to zero. The EA also features Plus parameter adding several points of profit above zero.

**1 - Good entry**

We often come across financial news stating that the price increased by 2%, 1% etc. I have thoroughly studied the statistics on the market overbought/oversold trading tactics. We have the day's High and Low and the currency price of 1.23000. In order to enter a trade, the EA needs rise or fall set by Percent parameter. By default, the parameter is set to 1.3 which means the EA is to sell when reaching 1.2423.

Thus, we have the following parameters: day's Low 1.23000, current price 1.25000, sell threshold — Percent 1.3 %. The equation looks as follows: (((current price 1.25000\*100 )/Day's Low 1.23000)-100)>=Percent 1.3 %

The buy signal has the opposite equation. Thus, we take a roll-back from the strong movement.

[![](https://c.mql5.com/18/55/ScreenShotw16_small__1.jpg)](https://c.mql5.com/18/55/ScreenShotw16__1.jpg "https://c.mql5.com/18/55/ScreenShotw16__1.jpg")

Most of other tactics do not fall within the 8/2 ratio.

**2 - Hold a position until a planned profit is received.**

If the price moves in favorable direction after opening the first order, the EA waits for a take profit to trigger. If a lot is calculated from the deposit (Lots = 0, while Percent => 1), the lot of each new trade exceeds the previous one in case of a positive result. In order to calculate a lot as a percentage from free funds, we used the code from the [MQL4 Book](https://book.mql4.com/en "https://book.mql4.com/en"). The code was changed to allow setting a decimal value of the percentage (1.1% 1.8% 35.69%)

**3 - Positive exit by profit and leading 2 statistical loss-making trades to zero**

The averaging method (adding the same position with the same volume to the current one) is used to exit a losing trade. In other words, if the price moves against a position, the EA opens a new trade of the same type expecting the price to roll-back to the level where the result is 0. Without a martingale, the EA needs a roll-back of 50-52% to reach a zero level depending on spread and commission.

The chart with a fixed trading volume:

[![](https://c.mql5.com/18/55/TesterGraph_2_small__1.gif)](https://c.mql5.com/18/55/TesterGraph_2__1.gif "https://c.mql5.com/18/55/TesterGraph_2__1.gif")

With a martingale, the EA only needs a 20-22% roll-back to close an order series (averaging with martingale — adding the same position with an increased volume to the current one). This method is considered high-risk since you need a considerable amount of funds on your deposit in case the price moves 300-400 points.

Chart with martingale (the volumes vary depending on the number of open positions).

[![](https://c.mql5.com/18/55/TesterGraph2_small__1.gif)](https://c.mql5.com/18/55/TesterGraph2__1.gif "https://c.mql5.com/18/55/TesterGraph2__1.gif")

The Distanciya parameter is used for averaging when setting an opening of the next additional order, while the ShagDist parameter is used to increase the distance by the specified number of points per each new order.

The EA features the parameter for changing the averaging method:

> Standard Martin=False
>
> Using martingale Martin=True

Slip=2 (slippage in points)

Magic=1 (EA magic number).

Thus, we have the following chart when optimizing by Open prices

[![](https://c.mql5.com/18/55/TesterGraph_small__1.gif)](https://c.mql5.com/18/55/TesterGraph__1.gif "https://c.mql5.com/18/55/TesterGraph__1.gif")

Below are the test results in "Every tick" mode on EURUSD M30 from 2016.01.01 to 2016.11.12:

**![VR---SETKA---3 tester](https://c.mql5.com/18/55/VR---SETKA---3_tester.png "VR---SETKA---3 tester")**

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/16898](/ru/code/16898)

**Last comments |
[Go to discussion](/en/forum/167492)**
(29)

![ersan yurdakul](https://c.mql5.com/avatar/avatar_na2.png "ersan yurdakul")

**[ersan yurdakul](/en/users/ersan119)**
|
6 Feb 2020 at 13:59

Why That EA is not working?

This is a error ''[tester stopped](https://www.mql5.com/en/docs/common/TesterStop "MQL5 Documentation: TesterStop function") because OnInit returns non-zero code''

![Vladimir Karputov](https://c.mql5.com/avatar/2024/2/65d8b5a2-f9d9.jpg "Vladimir Karputov")

**[Vladimir Karputov](/en/users/barabashkakvn)**
|
6 Feb 2020 at 18:46

**ersan yurdakul :**  

Why That EA is not working?

This is a error ''tester stopped because OnInit returns non-zero code''

Go to the logs of the [testing agent](https://cloud.mql5.com/en "Distributed Computing in the MQL5 Cloud Network") and read the cause of the error.

![RZAMK](https://c.mql5.com/avatar/avatar_na2.png "RZAMK")

**[RZAMK](/en/users/47224357)**
|
5 Apr 2021 at 20:45

Thanks for EA.  

Would you please explain about **Proc** & **Procent** ?

![Vladimir Karputov](https://c.mql5.com/avatar/2024/2/65d8b5a2-f9d9.jpg "Vladimir Karputov")

**[Vladimir Karputov](/en/users/barabashkakvn)**
|
6 Apr 2021 at 04:21

**RZAMK :**  
 Thanks for EA.  

Would you please explain about **Proc** & **Procent** ?

A fork of the acceptable range of the daily price.

![紀仁 曾](https://c.mql5.com/avatar/2020/9/5F656F77-5130.jpg "紀仁 曾")

**[紀仁 曾](/en/users/lz0706)**
|
12 Jul 2024 at 16:54

How to control the setting of Lots, is it the [number of orders](https://www.mql5.com/en/docs/trading/orderstotal "MQL5 documentation: OrdersTotal function"); e.g. 2=2, or 0.2 lots.

![XMA_BBxATR_Cloud_HTF](https://c.mql5.com/i/code/indicator.png)
[XMA\_BBxATR\_Cloud\_HTF](/en/code/16896)

The XMA\_BBxATR\_Cloud indicator with the timeframe selection option available in the input parameters.

![JBrainTrend1Stop_Alert](https://c.mql5.com/i/code/indicator.png)
[JBrainTrend1Stop\_Alert](/en/code/16895)

JBrainTrend1Stop trend indicator features alerts, emails and push notifications.

![Expert NEWS](https://c.mql5.com/i/code/expert.png)
[Expert NEWS](/en/code/16899)

Expert NEWS - MetaTrader 5 Expert Advisor. BuyStop and SellStop pending orders.

![Fractal_Bands](https://c.mql5.com/i/code/indicator.png)
[Fractal\_Bands](/en/code/16915)

Fractal Bollinger Bands.