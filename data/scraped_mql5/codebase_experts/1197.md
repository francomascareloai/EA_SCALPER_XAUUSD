# Combinatorics - library for MetaTrader 5

Source: https://www.mql5.com/en/code/1197

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/1197) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.metatrader.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Libraries](https://c.mql5.com/i/code/library.png)

# Combinatorics - library for MetaTrader 5

[Denis Kirichenko](/en/users/denkir)  |
[English](javascript:void(false);)

[Русский](/ru/code/1197) [中文](/zh/code/1197) [Español](/es/code/1197) [Deutsch](/de/code/1197) [日本語](/ja/code/1197) [Português](/pt/code/1197)

Views:
:   6842

Rating:
:   (36)

Published:
:   27 December 2012, 11:56

Updated:
:   11 July 2016, 10:09
:   [combinatorics.mqh](/en/code/download/1197/combinatorics.mqh "combinatorics.mqh")
    (4.81 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/1197.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Initial library of combinatorics functions.

**Combinatorics** is a branch of [mathematics](https://en.wikipedia.org/wiki/Mathematics "https://en.wikipedia.org/wiki/Mathematics"), that studies discrete structures, [sets](https://en.wikipedia.org/wiki/Set_(mathematics) "https://en.wikipedia.org/wiki/Set_(mathematics)") ([combinations](https://en.wikipedia.org/wiki/Combination "https://en.wikipedia.org/wiki/Combination"), [permutation](https://en.wikipedia.org/wiki/Permutation "https://en.wikipedia.org/wiki/Permutation"), arrangement and [enumerative\_combinatorics](https://en.wikipedia.org/wiki/Enumerative_combinatorics "https://en.wikipedia.org/wiki/Enumerative_combinatorics")) and relations on them (for instance, [partially\_ordered\_set](https://en.wikipedia.org/wiki/Partially_ordered_set "https://en.wikipedia.org/wiki/Partially_ordered_set")). Combinatorics is related to many other areas of [mathematics](https://en.wikipedia.org/wiki/Mathematics "https://en.wikipedia.org/wiki/Mathematics") such as [algebra](https://en.wikipedia.org/wiki/Algebra "https://en.wikipedia.org/wiki/Algebra"), [geometry](https://en.wikipedia.org/wiki/Geometry "https://en.wikipedia.org/wiki/Geometry"), [probability theory](https://en.wikipedia.org/wiki/Probability_theory "https://en.wikipedia.org/wiki/Probability_theory") and has a wide spectrum of application in different areas of knowledge (for instance in [genetics](https://en.wikipedia.org/wiki/Genetics "https://en.wikipedia.org/wiki/Genetics"), [computer science](https://en.wikipedia.org/wiki/Computer_science "https://en.wikipedia.org/wiki/Computer_science"), [statistical physics](https://en.wikipedia.org/wiki/Statistical_physics "https://en.wikipedia.org/wiki/Statistical_physics")).

1) The first function:

```mql5
//+------------------------------------------------------------------+
//|                     Number factorial                             |
//+------------------------------------------------------------------+
double factorial(int x);
```

Factorials are often used in [combinatorics](https://en.wikipedia.org/wiki/Combinatorics "Combinatorics"), [number theory](https://en.wikipedia.org/wiki/Number_theory "Theory of numbers") and [functional analyses](https://en.wikipedia.org/wiki/Functional_analysis "Functional analyses").

Factorial is an extremely fast growing function. It grows faster than [polynomial](https://en.wikipedia.org/wiki/Polynomial "Polynomial") of any degree and faster than [exponential function](https://en.wikipedia.org/wiki/Exponential_function "Exponential function") (but slower than double exponential function).

That is why returned value must be of [double](/en/docs/basis/types/double) type. It is done because factorial grows too fast and already the 13! does not fit in the ranges of a [long](/en/docs/basis/types/integer/integertypes) type.

2) The second function:

```mql5
//+------------------------------------------------------------------+
//|                 Combination (combination)                        |
//+------------------------------------------------------------------+
double combination(int N,int k);
```

Combinations allow to select unique set of elements from some set consisting of N elements. Each set will have k elements.

Suppose that there are 10 trading signals. And for the trading system only 3 are to use. Then, for the further analyses all possible sets (3 signals) from the set of 10 signals should be selected.

Hence the number of such sets will be the number of combinations:

C(k,N) = C(3,10) = 120.

I.e. there are 120 unique combinations on 3 signals on each.

3) The third function:

```mql5
//+------------------------------------------------------------------+
//|            Combination (combination) with repetitions            |
//+------------------------------------------------------------------+
double _combination(int N,int k);
```

Combinations with repetitions admit that in the set some element can be presented more than one time. Suppose that there are five fruits. The set consisting of 3 elements has 2 oranges and 1 apple. Such set is a combination with repetitions. Orange repeated.

As for the set of 10 signals and possible sets (3 signals), we find a number of combinations with repetitions:

~C(k,N) = ~C(3,10) = 220.

4) The fourth function:

```mql5
//+------------------------------------------------------------------+
//|                        Arrangement                               |
//+------------------------------------------------------------------+
double arrangement(int N,int k);
```

Arrangements differ from the combinations in a fact that not the kit is important but the order of elements in the set. Suppose that there are 2 sets with 3 elements: apple-orange-banana, apple-banana-orange. In terms of the combinations we have only one combination (one set of participants). But concerning arrangement there are 2 combinations (participants changed order in a set).

It is clear that there will be more arrangements than combinations. For instance, from the set of signals (10 signals) and possible sets (3 signals) we can get as many arrangements:

A(k,N) = A(3,10) = 720.

5) The fifth function:

```mql5
//+------------------------------------------------------------------+
//|                   Arrangement with repetitions                   |
//+------------------------------------------------------------------+
double _arrangement(int N,int k);
```

I.e. as in case with combinations admit that elements in a set can be repeated.

Then for the set of 10 signals and possible sets (3 signals) we will get such a number of arrangements with repetitions:

~A(k,N) = ~A(3,10) = 1000.

6) The sixth function:

```mql5
//+------------------------------------------------------------------+
//|                       Permutation                                |
//+------------------------------------------------------------------+
double permutation(int N);
```

Permutation allows to know how many approaches can be to change the order in the set of elements.

So for the set of signals (10 signals) we can get as many permutations:

P(N) = P(10) = 3 628 800.

And for the set of 3 signals we can get as many permutations:

P(3) = 6.

Number of permutations returns factorial. Thus such a difference between the number of permutation for 3 and 10 elements.

7) The seventh function:

```mql5
//+------------------------------------------------------------------+
//|                  Permutation with repetitions                    |
//+------------------------------------------------------------------+
double _permutation(int &nM[]);
```

I.e. as in case with combinations admit that elements in a set can be repeated.

Only as a parameter passes an array in which each element indicates how many times it can be repeated.

For instance, there are 3 signals, each is repeated one time, then:

~P(N) = ~P({1,1,1}) = 6.

I.e. ~P({1,1,1}) = P(3).

Suppose that the first signal can be repeated 2 times, then:

~P({2,1,1}) = 12.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/1197](/ru/code/1197)

**Last comments |
[Go to discussion](/en/forum/9721)**
(2)

![q.import](https://c.mql5.com/avatar/avatar_na2.png "q.import")

**[q.import](/en/users/q.import)**
|
5 Dec 2013 at 04:12

**Automated-Trading:**  

[Combinatorics](/en/code/1197):

Author: [Dennis Kirichenko](https://www.mql5.com/en/users/denkir "https://www.mql5.com/en/users/denkir")

Very Basic

Thanks for the upload. I like it a lot

![Aleksey Vyazmikin](https://c.mql5.com/avatar/2024/6/6678986f-2caa.png "Aleksey Vyazmikin")

**[Aleksey Vyazmikin](/en/users/-aleks-)**
|
6 Jun 2020 at 00:43

The library cannot work with large samples, even 200 units for 3 groups cannot be calculated by the function

```mql5
double combination(int N,int k)
  {
   int nCombs;
   nCombs=factorial(N)/(factorial(k)*factorial(N-k));
   //Print(factorial(N));
   return nCombs;
  }
```

And it is not clear, the function is of [type double](https://www.mql5.com/en/docs/basis/types/double "MQL5 Documentation: Real types (double, float)"), but returns the value of int variable.

Is there any possibility to get the value in each group by combination number without a loop of continuous enumeration?

![The class for drawing Moving Average using the ring buffer](https://c.mql5.com/i/code/indicator.png)
[The class for drawing Moving Average using the ring buffer](/en/code/1342)

The class is designed for calculation of Moving Averages (Moving Average) using the algorithm of the ring buffer.

![The class to create the ring buffer](https://c.mql5.com/i/code/library.png)
[The class to create the ring buffer](/en/code/1340)

The class allows to organize the mini time series, indicator minibuffers, short sized buffers to store intermediate stream data inside the Expert Advisor or indicator.

![Exp_ColorTrend_CF](https://c.mql5.com/i/code/expert.png)
[Exp\_ColorTrend\_CF](/en/code/1355)

The Exp\_ColorTrend\_CF trading system is based on change of the trend direction displayed by the ColorTrend\_CF indicator

![The class for drawing the ATR using the ring buffer](https://c.mql5.com/i/code/indicator.png)
[The class for drawing the ATR using the ring buffer](/en/code/1344)

The class is designed for calculation of the Average True Range indicator (Average True Range, ATR) using the algorithm of the ring buffer.