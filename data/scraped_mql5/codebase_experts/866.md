# Statistics.mqh Functions - library for MetaTrader 5

Source: https://www.mql5.com/en/code/866

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/866) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Libraries](https://c.mql5.com/i/code/library.png)

# Statistics.mqh Functions - library for MetaTrader 5

[QSer29](/en/users/qser29)  |
[English](javascript:void(false);)

[Русский](/ru/code/866) [中文](/zh/code/866) [Español](/es/code/866) [Deutsch](/de/code/866) [日本語](/ja/code/866) [Português](/pt/code/866)

Views:
:   16469

Rating:
:   (44)

Published:
:   5 April 2012, 12:31

Updated:
:   22 November 2016, 07:32
:   \MQL5\Include\

    [statistics.mqh](/en/code/download/866/statistics.mqh "statistics.mqh")
    (27.16 KB)
    [view](# "view")

    \MQL5\Scripts\

    [test.mq5](/en/code/download/866/test.mq5 "test.mq5")
    (1.64 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/866.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

This library contains a set of basic statistical functions necessary for user data processing.

This library was first published in CodeBase at MQL4 - [Statistica.mqh](https://www.mql5.com/ru/code/9155)[functions library](https://www.mql5.com/ru/code/9155). Some typos have been detected and corrected while
transferring the functions to MQL5. The code has become more intuitively
clear. Most functions have been written using the algorithms from S.
Bulashov's book "Statistics for traders".

The library functions are as follows:

| Function | Description |
| --- | --- |
| Mediana | Median calculation |
| Mediana50 | Median calculation by 50% interquantile range |
| Average | Sample arithmetic mean calculation |
| Average50 | Sample arithmetic mean calculation by 50% interquantile range |
| SweepCenter | Sweep center calculation |
| AverageOfEvaluations | Calculation of the average value of five upper evaluations |
| Variance | Sample variance calculation |
| ThirdCentralMoment | Third central moment calculation |
| FourthCentralMoment | Fourth central moment calculation |
| Asymmetry | Sample asymmetry calculation |
| Excess | Sample excess calculation |
| Excess2 | Another method of the sample excess calculation |
| Gamma | Euler's gamma function calculation, x>0. |
| GammaStirling | Euler's gamma function value calculation, for x>33 (Stirling's approximation) |
| VarianceOfSampleVariance | Calculating the variance of a sample variance |
| VarianceOfStandartDeviation | Calculating the variance of a standard deviation |
| VarianceOfAsymmetry | Sample asymmetry variance calculation |
| VarianceOfExcess | Sample excess variance calculation |
| VarianceOfAverage | Sample mean variance calculation |
| Log | Logarithm calculation |
| CensorCoeff | Censoring ratio calculation |
| HistogramLength | Calculating the optimal number of the histogram columns |
| Resize | Calculating the optimal number of the array elements for the histogram |
| Histogram | Creating the histogram to \*.csv file |
| Cov | Sample covariation calculation |
| Corr | Sample correlation calculation |
| VarianceOfCorr | Sample correlation variance calculation |
| AutoCorr | Autocorrelation calculation |
| AutoCorrFunc | Autocorrelation function calculation |
| aCoeff | Calculating the a ratio in the linear regression equation (y=a\*x+b) |
| bCoeff | Calculating the b ratio in the linear regression equation (y=a\*x+b) |
| LineRegresErrors | Calculating the linear regression errors |
| eVariance | Calculating the linear regression errors variance |
| aVariance | Calculating the linear regression a parameter variance |
| bVariance | Calculating the linear regression b parameter variance |
| DeterminationCoeff | Determination ratio calculation |
| ArraySeparate | Splitting the arr[n][2] array in two arrays |
| ArrayUnion | Joining the two arrays into the array of arr[n][2] type |
| WriteArray | Writing the one-dimensional array to \*.csv file |
| WriteArray2 | Writing the two-dimensional array to \*.csv file |

The file can be included in the projects requiring random sample parameters processing, its parameters evaluation, histograms etc.

Let's examine the call of some functions:

```mql5
//+------------------------------------------------------------------+
//|                                                         test.mq5 |
//|                        Copyright 2012, MetaQuotes Software Corp. |
//|                                              http://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright "Copyright 2012, MetaQuotes Software Corp."
#property link      "http://www.mql5.com"
#property version   "1.00"

#include <Statistics.mqh>
//+------------------------------------------------------------------+
//| Script program start function                                    |
//+------------------------------------------------------------------+
void OnStart()
  {
//--- specifying two values samples.
   double arrX[10]={3,4,5,2,3,4,5,6,4,7};
   double arrY[10]={7,4,1,2,1,6,9,2,1,5};
//--- calculating the mean
   double mx=Average(arrX);
   double my=Average(arrY);
//--- using the mean to calculate the variance
   double dx = Variance(arrX,mx);
   double dy = Variance(arrY,my);
//--- asymmetry value and excess
   double as=Asymmetry(arrX,mx,dx);
   double exc=Excess(arrX,mx,dx);
//--- covariation and correlation values
   double cov=Cov(arrX,arrY,mx,my);
   double corr=Corr(cov,dx,dy);
//--- showing results in the log file
   PrintFormat("mx=%.6e",mx);
   PrintFormat("my=%.6e",my);
   PrintFormat("dx=%.6e",dx);
   PrintFormat("dy=%.6e",dy);
   PrintFormat("As=%.6e",as);
   PrintFormat("exc=%.6e",exc);
   PrintFormat("cov=%.6e",cov);
   PrintFormat("corr=%.6e",corr);
  }
```

As you can see, most functions require the values (as input parameters) that can be calculated using other functions.

For example:

```mql5
double dx = Variance(arrX,mx);
```

To calculate the variance, we have to
calculate the mean at first. That gives a certain
advantage regarding the calculations optimization. In case it is
necessary to calculate the variance for several times, it will be better
to find the mean once instead of doing it several
times inside the function. That will save time.

This feature applies to most functions of the library.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/866](/ru/code/866)

**Last comments |
[Go to discussion](/en/forum/6467)**
(3)

![Claudio Lasso](https://c.mql5.com/avatar/avatar_na2.png "Claudio Lasso")

**[Claudio Lasso](/en/users/claudiolasso)**
|
15 Apr 2020 at 15:23

hi there's a mql4 file of this work?thanks

![Виктор Астахов](https://c.mql5.com/avatar/2018/9/5BAFA1E1-9A01.png "Виктор Астахов")

**[Виктор Астахов](/en/users/vponed0)**
|
7 Aug 2020 at 21:59

**Automated-Trading:**  

[Statistical functions statistics.mqh](/en/code/866):

Author: [QSer29](/en/users/QSer29)

I apologise, I ran the test script and it gave a correlation value of 1.4.

Shouldn't the correlation be within -1 - 1 ?

It is not clear how to use the result

![Vitaly Muzichenko](https://c.mql5.com/avatar/2025/11/691d3a3a-b70b.png "Vitaly Muzichenko")

**[Vitaly Muzichenko](/en/users/mvs)**
|
7 Aug 2020 at 22:05

**Виктор Астахов:**  

I apologise, I ran the test script and it gave a correlation value of 1.4.

Shouldn't the correlation be between -1 and 1 ?

It is not clear how to use the result

Of course it's 1 or -1. There's an error in the code somewhere

![Objects Description Activator](https://c.mql5.com/i/code/script.png)
[Objects Description Activator](/en/code/867)

Enables the "Chart Objects Description" for non-programmers. For any open chart window.

![Price on Bollinger Channel](https://c.mql5.com/i/code/indicator.png)
[Price on Bollinger Channel](/en/code/851)

The indicator draws (in a separate window) the Bollinger Bands relative to the moving average and projection of the price bars.

![Percentage of Trend](https://c.mql5.com/i/code/indicator.png)
[Percentage of Trend](/en/code/868)

This Indicator is used for calculating trend.

![ColorChart](https://c.mql5.com/i/code/script.png)
[ColorChart](/en/code/877)

Simple script to randomize all colors of your chart. Just click on it and see results yourself!