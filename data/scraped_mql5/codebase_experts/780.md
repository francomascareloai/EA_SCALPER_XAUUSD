# Save history to HST - script for MetaTrader 5

Source: https://www.mql5.com/en/code/780

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/780) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# Save history to HST - script for MetaTrader 5

[Andriy Voitenko](/en/users/avoitenko)  |
[English](javascript:void(false);)

[Русский](/ru/code/780) [中文](/zh/code/780) [Español](/es/code/780) [Deutsch](/de/code/780) [日本語](/ja/code/780) [Português](/pt/code/780) [한국어](/ko/code/780) [Français](/fr/code/780) [Italiano](/it/code/780) [Türkçe](/tr/code/780)

Views:
:   12401

Rating:
:   (42)

Published:
:   27 December 2011, 08:08

Updated:
:   22 November 2016, 07:32
:   [savehistorytohst.mq5](/en/code/download/780/savehistorytohst.mq5 "savehistorytohst.mq5")
    (4.09 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/780.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

This script allows to create a binary \*.hst file, supported by MetaTrader 4. This file can be imported in MetaTrader 4 as historical data or you can open it as offline chart.

It has only one DATA\_COUNT input parameter, which specifies data count in bars, starting from current.

Initially, this script was designed for checking of the indicators, written in MQL4 and MQL5, because the same data needed for the compare.

To check the indicator values, follow these steps:

1. Install indicators "Zerolag MACD":

MetaTrader 4: - <https://www.mql5.com/ru/code/9993>  
MetaTrader 5: - [https://www.mql5.com/en/code/170](/en/code/170)

2. Install this script in MetaTrader 5 and launch it.

3. If successful, it will print a message with path of the file created, for example:

2011.12.26 20:23:27 SaveHistoryToHST (EURUSD,M1) Path to file: C:\Program Files\MetaTrader 5\MQL5\Files\!EURUSD1.hst

Copy this file to  MetaTrader 4 client terminal folder: <MetaTrader 4 Folder>\history\<Server type>\, for example:

C:\Program Files (x86)\MetaTrader 4\history\Alpari-Micro3\

Import file with the history to MetaTrader 4 client terminal as offline, by choosing  File -> Open Offlie.

![](https://c.mql5.com/18/6/open_offline.png)

4. Launch the indicator on the MetaTrader 4 offline chart and launch it in MetaTrader 5, you will see that both of them have the same values.

![Save history to HST](https://c.mql5.com/18/6/111.png "Save history to HST")

And at last check them visually.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/780](/ru/code/780)

**Last comments |
[Go to discussion](/en/forum/5741)**
(9)

![Andriy Voitenko](https://c.mql5.com/avatar/2022/11/637e0528-b679.jpg "Andriy Voitenko")

**[Andriy Voitenko](/en/users/avoitenko)**
|
4 Oct 2014 at 07:08

**registk:**  

Hello Mr Voytenko , my name is Regis Karam, I'm from Brazil and found very interesting your script.Here in Brazil we only have the real time signal on the metatrader 5, so I thought you could help me get our charts in real time in MT4 through your script or possibly turn this script on an indicator that can update the .hst file(rel-time) so that I can work with my system renko charts online, is it possible? I know little MQL5 and think it would be interesting to have an indicator that works this way, I have not found anything similar like it on the Internet.

Thanks,

Regis Karam

Hello. Please look at this code:

[https://www.mql5.com/en/code/9358](/en/code/9358)

[https://www.mql5.com/en/code/10766](/en/code/10766)

![registk](https://c.mql5.com/avatar/avatar_na2.png "registk")

**[registk](/en/users/registk)**
|
10 Oct 2014 at 21:54

Thanks for quickly reply. I'm testing this Renko system in the Forex market, but my problem is that I don't have real time signal in Brazil stock exchange ,only in new MT5, so for me to use Renko Charts on MT4 I need .hst file to be updated with [historical](https://www.mql5.com/en/docs/trading/historydealgetstring "MQL5 documentation: HistoryDealGetString function") data in real time through the MT5 with your script or indicator (savehistoryhst.mq5). Can you add an update routine of data in real time, similar routines of periodcon.mq4 converted to MQ5? Then I open a chart on MT5 , load de script and open my MT4 accessing .hst file with updates in real time, would it be possible?

Thanks!

![Andriy Voitenko](https://c.mql5.com/avatar/2022/11/637e0528-b679.jpg "Andriy Voitenko")

**[Andriy Voitenko](/en/users/avoitenko)**
|
13 Jan 2015 at 15:21

If hst file [is imported](https://www.mql5.com/en/economic-calendar/united-states/imports "US Economic Calendar: Imports (Imports)") into MT4 with the name of an instrument that is not in the market environment, then the chart displays quotes with fewer digits than specified in the file. For example, not 5 but only 4.

This prevents comparison of quotes. That's why we can go another way. Create a file with the existing MT4 instrument name and specify a non-standard timeframe, for example 11, 23, etc.

To set the required instrument name and timeframe, there are corresponding settings in the script.

![Greff](https://c.mql5.com/avatar/avatar_na2.png "Greff")

**[Greff](/en/users/greff)**
|
28 Apr 2021 at 11:15

Great script ! Thank you.

![conrad.1](https://c.mql5.com/avatar/avatar_na2.png "conrad.1")

**[conrad.1](/en/users/conrad.1)**
|
19 Mar 2024 at 12:14

Great tool! I had to use Chat GPT to define some [error](/en/articles/70 "Article: OOP in MQL5 by Example: Processing Warning and Error Codes ") message that printed, but in the end, I had it working. Thank you very much.

![IncAMAOnArray](https://c.mql5.com/i/code/library.png)
[IncAMAOnArray](/en/code/630)

CAMAOnArray class is designed for calculation of AMA (Adaptive Moving Average) values on indicator buffers. The example of use of the class is provided.

![TrendLineAlert](https://c.mql5.com/i/code/indicator.png)
[TrendLineAlert](/en/code/661)

The indicator displays the inclined trend line that sets the signal actuating level.

![Laguerre_HTF_Signal](https://c.mql5.com/i/code/indicator.png)
[Laguerre\_HTF\_Signal](/en/code/676)

Laguerre\_HTF\_Signal shows a trend direction or a signal for performing a deal generated by Laguerre indicator as a graphic object with colored trend indication or deal direction.

![WiOver](https://c.mql5.com/i/code/indicator.png)
[WiOver](/en/code/698)

The indicator shows the average percentage value of the last candlesticks overlap. It is useful for those, who enters the market manually using limit orders during price consolidation, as it allows to select order direction. Blue line - recommended BUY-LIMIT, red one - SELL-LIMIT.