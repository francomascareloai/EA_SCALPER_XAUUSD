# Flat Trend EA - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/21929

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/21929) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Flat Trend EA - expert for MetaTrader 5

Scriptor  |
[English](javascript:void(false);)

[Русский](/ru/code/21929) [中文](/zh/code/21929) [Español](/es/code/21929) [Deutsch](/de/code/21929) [日本語](/ja/code/21929) [Português](/pt/code/21929)

Published by:
:   [Vladimir Karputov](/en/users/barabashkakvn)

Views:
:   6558

Rating:
:   (15)

Published:
:   25 October 2018, 16:09
:   \MQL5\Experts\

    [Flat Trend EA.mq5](/en/code/download/21929/flat_trend_ea.mq5 "Flat Trend EA.mq5")
    (40.05 KB)
    [view](# "view")

    \MQL5\Indicators\

    [FlatTrend.mq5](/en/code/download/21929/flattrend.mq5 "FlatTrend.mq5")
    (25.03 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/21929.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

**The author of the idea**: [Scriptor](/en/users/scriptor "Scriptor (Scriptor)")

**MQL5 code author**: [barabashkakvn](/en/users/barabashkakvn)

The EA uses the [FlatTrend](/en/code/21926 "FlatTrend") indicator:

The indicator defines the market state: flat or trend.

Interpretation of the histogram color buffers when setting "**signal timeframe**" PERIOD\_CURRENT:

![FlatTrend](https://c.mql5.com/18/72/FlatTrend_v.2__1.png "FlatTrend")

If Use hour flag is enabled - from **Start Hour** to **End Hour** on the bar #**Current bar**, the **FlatTrend** is surveyed. If a signal is present, open **Buy** or **Sell**. Set a stop loss (only if **Stop Loss** is not "0.0") and a take profit (only if **Take Profit** is not "0.0").

Trailing is activated if **Trailing Stop** is not "0.0".

Test on EURUSD, M15 **with these parameters:**

![Flat Trend EA Optimization](https://c.mql5.com/18/72/Flat_Trend_EA_Optimization.png "Flat Trend EA Optimization")

![Flat Trend EA](https://c.mql5.com/18/72/Flat_Trend_EA.png "Flat Trend EA")

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/21929](/ru/code/21929)

**Last comments |
[Go to discussion](/en/forum/285596)**
(8)

![Joseph Kisakye](https://c.mql5.com/avatar/2019/11/5DD7B1CB-5121.jpg "Joseph Kisakye")

**[Joseph Kisakye](/en/users/josephkisakye)**
|
12 Jun 2021 at 10:21

If you add the following options in the code, it would give the user more options to manage the overall trade results;

1. Ability to choose Buy Only or Sell Only trades

3. Ability for the EA to make only one trade per signal based on set target profit

![Joseph Kisakye](https://c.mql5.com/avatar/2019/11/5DD7B1CB-5121.jpg "Joseph Kisakye")

**[Joseph Kisakye](/en/users/josephkisakye)**
|
12 Jun 2021 at 11:30

**Joseph Kisakye:**  

If you add the following options in the code, it would give the user more options to manage the overall trade results;

1. Ability to choose Buy Only or Sell Only trades

3. Ability for the EA to make only one trade per signal based on set target profit

Can you please share the MT5 download link for the PipMaker v1 EA!?

I shall be very grateful. Thank you

![Joseph Kisakye](https://c.mql5.com/avatar/2019/11/5DD7B1CB-5121.jpg "Joseph Kisakye")

**[Joseph Kisakye](/en/users/josephkisakye)**
|
12 Jun 2021 at 11:31

**Automated-Trading:**  

[Flat Trend EA](/en/code/21929):

Author: [Vladimir Karputov](/en/users/barabashkakvn "barabashkakvn")

I am trading synthetic indices which are not affected by trading time, so that's why the options to buy only and sell only would help me become more profitable with the FlatTrend EA by ensuring the EA trades trades say only 1 candle per signal and only trade again when another signal has appeared. Or best to combine it with an oscillator to limit the trades only when the two signals align for a Buy or Sell.

![Vladimir Karputov](https://c.mql5.com/avatar/2024/2/65d8b5a2-f9d9.jpg "Vladimir Karputov")

**[Vladimir Karputov](/en/users/barabashkakvn)**
|
12 Jun 2021 at 11:46

**Joseph Kisakye :**  
 I am trading synthetic indices which are not affected by trading time, so that's why the options to buy only and sell only would help me become more profitable with the FlatTrend EA by ensuring the EA trades trades say only 1 candle per signal and only trade again when another signal has appeared. Or best to combine it with an oscillator to limit the trades only when the two signals align for a Buy or Sell.

Yes, an oscillator (eg RSI) can be applied. Need to [check](/en/docs/integration/python_metatrader5/mt5ordercalcmargin_py "MQL5 Documentation: order_calc_margin function") this option ...

![Vladimir Karputov](https://c.mql5.com/avatar/2024/2/65d8b5a2-f9d9.jpg "Vladimir Karputov")

**[Vladimir Karputov](/en/users/barabashkakvn)**
|
13 Jun 2021 at 13:34

**Joseph Kisakye :**  
 I am trading synthetic indices which are not affected by trading time, so that's why the options to buy only and sell only would help me become more profitable with the FlatTrend EA by ensuring the EA trades trades say only 1 candle per signal and only trade again when another signal has appeared. Or best to combine it with an oscillator to limit the trades only when the two signals align for a Buy or Sell.

Preliminary version 2.XXXX (no oscillator yet). I look forward to your feedback ...

![TrendManager_HTF](https://c.mql5.com/i/code/indicator.png)
[TrendManager\_HTF](/en/code/21934)

TrendManager indicator with the timeframe selection option available in input parameters

![ssb5_123](https://c.mql5.com/i/code/expert.png)
[ssb5\_123](/en/code/21937)

Defining a signal based on several indicators: iMA (Moving Average, MA), iMACD (Moving Average Convergence/Divergence, MACD), iStochastic (Stochastic Oscillator), iOsMA (Moving Average of Oscillator, OsMA) and iAO (Awesome Oscillator, AO). The indicators are surveyed in a certain sequence.

![FlatTrend](https://c.mql5.com/i/code/indicator.png)
[FlatTrend](/en/code/21926)

Flat/trend indicator.

![XRSI_Candle_Vol](https://c.mql5.com/i/code/indicator.png)
[XRSI\_Candle\_Vol](/en/code/21923)

RSI\_Candle\_Vol indicator with additional averaging of the resulting candles