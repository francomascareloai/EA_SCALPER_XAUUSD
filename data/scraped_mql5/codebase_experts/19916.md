# TimeEA - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/19916

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/19916) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# TimeEA - expert for MetaTrader 5

[Scriptor](/en/users/scriptor)  |
[English](javascript:void(false);)

[Русский](/ru/code/19916) [中文](/zh/code/19916) [Español](/es/code/19916) [Deutsch](/de/code/19916) [日本語](/ja/code/19916) [Português](/pt/code/19916)

Views:
:   6494

Rating:
:   (18)

Published:
:   1 March 2018, 11:54
:   [TimeEA.mq5](/en/code/download/19916/timeea.mq5 "TimeEA.mq5")
    (33.89 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/19916.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

A Simple Expert Advisor The EA opens a position of the specified type at the time specified in the EA parameters. The position is closed at the time specified in the appropriate parameter.

The purpose is to select the appropriate type of a position (either long or short) and to set position opening and closing time in hours and minutes. You can also set stop loss and take profit in points. If invalid Stop Loss and Take Profit values are specified, the EA will adjust the values to the minimum **StopLevel** allowed for the symbol.

The Expert Advisor will also adjust the lot in case an incorrect value is specified. If the lot is too large, the EA will adjust it in order to be able to open a position. If there is no money for opening even the minimum lot, the signal will be skipped.

The EA has a specific feature: if short stop orders are used and they trigger, a new position can be opened provided it is the same bar, on which the first position was opened at this time signal. In other words: if a position is opened at the current bar and is closed by the stop order, a new position will be opened if the new bar has not started yet, and so on until a new bar opens on the current timeframe.

Note that the Expert Advisor is designed for training and strategy testing purposes.

The EA has 11 input parameters:

* **Experts magic number** - a unique identifier for the EA's positions;
* **Hour of position open** - hour in the position opening time;
* **Minute of position open** - minutes in the position opening time;
* **Hour of position close** - hour in the position closing time;
* **Minute of position close** - minutes in the position closing time;
* **Position type** - opening a long or a short position;
* **Lots** - the volume of position to open;
* **Stop loss in points** - Stop Loss value in points;
* **Take profit in points** - Take Profit value in points;
* **Slippage of price** - allowable slippage;
* **Multiplier spread for stops** - spread multiplier for calculating a correct distance for stop orders.

For Stop Loss and Take Profit orders (as well as pending orders), there is a minimum allowed distance for placing such orders - **StopLevel**. I.e. Stop Loss and Take Profit (as well as pending orders) cannot be placed closer than this distance to the price. If **StopLevel** is zero, it does not mean its absence, it only means that **StopLevel** is floating. In this case, the minimum distance is usually equal to spread\*, but sometimes even the double spread is not enough. So, this parameter allows specifying a custom multiplier for the spread used to calculate the minimum distance for placing stop orders.

Two tests were performed in the Every Tick mode on EURUSD H1, using data in the interval from 2017.01.02 to 2018.01.19, in two modes: opening long positions and opening short positions. The EA showed good results in the Long Positions mode. This mode was additionally optimized in terms of position opening and closing hour.

The result of the EA testing with the opening hour set to 15 and closing hour set to 8, and default parameters is shown below:

![](https://c.mql5.com/18/64/TimeEA_graph.png)

![](https://c.mql5.com/18/64/TimeEA_res.png)

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/19916](/ru/code/19916)

**Last comments |
[Go to discussion](/en/forum/229126)**
(14)

![Buy_sell](https://c.mql5.com/avatar/2020/9/5F60E408-F78B.JPG "Buy_sell")

**[Buy\_sell](/en/users/newwinner2020)**
|
1 Aug 2020 at 12:54

It is not loaded from the library for some reason. And when trying to compile the code in the editor it gives an error.

![Buy_sell](https://c.mql5.com/avatar/2020/9/5F60E408-F78B.JPG "Buy_sell")

**[Buy\_sell](/en/users/newwinner2020)**
|
9 Nov 2020 at 08:49

**Newwinner2020:**  
 It is not loaded from the library for some reason. And when I try to compile the code in the editor, I get an error.

I figured it out, there was one line missing in the header, class and method to the library.

![andarinka](https://c.mql5.com/avatar/avatar_na2.png "andarinka")

**[andarinka](/en/users/andarinka)**
|
5 Jun 2022 at 17:31

**Buy\_sell [#](/ru/forum/226966/page2#comment_19145877):**  

Figured it out, there was one line missing in the header, the class and method to the library.

Could you please tell me where to get it - this line that was missing to load this EA or compile its code?

![MrBrooklin](https://c.mql5.com/avatar/2022/11/6383f326-c19f.png "MrBrooklin")

**[MrBrooklin](/en/users/mrbrooklin)**
|
5 Jun 2022 at 18:26

**andarinka [#](/ru/forum/226966/page2#comment_39985620):**  
Can you please tell me where to get it - this line that was missing to load this EA or to compile its code?

Hello! There is a block of include files in the EA code just below the input parameters. Add this line there:

```mql5
#include <Trade\SymbolInfo.mqh>
```

Regards, Vladimir.

![andarinka](https://c.mql5.com/avatar/avatar_na2.png "andarinka")

**[andarinka](/en/users/andarinka)**
|
10 Mar 2023 at 21:43

**MrBrooklin [#](/ru/forum/226966/page2#comment_39986244):**  

Hello! In the EA code just below the input parameters there is a block of include files. Add this line there:

Regards, Vladimir.

Thank you very much! It worked!

![NTK 07](https://c.mql5.com/i/code/expert.png)
[NTK 07](/en/code/19914)

Implementation of multiple trailing types. Pending Buy Stop and Sell Stop orders. Limitation of the maximum total lot and the total number of positions. Several types of position volume calculation.

![Percentage_Crossover_Channel_EA](https://c.mql5.com/i/code/expert.png)
[Percentage\_Crossover\_Channel\_EA](/en/code/19913)

An Expert Advisor, which trades in a channel based on the Percentage\_Crossover\_Channel indicator.

![TrailingTakeProfit](https://c.mql5.com/i/code/expert.png)
[TrailingTakeProfit](/en/code/19930)

This non-trading Expert Advisor is designed for the simple trailing of take profit orders of open positions.

![RndTrade](https://c.mql5.com/i/code/expert.png)
[RndTrade](/en/code/19931)

Opening positions randomly after a certain time interval.