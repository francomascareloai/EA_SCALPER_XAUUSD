# Pairs Trading - expert for MetaTrader 5

Source: https://www.mql5.com/en/code/11777

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/11777) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Pairs Trading - expert for MetaTrader 5

[Alexander Pavlov](/en/users/1987pavlov)  |
[English](javascript:void(false);)

[Русский](/ru/code/11777) [中文](/zh/code/11777) [Español](/es/code/11777) [Deutsch](/de/code/11777) [日本語](/ja/code/11777) [Português](/pt/code/11777)

Views:
:   15067

Rating:
:   (46)

Published:
:   21 January 2015, 13:19

Updated:
:   22 November 2016, 07:32
:   [Double\_trading.mq5](/en/code/download/11777/double_trading.mq5 "Double_trading.mq5")
    (16.87 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/11777.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The robot opens two positions, profit and loss of which overlap each other. In other words two positions are opened: one has positive profit, while the other has negative profit. After that the robot waits for positive profit of these orders and closes positions.

The robot is capable of trading in two modes: manual and automatic (when the robot itself makes decision upon purchase or sale depending on a trade session). You shall state the symbols you have (pair or mirror) to work in the automatic mode.

You have pair symbols if symbol charts are similar.

You have mirror symbols if symbol charts are reflected specularly.

The robot provides profits statistics:

![](https://c.mql5.com/18/32/ldsfeo1.jpg)

**Attention!**

You will need [correlation](/en/code/897) indicators for the EA. It shall be installed in **terminal data folder\MQL5\Indicators** as in the figure:

![](https://c.mql5.com/18/31/45__1.jpg)

  

**Key parameters**

* **Correlation bail for orders opening** - correlation value according to which positions are opened.
* **How many times you can try to open an order** - if your agency does not open a position on the first try, this parameter will state how many times one position can be opened .
* **Lots for the 1st symbol, Lots for the 2nd symbol** - number of lots is selected in such a way that profit of one pair overlaps loss of the other pair. I.e. symbol profit shall be equal to zero (but during "tranquil" correlation only (see the figure)).

![](https://c.mql5.com/18/31/corr.jpg)
  

**EURUSD and USDCHF Statistics**

[![](https://c.mql5.com/18/32/TesterGraphReport2014_11_03_61i.png)](https://c.mql5.com/18/32/TesterGraphReport2014_11_03_a1w.png)

This statistic data is obtained from MetaTrader 5 tester. In practice such statistic can appear only on stocks, futures, options, and Forts markets (the latter is more volatile). As for FOREX, suitable markets were found abroad (for instance www.swissquote-fx.com, https://www.tradeking.com or http://pricemarkets.com). Why abroad? Because at night Russian agencies close and then open your positions, meanwhile loss taking (in the course of pairs trading) can happen.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/11777](/ru/code/11777)

**Last comments |
[Go to discussion](/en/forum/39879)**
(47)

![Aleksandr Egorov](https://c.mql5.com/avatar/2017/2/589EEB09-4867.jpeg "Aleksandr Egorov")

**[Aleksandr Egorov](/en/users/tyrbo)**
|
14 May 2019 at 05:04

Does anyone else use this advisor?

![cruse wang](https://c.mql5.com/avatar/2020/4/5EA2A83B-CB32.jpg "cruse wang")

**[cruse wang](/en/users/bw5168-gmail)**
|
18 Feb 2021 at 02:18

Hi sir,

I just put [correlation](https://www.mql5.com/en/docs/matrix/matrix_products/matrix_correlate "MQL5 Documentation: function Correlate") indicator and Double\_trade ea, but can not work properly,

can you give any suggestion ? thank you

![Ivan Butko](https://c.mql5.com/avatar/2017/1/58797422-0BFA.png "Ivan Butko")

**[Ivan Butko](/en/users/capitalplus)**
|
19 Nov 2021 at 21:26

Error during compilation cannot convert 0 to enum['ENUM\_TRADE\_REQUEST\_ACTIONS](https://www.mql5.com/en/docs/constants/tradingconstants/enum_trade_request_actions "MQL5 Documentation: Types of trading operations")'  Double\_trading.mq5  67  29  
 Line MqlTradeRequest request={0};

If you remove "0", compilation passes without errors. But when testing nothing happens, the error "Not all data of MA is calculated. Error 4806." And on all pairs, with loaded history

![Максим Ф](https://c.mql5.com/avatar/2020/10/5F8F6704-7D72.png "Максим Ф")

**[Максим Ф](/en/users/maxfes91)**
|
2 Sep 2022 at 12:31

**Ivan Butko 'ENUM\_TRADE\_REQUEST\_ACTIONS'  Double\_trading.mq5  67  29  
 Line MqlTradeRequest request={0};**

If you remove "0", compilation passes without errors. But when testing nothing happens, the error "Not all data of MA is calculated. Error 4806." And on all pairs, with [loaded history](https://www.mql5.com/en/articles/239 "Article: The Fundamentals of Testing in MetaTrader 5 ")

Yes, theerror "Not all data of MA is calculated. Error 4806." remains andwhen visualising, you can see that the EA creates a new indicator in the basement at each price tick. Can anyone fix it for new builds of mt5?

![ciutacion](https://c.mql5.com/avatar/avatar_na2.png "ciutacion")

**[ciutacion](/en/users/ciutacion)**
|
2 Sep 2022 at 14:10

Can someone help me I can't withdraw funds from my account.

![IcqMessenger](https://c.mql5.com/i/code/expert.png)
[IcqMessenger](/en/code/11456)

System of receiving information concerning opened positions' current state, account, etc., as well as automatic notification about operations via ICQ.

![Exp_ExchangePrice](https://c.mql5.com/i/code/expert.png)
[Exp\_ExchangePrice](/en/code/11372)

The Exp\_ExchangePrice EA is based on the signals of the ExchangePrice trend indicator.

![Exp_CronexMFI](https://c.mql5.com/i/code/expert.png)
[Exp\_CronexMFI](/en/code/2383)

The Exp\_CronexMFI is based on the signals generated by the CronexMFI oscillator.

![Exp_CronexRSI](https://c.mql5.com/i/code/expert.png)
[Exp\_CronexRSI](/en/code/2384)

The Exp\_CronexRSI is based on the signals generated by the CronexRSI oscillator.