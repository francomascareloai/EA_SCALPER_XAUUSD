# Export Positions History V1 - script for MetaTrader 5

Source: https://www.mql5.com/en/code/21434

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/21434) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# Export Positions History V1 - script for MetaTrader 5

[amrali](/en/users/amrali)  |
[English](javascript:void(false);)

[Русский](/ru/code/21434) [中文](/zh/code/21434) [Español](/es/code/21434) [Deutsch](/de/code/21434) [日本語](/ja/code/21434) [Português](/pt/code/21434)

Views:
:   11285

Rating:
:   (23)

Published:
:   26 July 2018, 15:59

Updated:
:   24 October 2021, 23:18
:   [dummy.mq5](/en/code/download/21434/dummy.mq5 "dummy.mq5")
    (0.67 KB)
    [view](# "view")

    \MQL5\Scripts\

    [Export\_History\_Positions.mq5](/en/code/download/21434/export_history_positions.mq5 "Export_History_Positions.mq5")
    (26.57 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/21434.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The script exports history of closed positions from MT5 retail hedging account selected between two dates. The resulting file is CSV that can be opened/imported with any spreadsheet software.

For **version 2** of the script, please go to [https://www.mql5.com/en/code/27683](/en/code/27683)

It supports only **retail hedging** accounts (Forex).

To export the entire trading history, keep **Start date** and **End date** at their default values.

![](https://c.mql5.com/18/94/Capture__9.PNG)

The CSV file will be auto-opened with the associated Windows program (e.g., Microsoft Excel or Ron's CSV Editor).

The output CSV file can be located at: Terminal > File > Open data folder > MQL5\Files\<Filename>

Following data columns are exported:

* **Open Time**
* **Ticket:** this is the position ID
* **Type**
* **Volume**
* **Symbol**
* **Open Price**
* **S/L**
* **T/P**
* **Close Time**
* **Close Price**
* **Commission**
* **Swap**
* **Profit**
* **Profit Points**
* **Balance,**this includes the running sum of all profits, swaps and commissions from previous trades
* **Magic Number**
* **Duration,** this includes duration of the position expressed in (hh:mm:ss) format
* **Open Reason****,** this includes reason of opening the position (client, mobile, web, expert)
* **Close Reason****,** this includes reason of closing the position (client, mobile, web, expert, sl, tp, so, ...)
* **Open Comment****,** this includes comment of the deal in for position
* **Close Comment****,** this includes comments of all the deals out for position
* **Deal In Ticket****,** this includes ticket of the deal in for position
* ****Deal Out Tickets**,** this includes tickets of all the deals out for position

The closed positions are reconstructed in a more convenient representation than the History tab of the MetaTrader 5 terminal.

The CSV file can be opened with Microsoft Excel or better with  Ron's CSV Editor.

[https://www.ronsplace.eu/Products/RonsEditor](/go?link=https://www.ronsplace.eu/Products/RonsEditor "https://www.ronsplace.eu/Products/RonsEditor")

**Note:**

To be able to calculate the running Balance in the correct chronological order, the option "**Order positions by:** " has to be set to "**Close time**", so that the list of positions is ordered by the time of closing (not by the opening times).

**Last comments |
[Go to discussion](/en/forum/268640)**
(9)

![amrali](https://c.mql5.com/avatar/2021/7/60EB6C17-183F.jpg "amrali")

**[amrali](/en/users/amrali)**
|
29 Dec 2020 at 13:13

**filipe197:**  

Hi guys,

After running my EA in the [backtesting](https://www.mql5.com/en/articles/2612 "Article \"Testing trading strategies on real ticks\""), I drag and drop the script into the chart but i'm only getting a csv with empty results. Only have the labels. What am I doing wrong?

The script should be run on live account

![filipe197](https://c.mql5.com/avatar/avatar_na2.png "filipe197")

**[filipe197](/en/users/filipe197)**
|
29 Dec 2020 at 15:27

**amrali:**  
 The script should be run on live account

Thanks for your reply. I understand that but can't I make use of this script to extract the trades information related to a [backtest](https://www.mql5.com/en/articles/2612 "Article \"Testing trading strategies on real ticks\"")?

![amrali](https://c.mql5.com/avatar/2021/7/60EB6C17-183F.jpg "amrali")

**[amrali](/en/users/amrali)**
|
30 Dec 2020 at 09:46

**filipe197:**  

Thanks for your reply. I understand that but can't I make use of this script to extract the trades information related to a [backtest](https://www.mql5.com/en/articles/2612 "Article \"Testing trading strategies on real ticks\"")?

Modify your EA and paste the script code inside  OnTester() function of your EA.

![Mikhail Shikin](https://c.mql5.com/avatar/avatar_na2.png "Mikhail Shikin")

**[Mikhail Shikin](/en/users/mihails80)**
|
12 May 2023 at 15:04

Hello.

I ran this script and it passed to XL a mush not structured by columns.

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Open Time,Ticket,Type,Volume,Symbol,Open Price,S/L,T/P,Close Time,Close Price,Commission,Swap,Profit,Profit Points,Balance,Magic Number,Duration,Open Reason,Close Reason,Open Comment,Close Comment,Deal In Ticket,Deal Out Tickets | | | | | | | | | | | | | | | | | | | | |
| 2022.01.04 17:57:39,268558289,buy,0.01,EURUSD,1.13147,,,2022.01.04 17:58:06,1.13110,0.00,0.00,-0.37,-37.0,-0.37,0,00:00:27,client,client,,,222353427,222353591 | | | | | | | | | | | | | | | |  |  |  |  |  |
| 2022.01.05 10:20:42,268646473,sell,0.01,EURUSD,1.13046,1.13411,1.11571,2022.01.05 10:31:27,1.13106,0.00,0.00,-0.60,-60.0,-0.97,910200201,00:10:45,expert,client,Expert id 910200201,,222420468,222422518 | | | | | | | | | | | | | | | | | | | |  |
| 2022.01.05 10:31:28,268648565,sell,0.01,EURUSD,1.13087,1.13450,1.11612,2022.01.05 10:31:40,1.13105,0.00,0.00,-0.18,-18.0,-1.15,910200201,00:00:12,expert,client,Expert id 910200201,,222422519,222422538 | | | | | | | | | | | | | | | | | | | |  |
| 2022.01.05 10:15:49,268646116,sell,0.04,EURUSD,1.13048,1.13372,1.11573,2022.01.05 10:31:51,1.13104,0.00,0.00,-2.24,-56.0,-3.39,910200001,00:16:02,expert,client,Expert id 910200001,,222420132,222422609 | | | | | | | | | | | | | | | | | | | |  |
| 2022.01.05 10:31:41,268648590,sell,0.01,EURUSD,1.13088,1.13451,1.11613,2022.01.05 11:04:37,1.13050,0.00,0.00,0.38,38.0,-3.01,910200201,00:32:56,expert,client,Expert id 910200201,,222422542,222425801 | | | | | | | | | | | | | | | | | | | |  |
| 2022.01.05 10:31:53,268648657,sell,0.02,EURUSD,1.13087,1.13386,1.11613,2022.01.05 14:59:39,1.13083,0.00,0.00,0.08,4.0,-2.93,910200001,04:27:46,expert,client,Expert id 910200001,,222422611,222453837 | | | | | | | | | | | | | | | | | | | |  |
| 2022.01.10 08:06:11,269221228,buy,0.02,EURUSD,1.13324,1.12940,1.14391,2022.01.10 16:02:16,1.12938,0.00,0.00,-7.72,-386.0,-10.65,910800101,07:56:05,expert,sl,Expert id 910800101,[sl 1.12940],222926543,223004606 | | | | | | | | | | | | | | | | | | | | |
| 2022.01.10 16:02:17,269306301,sell,0.02,EURUSD,1.12938,1.13322,1.11871,2022.01.10 19:05:19,1.13323,0.00,0.00,-7.70,-385.0,-18.35,910800101,03:03:02,expert,sl,Expert id 910800101,[sl 1.13322],223004623,223050972 | | | | | | | | | | | | | | | | | | | | |
| 2022.01.10 18:47:33,269352794,buy,0.01,EURUSD,1.13219,1.12839,1.14286,2022.01.12 18:42:15,1.14286,0.00,-0.14,10.67,1067.0,-7.82,918002201,1d 23:54:42,expert,tp,Expert id 918002201,[tp 1.14286],223048016,223364473 | | | | | | | | | | | | | | | | | | | | |
| 2022.01.10 19:05:21,269356116,buy,0.02,EURUSD,1.13324,1.12943,1.14391,2022.01.12 19:23:07,1.14391,0.00,-0.28,21.34,1067.0,13.24,910800101,2d 00:17:46,expert,tp,Expert id 910800101,[tp 1.14391],223050998,223372986 | | | | | | | | | | | | | | | | | | | | |
| 2022.01.18 15:05:45,270467218,buy,0.08,EURJPY,130.423,130.057,131.356,2022.01.18 17:04:34,130.056,0.00,0.00,-25.63,-367.0,-12.39,918001202,01:58:49,expert,sl,Expert id 918001202,[sl 130.057],223957533,223990938 | | | | | | | | | | | | | | | | | | | | |
| 2022.01.18 15:14:24,270469968,buy,0.08,EURUSD,1.13694,1.13313,1.14777,2022.01.18 18:24:26,1.13312,0.00,0.00,-30.56,-382.0,-42.95,918003201,03:10:02,expert,sl,Expert id 918003201,[sl 1.13313],223960298,224011365 | | | | | | | | | | | | | | | | | | | | |
| 2022.01.18 15:14:24,270469969,buy,0.16,EURUSD,1.13694,1.13313,1.14777,2022.01.18 18:24:26,1.13312,0.00,0.00,-61.12,-382.0,-104.07,918002201,03:10:02,expert,sl,Expert id 918002201,[sl 1.13313],223960299,224011366 | | | | | | | | | | | | | | | | | | | | |
| 2022.01.18 15:14:24,270469970,buy,0.16,EURUSD,1.13694,1.13313,1.14777,2022.01.18 18:24:26,1.13312,0.00,0.00,-61.12,-382.0,-165.19,918001201,03:10:02,expert,sl,Expert id 918001201,[sl 1.13313],223960300,224011367 | | | | | | | | | | | | | | | | | | | | |
| 2022.01.18 18:24:28,270523706,sell,0.08,EURUSD,1.13313,1.13695,1.12231,2022.01.19 05:21:19,1.13257,0.00,-0.06,4.48,56.0,-160.77,918001201,10:56:51,expert,client,Expert id 918001201,,224011423,224067576 | | | | | | | | | | | | | | | | | | | |  |
| 2022.01.19 05:39:48,270601882,sell,0.08,EURUSD,1.13264,1.13649,1.12185,2022.01.20 03:31:12,1.13650,0.00,-0.19,-30.88,-386.0,-191.84,918001201,21:51:24,expert,sl,Expert id 918001201,[sl 1.13649],224068787,224228196 | | | | | | | | | | | | | | | | | | | | |
| 2022.01.18 17:55:05,270515118,buy,0.02,EURUSD,1.13457,1.13074,1.14536,2022.01.20 03:47:54,1.13618,0.00,-0.55,3.22,161.0,-189.17,918004201,1d 09:52:49,expert,client,Expert id 918004201,,224003250,224229770 | | | | | | | | | | | | | | | | | | | | |
| 2022.01.18 18:24:28,270523703,sell,0.04,EURUSD,1.13313,1.13695,1.12231,2022.01.20 05:17:30,1.13543,0.00,-0.13,-9.20,-230.0,-198.50,918003201,1d 10:53:02,expert,client,Expert id 918003201,,224011421,224236469 | | | | | | | | | | | | | | | | | | | | |
| 2022.01.18 18:24:28,270523704,sell,0.08,EURUSD,1.13313,1.13695,1.12231,2022.01.20 05:17:32,1.13543,0.00,-0.25,-18.40,-230.0,-217.15,918002201,1d 10:53:04,expert,client,Expert id 918002201,,224011422,224236472 | | | | | | | | | | | | | | | | | | | | |
| 2022.01.20 03:31:13,270804486,buy,0.08,EURUSD,1.13652,1.13267,1.14731,2022.01.20 05:17:41,1.13526,0.00,0.00,-10.08,-126.0,-227.23,918001201,01:46:28,expert,client,Expert id 918001201,,224228209,224236474 | | | | | | | | | | | | | | | | | | | |  |
| 2022.01.18 17:17:36,270506158,sell,0.04,EURJPY,130.206,130.137,129.273,2022.01.20 18:28:00,129.273,0.00,-0.25,32.73,933.0,-194.75,918001202,2d 01:10:24,expert,tp,Expert id 918001202,[tp 129.273],223994747,224343794 | | | | | | | | | | | | | | | | | | | | |
| 2022.01.21 09:16:27,271086908,buy,0.01,EURUSD,1.13344,1.12959,1.14423,2022.01.21 09:17:30,1.13329,0.00,0.00,-0.15,-15.0,-194.90,918001201,00:01:03,expert,client,Expert id 918001201,,224466262,224466404 | | | | | | | | | | | | | | | | | | | |  |
| 2022.01.21 09:17:32,271087081,sell,0.02,EURUSD,1.13329,1.13704,1.12250,2022.01.27 02:56:17,1.12361,0.00,-0.11,19.36,968.0,-175.65,918001201,5d 17:38:45,expert,mobile,Expert id 918001201,,224466406,225291747 | | | | | | | | | | | | | | | | | | | | |
| 2022.02.02 13:40:29,273129032,sell,0.01,EURJPY,129.424,129.430,129.414,2022.02.03 07:15:14,129.414,0.00,-0.05,0.09,10.0,-175.61,918001202,17:34:45,expert,tp,Expert id 918001202,[tp 129.414],226220541,226335079 | | | | | | | | | | | | | | | | | | | | |
| 2022.02.03 07:15:14,273268357,sell,0.01,EURJPY,129.391,129.397,129.381,2022.02.03 08:06:51,129.401,0.00,0.00,-0.09,-10.0,-175.70,918001202,00:51:37,expert,sl,Expert id 918001202,[sl 129.397],226335080,226337418 | | | | | | | | | | | | | | | | | | | | |

 [![](https://c.mql5.com/3/408/318016126444__1.png)](https://c.mql5.com/3/408/318016126444.png "https://c.mql5.com/3/408/318016126444.png")

![Jerome Alan Wood](https://c.mql5.com/avatar/2023/10/653727e9-d2bc.jpg "Jerome Alan Wood")

**[Jerome Alan Wood](/en/users/jeromealanwood)**
|
30 Nov 2023 at 08:21

This code works great! I was wondering if you had a mq4 version?

![Price Zone Oscillator - Floating Levels Smoothed](https://c.mql5.com/i/code/indicator.png)
[Price Zone Oscillator - Floating Levels Smoothed](/en/code/21622)

In order to filter out some of the signals of the Price Zone Oscillator - Floating Levels indicator, smoothing is added to this version.

![Price Zone Oscillator - Smoothed](https://c.mql5.com/i/code/indicator.png)
[Price Zone Oscillator - Smoothed](/en/code/21621)

This version of Price Zone Oscillator is an attempt to solve the "too fast" slope issue of the original indicator.

![Range Oscillator - Smoothed](https://c.mql5.com/i/code/indicator.png)
[Range Oscillator - Smoothed](/en/code/21634)

This version of Range Oscillator has smoothing option in order to avoid some false signals.

![Range Oscillator + Bands (Smoothed)](https://c.mql5.com/i/code/indicator.png)
[Range Oscillator + Bands (Smoothed)](/en/code/21635)

This version is the smoothed version of the original Range Oscillator + Bands indicator. Smoothing is cleaning up some false signals and, since the smoothing method is JMA (which has very small lag) the added lag is as small as it can be making it much easier to use in a lot of decision situations.