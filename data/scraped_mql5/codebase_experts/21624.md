# RSI MA EA - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/21624

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/21624) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# RSI MA EA - expert for MetaTrader 4

[Brian Lillard](/en/users/subgenius)

Views:
:   30829

Rating:
:   (12)

Published:
:   3 August 2018, 11:12

Updated:
:   6 August 2018, 14:51
:   [MA-RSI-EA.mq4](/en/code/download/21624/ma-rsi-ea.mq4 "MA-RSI-EA.mq4")
    (10.23 KB)
    [view](# "view")

    [MA-RSI-EAv2.mq4](/en/code/download/21624/ma-rsi-eav2.mq4 "MA-RSI-EAv2.mq4")
    (12.16 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/21624.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

What I have is an EA working from 2000, but it is not optimized.

The EA works by Moving Average trend and RSI signals at overbought & oversold areas. It doesn't have targets but instead closes with soonest profits, so it's purpose is to always win. The inputs include money management and indicator settings; the signals occur when the RSI is in overbought or oversold and price has moved above or below moving average price.

V1 is tested and working on the following pairs & timeframes from **2000.01.01 - 2018.06.30** with **tick data suite** and **500.00**:

* EURUSD: D1 - H4 - H1 - M30 - M5 (spread of 4)
* GBPUSD: H1 - M30 - M5 (spread of 6)
* USDCHF: D1 - H1 (spread of 6)
* USDJPY: H4 - M30 - M15 (spread of 6)
* AUDUSD: H4 - M30 (spread of 5)
* USDCAD: D1, H4 - H1 - M30 (spread of 5)
* NZDUSD: D1 - H4 - M30 - M15 - M5 (spread of 6)
* GBPJPY: D1 - H4 - H1 - M30 - M15 - M5 - M1 (spread of 8)
* USDSGD: D1 - H4 - M15 (spread of 8)
* AUDCAD: D1 - H1 - M30 - M15 (spread of 8)
* Possibly more ..

V1 tends to have trades open for extended periods of time and on higher timeframes especially.

![RSI MA EA](https://c.mql5.com/18/72/Capture__2.PNG "RSI MA EA")

V2 manages volume and uses lots of margin so it means you need a high leverage to minimize drawdown.

Be sure to use low spread & commission and test with the best data as always.

**Last comments |
[Go to discussion](/en/forum/270514)**
(4)

![Noris Finanz GmbH](https://c.mql5.com/avatar/2016/5/574CAFAC-4E7D.jpg "Noris Finanz GmbH")

**[Filippo La Spina](/en/users/frlaspina)**
|
16 Aug 2018 at 15:47

Hello,

looks good. Is the EA already in a [real account](https://www.mql5.com/en/docs/constants/environment_state/accountinformation#enum_account_trade_mode "MQL5 documentation: Account Properties")?

![Billrhys](https://c.mql5.com/avatar/avatar_na2.png "Billrhys")

**[Billrhys](/en/users/billrhys)**
|
17 Oct 2018 at 20:38

Hello Brian. Thank you so much for the EA. I will be very grateful if you will please look into the warnings that are showing when you compile the EA in Meta Editor and resolve them. I am attaching an image of the warnings below.

![Brian Lillard](https://c.mql5.com/avatar/2023/3/640988fd-3ec4.png "Brian Lillard")

**[Brian Lillard](/en/users/subgenius)**
|
20 Oct 2018 at 00:39

Yes, but not as problematic as not having a max spread variable but could use a retry count and error debug to be on the safe side.

![Thibaut Bonacorsi](https://c.mql5.com/avatar/2022/4/624B09C4-4095.png "Thibaut Bonacorsi")

**[Thibaut Bonacorsi](/en/users/tirbo)**
|
3 Oct 2022 at 10:51

**Billrhys [#](/en/forum/270514#comment_9049100):**  
 Hello Brian. Thank you so much for the EA. I will be very grateful if you will please look into the warnings that are showing when you compile the EA in Meta Editor and resolve them. I am attaching an image of the warnings below.

//HERE =>

```mql5
//+------------------------------------------------------------------+

#property copyright "Copyright © 2018, Brian Lillard"

#property link "https://www.mql5.com/en/users/subgenius/seller"

#property version   "1.00"

#property strict





enum OptLot{Fixed=0,/*Fixed Lot*/Equity=1,/*% Equity*/Balance=2/*% Balance*/};

//+------------------------------------------------------------------+

input OptLot              LotOption         = Fixed;                     //Lot Value Mode

input double              LotSize           = 0.01;                      //*Fixed Lot

input double              PercentOfBalance  = 0.02;                      //*Percentage of Balance

input double              PercentOfEquity   = 0.03;                      //*Percentage of Equity

//+------------------------------------------------------------------+

input int                 FastMAperiod      = 4;                         //MA Period

input int                 FastMAshift       = 0;                         //MA Shift

input ENUM_MA_METHOD      FastMAmethod      = MODE_LWMA;                 //MA Method

input ENUM_APPLIED_PRICE  FastMAprice       = PRICE_OPEN;                //MA Price

//+------------------------------------------------------------------+

input int                 RSIperiod         = 4;

input ENUM_APPLIED_PRICE  RSIprice          = PRICE_OPEN;

input int                 RSIoverbought     = 80;

input int                 RSIoversold       = 20;

//+------------------------------------------------------------------+

input int                 Magic=1;

//+------------------------------------------------------------------+

int intSellsOpen,intBuysOpen; double CumulativePL;

//+------------------------------------------------------------------+

double dRSI(){return(iRSI(NULL,0,RSIperiod,RSIprice,0));}

double dMA(){return(iMA(NULL,0,FastMAperiod,0,FastMAmethod,FastMAprice,0));}

bool newCandle(){ static datetime nCandle; if(nCandle==Time[0]) return(false); nCandle=Time[0]; return(true); }





//+------------------------------------------------------------------+

void LABEL(string sName,string sText,string sFont,int iFontSize,color cFontColor,int iCorner,int iX,int iY)

  {

   if(ObjectFind(sName)==-1){ ObjectCreate(sName,OBJ_LABEL,0,0,0); }

   else{ if(!IsTesting()){ ObjectDelete(sName);ObjectCreate(sName,OBJ_LABEL,0,0,0); }  }

   ObjectSetText(sName,sText,iFontSize,sFont,cFontColor);

   ObjectSet(sName,OBJPROP_CORNER,iCorner);

   ObjectSet(sName,OBJPROP_XDISTANCE,iX);

   ObjectSet(sName,OBJPROP_YDISTANCE,iY);

  }

//+------------------------------------------------------------------+

int OnInit(){ return(INIT_SUCCEEDED); }

//+------------------------------------------------------------------+

void OnDeinit(const int reason)

  {

   HideTestIndicators(true);

   ObjectDelete("LABEL1");

   ObjectDelete("LABEL2");

   ObjectDelete("LABEL3");

  }

//+------------------------------------------------------------------+

bool OpenOrdersFound()

  {

   intSellsOpen=0; intBuysOpen=0; CumulativePL=0;

   int OrdersOT=OrdersTotal();

   for(int X=0; X<OrdersOT; X++)

     {

      if(!OrderSelect(X,SELECT_BY_POS,MODE_TRADES) || OrderMagicNumber()!=1){continue;}

      if(OrderType()==OP_SELL){ intSellsOpen++; }else if(OrderType()==OP_BUY){ intBuysOpen++; }

      CumulativePL+=OrderProfit()+OrderCommission()+OrderSwap();

     }

   if(intSellsOpen+intBuysOpen>0){ return(true); }

   return(false);

  }

//+------------------------------------------------------------------+

double dNextLot()

  {

   double Lot=LotSize;

   if(LotOption==Equity){ Lot=PercentOfEquity*AccountEquity()/10000; }

   if(LotOption==Balance){ Lot=PercentOfBalance*AccountBalance()/10000; }

   if( Lot<NormalizeDouble(MarketInfo(NULL,MODE_MINLOT),2) ){ Lot=NormalizeDouble(MarketInfo(NULL,MODE_MINLOT),2); }

   if( Lot>NormalizeDouble(MarketInfo(NULL,MODE_MAXLOT),2) ){ Lot=NormalizeDouble(MarketInfo(NULL,MODE_MAXLOT),2); }

   return(Lot);

  }

//+------------------------------------------------------------------+





void OnTick()

  {

   if(!newCandle()){return;}

   OpenOrdersFound();

   if(CumulativePL>0){ CloseAll(); }

   if(dRSI()>=RSIoverbought && Open[0]<dMA())

     {

      if (!OrderSend(NULL,OP_SELL,dNextLot(),NormalizeDouble(Ask,Digits),100,0,0,NULL,Magic,0,clrNONE))

      {

      Print("BUY ORDER FAILED!");

      }

     }

   else

     {

      if(dRSI()<=RSIoversold && Open[0]>dMA())

        {

         if (!OrderSend(NULL,OP_BUY,dNextLot(),NormalizeDouble(Bid,Digits),100,0,0,NULL,Magic,0,clrNONE))

         {

         Print("SELL ORDER FAILED!");

         }

        }

     }

   LABEL("LABEL1","PROFIT & LOSS: "+DoubleToString(CumulativePL,2),"Arial",12,Orange,3,5,35);

   LABEL("LABEL2","EQUITY: "+DoubleToString(AccountEquity(),2),"Arial",12,Orange,3,5,20);

   LABEL("LABEL9","BALANCE: "+DoubleToString(AccountBalance(),2),"Arial",12,Orange,3,5,5);

  }

  

  

  

//+------------------------------------------------------------------+

void CloseAll()

  {

   for(int OrdersOT=OrdersTotal()-1; OrdersOT>=0; OrdersOT--)

     {

      if(!OrderSelect(OrdersOT,SELECT_BY_POS,MODE_TRADES) || OrderMagicNumber()!=1){continue;}

      if (!OrderClose(OrderTicket(),OrderLots(),OrderClosePrice(),Magic,clrNONE))

      {

      Print("CLOSE ORDER FAILED");

      }

     }

  }

//+------------------------------------------------------------------+


```

![KeyboardTrade](https://c.mql5.com/i/code/library.png)
[KeyboardTrade](/en/code/21360)

This tool is for trading with keyboard input, it supports "Send order", "Set Stop Loss", "Set Take Profit", and "Close order".

![Automatic Fibonacci Lines MrVB](https://c.mql5.com/i/code/indicator.png)
[Automatic Fibonacci Lines MrVB](/en/code/21516)

AutoFibLinesMrVB indicator draws automatically the Fibonacci levels on the chart.

![Renko-Fractals-Grid](https://c.mql5.com/i/code/expert.png)
[Renko-Fractals-Grid](/en/code/21760)

This EA uses "Renko" box size on MetaTrader 4 chart. When the price reaches the level where there was a fractal, the EA enters a trade, has Trailing Stop Loss &Take Profit works on all time frames major forex pairs and stocks NASDAQ.

![Tap4Fibs](https://c.mql5.com/i/code/indicator.png)
[Tap4Fibs](/en/code/21705)

Creates Fibonacci Retracement on the chart based on the ZigZag indicator. Tap the "X" or "Z" key to scroll through each swing in the ZigZag, to the right or to the left. For those who do not like clutter on their charts. The indicator can scroll to the right until it disappears from the chart, but it is still there. Scroll left to bring it back. This is one of the most useful tools in my trading toolbox!