# Close Basket Pairs v1 - expert for MetaTrader 4

Source: https://www.mql5.com/en/code/49145

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/49145) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Experts](https://c.mql5.com/i/code/expert.png)

# Close Basket Pairs v1 - expert for MetaTrader 4

Closing Basket Pairs by positive or negative amount in account equity

Published by:
:   [Deleted]

Views:
:   5377

Rating:
:   (3)

Published:
:   10 April 2024, 02:15

Updated:
:   10 April 2024, 02:24
:   [Close Basket Pairs V1.mq4](/en/code/download/49145/close_basket_pairs_v1.mq4 "Close Basket Pairs V1.mq4")
    (7.08 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/49145.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

This MQL4 script is designed to close positions for a basket of currency pairs based on certain profit and loss thresholds. Here's a brief description:

* The script is called "CloseBasketPairs.mq4".
* It is copyrighted by MetaQuotes Software Corp. in 2024.
* It provides a link to the MetaQuotes website.
* The version of the script is 1.01.
* The script is authored by "persinaru@gmail.com".
* The script is licensed under the IP 2024 - free open source.
* The main purpose of the script is to close positions for a basket of currency pairs when certain profit or loss thresholds are met.
* It is a warning that the script should be used at your own risk, and the creator cannot be held responsible for any damage or loss.

The script defines the pairs in the basket and their respective order types, along with profit and loss thresholds. It loops through all open positions and checks if they belong to the defined basket pairs. If a position meets the criteria (profit exceeding the profit threshold or loss exceeding the loss threshold), it closes the position.

Finally, it provides functions for initialization, deinitialization, and handling tick events. The PrintStrategyInfo() function is used to print information about the strategy.

[![](https://c.mql5.com/18/155/Screenshot_2024-04-09_171224__1.png)](https://c.mql5.com/18/155/Screenshot_2024-04-09_171224.png "https://c.mql5.com/18/155/Screenshot_2024-04-09_171224.png")

[![](https://c.mql5.com/18/155/Screenshot_2024-04-09_171235__1.png)](https://c.mql5.com/18/155/Screenshot_2024-04-09_171235.png "https://c.mql5.com/18/155/Screenshot_2024-04-09_171235.png")

**Last comments |
[Go to discussion](/en/forum/465386)**
(5)

![speedytina](https://c.mql5.com/avatar/avatar_na2.png "speedytina")

**[speedytina](/en/users/speedytina)**
|
9 Jan 2025 at 20:33

Is this a script or an EA? The description seems to be using both terms interchangeably.

![Silk Road Trading LLC](https://c.mql5.com/avatar/2025/5/68239006-fc9d.png "Silk Road Trading LLC")

**[Ryan L Johnson](/en/users/rjo)**
|
9 Jan 2025 at 23:19

**speedytina [#](/en/forum/465386#comment_55591179):**  
 Is this a script or an EA? The description seems to be using both terms interchangeably.

Based on the fact that

```mql5
#property show_inputs
```

appears up top in the code, it's a script.

![Fernando Carreiro](https://c.mql5.com/avatar/2025/9/68d40cf8-38fb.png "Fernando Carreiro")

**[Fernando Carreiro](/en/users/fmic)**
|
9 Jan 2025 at 23:39

**[@Ryan L Johnson](/en/users/rjo) [#](/en/forum/465386#comment_55591948):** Based on the fact that ... appears up top in the code, it's a script.

Actually, not quite! It seems that the author has incorrectly mixed up a few concepts, making the code somewhat invalid. In fact, "show\_inputs" is not even a valid property, but "script\_show\_inputs" is valid.

However, the most important aspects to make the program work, are the event handlers. In this case, there is no *OnStart()* event handler, so it will not run as a *Script*. Instead it will be treated as an ***Expert Advisor***, because there are *OnInit()* and *OnTick()* event handlers.

![Silk Road Trading LLC](https://c.mql5.com/avatar/2025/5/68239006-fc9d.png "Silk Road Trading LLC")

**[Ryan L Johnson](/en/users/rjo)**
|
10 Jan 2025 at 00:17

**Fernando Carreiro [#](/en/forum/465386#comment_55591964):**  

Actually, not quite! It seems that the author has incorrectly mixed up a few concepts, making the code somewhat invalid. In fact, "show\_inputs" is not even a valid property, but "script\_show\_inputs" is valid.

However, the most important aspects to make the program work, are the event handlers. In this case, there is no *OnStart()* event handler, so it will not run as a *Script*. Instead it will be treated as an ***Expert Advisor***, because there are *OnInit()* and *OnTick()* event handlers.

Well, that certainly explains the "**Published by: [Deleted]**" status of the author.üòê

![speedytina](https://c.mql5.com/avatar/avatar_na2.png "speedytina")

**[speedytina](/en/users/speedytina)**
|
13 Jan 2025 at 20:09

**Ryan L Johnson [#](/en/forum/465386#comment_55592270):**  

Well, that certainly explains the "**Published by: [Deleted]**" status of the author.üòê

Thank you, gentlemen. I don't know coding, but I was puzzled about the description switching between EA and script. The fact that the publisher was deleted also gave me pause. Was not a fan of having to list every pair in a basket along with whether or not it was a buy or sell. It makes for a lot of work and attention to detail if one trades a more sizable basket. I was hoping for a 'close all' EA.

Thanks again for your comments.

![Reverse Trades For All Symbols Script](https://c.mql5.com/i/code/script.png)
[Reverse Trades For All Symbols Script](/en/code/49137)

Reverses all open trades after Closure for all symbols .

![Trailing_StopLoss_for All_orders_and_symbols](https://c.mql5.com/i/code/expert.png)
[Trailing\_StopLoss\_for All\_orders\_and\_symbols](/en/code/49083)

Trailing\_StopLoss\_for All\_orders\_and\_symbols

![Virtual SL TP Pending with SL Trailing for Symbol Chart](https://c.mql5.com/i/code/expert.png)
[Virtual SL TP Pending with SL Trailing for Symbol Chart](/en/code/49146)

Virtual SL TP Pending with SL Trailing for Symbol Chart

![Classic and Virtual Trailing](https://c.mql5.com/i/code/expert.png)
[Classic and Virtual Trailing](/en/code/49326)

Classic & Virtual Trailing for MT4