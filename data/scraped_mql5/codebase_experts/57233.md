# Introsort (Introspective sort) using Function Pointers - library for MetaTrader 5

Source: https://www.mql5.com/en/code/57233

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/57233) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Libraries](https://c.mql5.com/i/code/library.png)

# Introsort (Introspective sort) using Function Pointers - library for MetaTrader 5

[amrali](/en/users/amrali)  |
[English](javascript:void(false);)

[Русский](/ru/code/57233) [中文](/zh/code/57233) [Español](/es/code/57233) [Deutsch](/de/code/57233) [日本語](/ja/code/57233) [Português](/pt/code/57233) [한국어](/ko/code/57233) [Français](/fr/code/57233) [Italiano](/it/code/57233) [Türkçe](/tr/code/57233)

Views:
:   1684

Rating:
:   (5)

Published:
:   18 March 2025, 23:14

Updated:
:   31 October 2025, 16:58
:   \MQL5\Scripts\Introsort\_FuncPtr\

    [Introsort.mqh](/en/code/download/57233/Introsort.mqh "Introsort.mqh")
    (21.58 KB)
    [view](# "view")

    [Introsort\_benchmark.mq5](/en/code/download/57233/Introsort_benchmark.mq5 "Introsort_benchmark.mq5")
    (3.23 KB)
    [view](# "view")

    [sort\_simple\_array.mq5](/en/code/download/57233/sort_simple_array.mq5 "sort_simple_array.mq5")
    (2.51 KB)
    [view](# "view")

    [sort\_MqlRates.mq5](/en/code/download/57233/sort_MqlRates.mq5 "sort_MqlRates.mq5")
    (3.46 KB)
    [view](# "view")

    [sort\_MqlRates\_macro.mq5](/en/code/download/57233/sort_MqlRates_macro.mq5 "sort_MqlRates_macro.mq5")
    (1.86 KB)
    [view](# "view")

    [sort\_struct\_array\_custom.mq5](/en/code/download/57233/sort_struct_array_custom.mq5 "sort_struct_array_custom.mq5")
    (4.56 KB)
    [view](# "view")

    [sort\_object\_ptrs\_array.mq5](/en/code/download/57233/sort_object_ptrs_array.mq5 "sort_object_ptrs_array.mq5")
    (4.88 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/57233.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

## Introspective Sort

This is a revised version of the [original Introsort library](/en/code/41836), now the Introsort() function accepts an optional function pointer to custom comparison function.

Intro or Introspective sort is a hybrid sorting algorithm that provide fast performance. It is a comparison based sorting algorithm based on three phases. It uses the quicksort sort along with heapsort and insertion-sort algorithms.

**Quick Sort**  
Quick sort is a divide and conquer algorithm which works by selecting a pivot element in the array, then partitions the other elements into two subarrays checking the condition whether the elements are greater or smaller. On average the quick sort alogirthm takes O(nlog(n)) time, with worst case complexity of O(n2).

**Heap Sort**  
Heap sort algoirthm is a binary-heap based comparison based sorting method. It is an unstable sorting algorithm with worst case and average case time complexity of O(nlog(n)), and best case time complexity of O(n).

**Insertion Sort**  
Insertion sort algorithm is a simple sorting method that builds the final sorted array one item at a time. It's time complexity for worst case and average case is O(n2) and best case is O(n).

Introsort algorithm combines the good parts of these three algorithms. It begins with quick sort, switching to heapsort when the recursion depth exceeds a level based on the number of elements begin sorted and switchs to insertion sort when the number of elements are less than some threshold value.

* If the partition size is such that there is a possibility to exceed the maximum depth limit then the Introsort switches to Heapsort.
* If the partition size is too small then Quicksort switches to Insertion Sort.
* If the partition size is under the limit and not too small, then it performs a simple quicksort.

Introsort has particularly good runtime behavior. It is one of the fastest comparison sorting, algorithms in use today, and is the usual implementation of the std::sort algorithm provided with the C++ STL, Microsoft .NET Framework Class Library, GNU Standard C++ library, and LLVM libc++ library.

**References**:

[http://en.wikipedia.org/wiki/Introsort](https://en.wikipedia.org/wiki/Introsort "https://en.wikipedia.org/wiki/Introsort")

[https://iq.opengenus.org/intro-sort/](/go?link=https://iq.opengenus.org/intro-sort/ "https://iq.opengenus.org/intro-sort/")

**Code:**

```mql5
//+------------------------------------------------------------------+
//| Introsort                                                        |
//+------------------------------------------------------------------+
/**
 * Sort the input array in-place using comparison function less.
 * You can specify your own comparison function. If no function is
 * specified, ascending sort is used.
 */
template<typename T>
void Introsort(T &arr[]);

//+------------------------------------------------------------------+
//| Introsort using a pointer to custom Less() function.             |
//| A custom Less() function takes two arguments and contains logic  |
//| to decide their relative order in the sorted array. The idea is  |
//| to provide flexibility so that Introsort() can be used for any   |
//| type (including user defined types like objects or structures)   |
//| and can be used to obtain any desired sort order (ascending,     |
//| descending or custom order of structure fields).                 |
//+------------------------------------------------------------------+
template<typename T, typename LessFunc>
void Introsort(T &arr[], LessFunc pfnLess);

```

**Comparison function Less:**

You can specify your own comparison function. If no function is specified, ascending sort is used. A custom Less() function takes two arguments and contains logic to decide their relative order in the sorted array. The idea is to provide flexibility so that Introsort() can be used for any type (including user defined types) and can be used to obtain any desired order (increasing, decreasing or any other). For example, to sort an array of objects or structures (user defined types) in a custom sort order:

```mql5
bool MyLessFunc(const MyStruct &x, const MyStruct &y)
  {
//--- sort by A (asc)
   if(x.A < y.A) return(true);
   if(x.A > y.A) return(false);

//--- if equal on A, sort by B (asc)
   if(x.B < y.B) return(true);
   if(x.B > y.B) return(false);

//--- if equal on B, sort by C (asc)
   if(x.C < y.C) return(true);
   if(x.C > y.C) return(false);

//--- all keys are equal
   return(false);
  }


// Define a pointer type to custom Less function.
typedef bool (*pLess)(const MyStruct &x, const MyStruct &y);


// Sort array of structures using custom Less function.
Introsort(structArray, (pLess)MyLessFunc);
    
```

**Convenient macros to sort array of structures (e.g., MqlRates):**

```mql5
//+------------------------------------------------------------------+
//| Convenient macro to sort array of type 'T' by field              |
//+------------------------------------------------------------------+
#define INTROSORT_STRUCT(T, array, field)                            


//+------------------------------------------------------------------+
//| Convenient macro to sort array of type 'T' by two fields         |
//+------------------------------------------------------------------+
#define INTROSORT_STRUCT_2(T, array, F1, F2)                          

```

[![](https://c.mql5.com/18/170/Screenshot_2025-10-31_194629__1.png)](https://c.mql5.com/18/170/Screenshot_2025-10-31_194629.png "https://c.mql5.com/18/170/Screenshot_2025-10-31_194629.png")

**[Go to discussion](/en/forum/483147)**

![Supertrend](https://c.mql5.com/i/code/indicator.png)
[Supertrend](/en/code/57063)

A SuperTrend indicator that plots trend direction using ATR volatility to create dynamic support/resistance levels for MetaTrader 5.

![BarDuration](https://c.mql5.com/i/code/indicator.png)
[BarDuration](/en/code/57038)

This is a simple indicator to display histogram of custom bars' durations in minutes. Applicable for renko boxes, PnF, equivolume bars, etc.

![Trend Zigzag (on ma cross)](https://c.mql5.com/i/code/indicator.png)
[Trend Zigzag (on ma cross)](/en/code/57302)

A static zigzag which connects the intersections of a moving average crossover

![FVG based Momentum Detection](https://c.mql5.com/i/code/indicator.png)
[FVG based Momentum Detection](/en/code/57377)

This is an indicator that evaluates FVGs in the inputted "window\_size" to detect momentum or trend strength.