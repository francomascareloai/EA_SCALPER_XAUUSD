# A script for a tester that extends the standard MetaTrader 5 optimisation features - script for MetaTrader 5

Source: https://www.mql5.com/en/code/63121

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/63121) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# A script for a tester that extends the standard MetaTrader 5 optimisation features - script for MetaTrader 5

сборник  |
[English](javascript:void(false);)

[Русский](/ru/code/63121) [中文](/zh/code/63121) [Español](/es/code/63121) [Deutsch](/de/code/63121) [日本語](/ja/code/63121) [Português](/pt/code/63121) [한국어](/ko/code/63121) [Français](/fr/code/63121) [Italiano](/it/code/63121) [Türkçe](/tr/code/63121)

Published by:
:   [Vladimir Novikov](/en/users/vanov1981)

Views:
:   1388

Rating:
:   (5)

Published:
:   27 September 2025, 12:54
:   [World-Class Parameter Validation Function.mq5](/en/code/download/63121/World-Class_Parameter_Validation_Function.mq5 "World-Class Parameter Validation Function.mq5")
    (13.54 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/63121.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Explanation of the code and its application

## What is this code?

This code is a**custom optimisation function** for the  MetaTrader 5 Strategy Tester. It is not an Expert Advisor, indicator or script in the classical sense, but a special script for analysing test results.

## How the code works:

### 1. Data collection

* Gets the history of trades from the tester
* Checks minimum requirements (at least 50 trades)
* Determines initial deposit and time periods

### 2. Splits the data

* Splits trades into two periods:

  + In-Sample (IS) - the first 70% of the testing period
  + Out-of-Sample (OOS) - the last 30% of the period with a 1-day interval

### 3. Calculation of metrics

Calculates a set of metrics for both periods:

* Profitability and drawdown
* Sharpe and Sortino ratios
* Profit factor and probability of profitable transactions
* Statistical indicators (skewness, kurtosis)
* Special metrics (Serenity Ratio)

### 4. Statistical analysis

* Compares IS and OOS distributions using the Kolmogorov-Smirnov test
* Checks normality of distributions using the Jarque-Bera test

### 5. Strategy evaluation

Creates a comprehensive strategy evaluation that takes into account:

* Profitability (30%)
* Consistency of results (30%)
* Risk-adjusted performance (25%)
* Statistical quality (15%)

## Where to use this code:

### 1. strategy optimisation

* Place the code in the MQL5/Scripts/ folder.
* In the strategy tester, select "Custom optimisation criterion"
* Use this script to evaluate the results of optimisation

### 2. Strategy validation

* Use to validate the stability of the strategy
* Analyse discrepancies between IS and OOS periods
* Identification of over-optimised strategies

### 3. Comparison of strategies

* To objectively compare different strategies
* To rank strategies according to a comprehensive criterion

## Advantages of the approach:

* Minimising over-optimisation through data partitioning
* Comprehensive evaluation takes into account múltiples aspects of performance
* Statistical verification of the robustness of the results
* Automatic screening of non-viable strategies

## Important Notes:

* Requires a significant number of trades (at least 50)
* Need sufficient historical period to split into IS/OOS
* Code returns -DBL\_MAX for strategies that do not pass minimum requirements

This approach is particularly useful for traders and developers who want to take testing and optimising trading strategies seriously, minimising the risk of fitting to historical data.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/63121](/ru/code/63121)

![3 way Aroon value calculation](https://c.mql5.com/i/code/script.png)
[3 way Aroon value calculation](/en/code/64175)

Showing different ways of the Aroon values calculation

![Pinbar Detector](https://c.mql5.com/i/code/indicator.png)
[Pinbar Detector](/en/code/63932)

This MQL5 indicator identifies Upward (Bullish) and Downward (Bearish) Pinbars, displayed with customizable arrows (lime for upward, red for downward). It allows fine-tuning of detection parameters like tail body ratio and protrusion. Pop-up and push notification alerts signal new pinbars. Ideal for traders seeking precise reversal pattern detection.

![Balance Of Power](https://c.mql5.com/i/code/indicator.png)
[Balance Of Power](/en/code/63099)

The Balance of Power (BOP) is an indicator originally developed by Igor Livshin in 2001 to measure the balance of power between buyers and sellers during each candle.

![PriceVar](https://c.mql5.com/i/code/indicator.png)
[PriceVar](/en/code/63139)

PriceVar% is an indicator designed to measure the percentage difference between the price and a moving average, highlighting the strength of the market movement in relation to a reference value.