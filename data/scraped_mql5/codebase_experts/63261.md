# Simplest CSV file writer - script for MetaTrader 5

Source: https://www.mql5.com/en/code/63261

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/63261) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# Simplest CSV file writer - script for MetaTrader 5

[Denis Kislicyn](/en/users/deniskislitsyn)  |
[English](javascript:void(false);)

[Русский](/ru/code/63261) [中文](/zh/code/63261) [Español](/es/code/63261) [Deutsch](/de/code/63261) [日本語](/ja/code/63261) [Português](/pt/code/63261) [한국어](/ko/code/63261) [Français](/fr/code/63261) [Italiano](/it/code/63261) [Türkçe](/tr/code/63261)

Views:
:   2716

Rating:
:   (4)

Published:
:   1 September 2025, 20:26
:   \MQL5\Include\

    [DKSimplestCSVWriter.mqh](/en/code/download/63261/DKSimplestCSVWriter.mqh "DKSimplestCSVWriter.mqh")
    (7.62 KB)
    [view](# "view")

    [DKSimplestCSVWriter\_Example.mq5](/en/code/download/63261/DKSimplestCSVWriter_Example.mq5 "DKSimplestCSVWriter_Example.mq5")
    (2.28 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/63261.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Use this simplest class to write CSV file with out any preparations and types casting declarations.

Find the shortest usage example below.

```mql5
  string Filename = "filename_writer.csv";

  CDKSimplestCSVWriter CSVFile; // Create class object

  // Add first row and set values by column name
  CSVFile.AddRow();
  CSVFile.SetLastRowValue("Time", TimeToString(TimeCurrent(), TIME_DATE|TIME_MINUTES));
  CSVFile.SetLastRowValue("Open", DoubleToString(SymbolInfoDouble(Symbol(), SYMBOL_BID), _Digits));
  CSVFile.SetLastRowValue("Close", DoubleToString(SymbolInfoDouble(Symbol(), SYMBOL_ASK), _Digits));

  // Add second row using returned row index and SetValue by name
  uint r = CSVFile.AddRow();
  CSVFile.SetValue(r, "Time", TimeToString(TimeCurrent() + 60, TIME_DATE|TIME_MINUTES));
  CSVFile.SetValue(r, "Open", DoubleToString(SymbolInfoDouble(Symbol(), SYMBOL_BID), _Digits));
  CSVFile.SetValue(r, "Close", DoubleToString(SymbolInfoDouble(Symbol(), SYMBOL_ASK), _Digits));

  // Demonstrate SetValue by column index (index 0..n-1). Here we set first column of first row to a custom value
  if (CSVFile.RowCount() > 0 && CSVFile.ColumnCount() > 0)
    CSVFile.SetValue(0, 0, "CUSTOM_TIME");

  // Write CSV to file. Pass FILE_ANSI to write ANSI encoded file if desired.
  if (CSVFile.WriteCSV(Filename, true, ";", FILE_ANSI)) {
    PrintFormat("Successfully wrote %d rows with %d columns to: %s", 
                CSVFile.RowCount(), CSVFile.ColumnCount(), Filename);
  } else {
    PrintFormat("Error writing CSV file: %s", Filename);
  }

  // Optional: clear memory
  CSVFile.Clear();
```

**[Go to discussion](/en/forum/494434)**

![Fractal CCI FIlter](https://c.mql5.com/i/code/indicator.png)
[Fractal CCI FIlter](/en/code/62145)

Fractal with CCI Filter - Indicator that combines traditional fractals with the CCI filter to reduce false signals. Shows red arrows above the candles for bullish fractals (sell) when the CCI is above the configured threshold and green arrows below the candles for bearish fractals (buy) when the CCI is below the negative threshold. Perfect for identifying reversal points with greater reliability.

![ZigZag WaveSize](https://c.mql5.com/i/code/indicator.png)
[ZigZag WaveSize](/en/code/62147)

Modified standard ZigZag indicator with the addition of information about wavelength in pips, levels and different alerts logic

![HedgeCover EA](https://c.mql5.com/i/code/expert.png)
[HedgeCover EA](/en/code/63299)

Intelligent position protection with one-hedge-per-position logic. Features magic number separation, cooldown timer, and max hedges limit. Prevents infinite hedging loops. Free MIT license.

![Risk Calculator](https://c.mql5.com/i/code/expert.png)
[Risk Calculator](/en/code/63316)

Instantly calculate the profit and loss potential of your trades directly on the chart. An essential tool for agile and precise risk management.