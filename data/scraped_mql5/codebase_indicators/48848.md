# Correlation Gaps Trading AUDJPY CADJPY NZDJPY - script for MetaTrader 4

Source: https://www.mql5.com/en/code/48848

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/48848) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# Correlation Gaps Trading AUDJPY CADJPY NZDJPY - script for MetaTrader 4

[Deleted]

Views:
:   4269

Rating:
:   (4)

Published:
:   26 March 2024, 13:30

Updated:
:   30 March 2024, 15:31
:   [Correlation\_Gaps\_AUD\_CAD\_NAZD\_Vs\_JPY\_V1.mq4](/en/code/download/48848/correlation_gaps_aud_cad_nazd_vs_jpy_v1.mq4 "Correlation_Gaps_AUD_CAD_NAZD_Vs_JPY_V1.mq4")
    (5.01 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/48848.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

![](https://c.mql5.com/18/154/Hedge.JPG)

text{PipValue\_A} \times \text{Position\_A} = \text{PipValue\_B} \times \text{Position\_B}

Watch for gaps in the correlation between two trading instruments and trade one pair against the other.

It is advisable not to leave the trading unattended.

Stop loss and take profit orders are not advisable since one pair trades against the other.

Close profit and wait for new opportunities.

Close loss or hedge it against the opposite orders.

Example: Buy\_AUD\_Sell\_NZD negative Sell\_AUD\_Buy\_NZD and wait for a new opportunity.

Another way is to open a triangle forming hedged pair.

Example: Buy\_AUDJPY\_Sell\_NZDJPY  Sell\_AUD\_NZD.

Keep the same lot sizes for the pairs ending in the same currency.

Example: AUDJPY\_vs\_NZDJPY, AUDUSD\_vs\_NZDUSD.

"WARNING: Use this software at your own risk."

"The creator of this script cannot be held responsible for any damage or loss."

**Last comments |
[Go to discussion](/en/forum/464660)**
(2)

![Chae Hyeonjun](https://c.mql5.com/avatar/2019/9/5D7DEB73-F34E.png "Chae Hyeonjun")

**[Chae Hyeonjun](/en/users/troychai79)**
|
5 Apr 2024 at 14:08

**Automated-Trading:**  

[Correlation Gaps Trading AUDJPY CADJPY NZDJPY](/en/code/48848):

Author: [Iulian Persinaru](/en/users/Persinaru "Persinaru")I

I really wanted this strategy, I'm really really want to ask you about that can you make this code to fully automatically trade?

cuz I was looking for this logic for 1 years and now finally fount it...so happy...but I'm just have basic understand of MT 4 code.

If you let me know your e-mail, I will contact you asap!!

please...

![](https://c.mql5.com/avatar/avatar_na2.png)

**[Deleted]**
|
6 Apr 2024 at 11:55

**Troy C [#](/en/forum/464660#comment_52953703):**  

I really wanted this strategy, I'm really really want to ask you about that can you make this code to fully automatically trade?

cuz I was looking for this logic for 1 years and now finally fount it...so happy...but I'm just have basic understand of MT 4 code.

If you let me know your e-mail, I will contact you asap!!

please...

For now the only implementation in an auto strategy I can think at is  Spearman correlation. I had some unsuccessful attempts to make an EA, and I am still working on it.

Thank you for your message.

 

To calculate the Spearman correlation coefficient between two instruments, you would typically follow these steps:

1. **Data Collection**: Gather the data for both instruments. Ensure that for each observation, you have paired values from both instruments.
2. **Ranking**: Rank the data from each instrument separately. Assign ranks based on the order of values, with the smallest value receiving a rank of 1, the next smallest a rank of 2, and so on.
3. **Calculate Differences**: Calculate the differences between the ranks of corresponding pairs of values. If two values are tied, assign them the average of the ranks they would have received.
4. **Square Differences**: Square each of these differences.
5. **Sum Squared Differences**: Sum up all of the squared differences.
6. **Calculate Spearman's Correlation Coefficient**: Use the formula for Spearman's correlation coefficient, which is given by:

[![](https://c.mql5.com/3/433/Screenshot_2024-04-06_030546__1.png)](https://c.mql5.com/3/433/Screenshot_2024-04-06_030546.png "https://c.mql5.com/3/433/Screenshot_2024-04-06_030546.png")

This formula adjusts for ties in the data and provides a measure of the strength and direction of the monotonic relationship between the two instruments.

7. **Interpretation**: The Spearman correlation coefficient ranges from -1 to 1. A value close to 1 indicates a strong positive relationship (as one variable increases, the other tends to increase), a value close to -1 indicates a strong negative relationship (as one variable increases, the other tends to decrease), and a value around 0 indicates no monotonic relationship.

Remember, the Spearman correlation coefficient assesses the strength and direction of monotonic relationships, meaning that it can detect relationships that are not necessarily linear. It's often used when the data may not meet the assumptions of other correlation methods, such as Pearson correlation, due to non-normal distributions or outliers.

Let's assume we have the following data:

Instrument 1 (X): [10, 15, 20, 25, 30] Instrument 2 (Y): [8, 12, 18, 22, 28]

1. **Ranking**: For X: [1, 2, 3, 4, 5] For Y: [1, 2, 3, 4, 5]
2. **Calculate Differences**: Differences (d): [0, 0, 0, 0, 0]
3. **Square Differences**: Squared Differences: [0, 0, 0, 0, 0]
4. **Sum Squared Differences**: Sum of squared differences (Σd²): 0
5. **Calculate Spearman's Correlation Coefficient**:

Given

![](https://c.mql5.com/3/433/Screenshot_2024-04-06_030901.png)

1. **Interpretation**: The Spearman correlation coefficient (   
   ρ) is 1, indicating a perfect positive monotonic relationship between the two instruments. In this case, as the values of Instrument 1 increase, the values of Instrument 2 also increase in a perfect linear manner.

This example demonstrates how to calculate the Spearman correlation coefficient using specific data points for two instruments (X and Y).

![Close_on_PROFIT_or_LOSS_inAccont_Currency](https://c.mql5.com/i/code/expert.png)
[Close\_on\_PROFIT\_or\_LOSS\_inAccont\_Currency](/en/code/48818)

Close\_on\_PROFIT\_or\_LOSS\_inAccont\_Currency

![Hedge_Dollar_Index_Against_Forex_Pairs_V1](https://c.mql5.com/i/code/script.png)
[Hedge\_Dollar\_Index\_Against\_Forex\_Pairs\_V1](/en/code/48817)

Hedge Dollar index USIDX against its constitutive FOREX pairs EURUSD GBPUSD USDJPY USDCAD USDSEK USDCHF

![Multiple Buys and Sells ORDERS based on a currency pair strength.](https://c.mql5.com/i/code/script.png)
[Multiple Buys and Sells ORDERS based on a currency pair strength.](/en/code/48879)

Short description.

![Sell with Buy Stop Hedge for chart symbol / Buy with Sell Stop Hedge for chart symbol](https://c.mql5.com/i/code/script.png)
[Sell with Buy Stop Hedge for chart symbol / Buy with Sell Stop Hedge for chart symbol](/en/code/48893)

Hedge with a stop order, instead of placing a Stop Loss.