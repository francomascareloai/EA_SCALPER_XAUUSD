# Moving Averages, MA - indicator for MetaTrader 4

Source: https://www.mql5.com/en/code/7534

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/7534) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/MetaTrader5.pkg.zip?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# Moving Averages, MA - indicator for MetaTrader 4

[MetaQuotes](/en/users/metaquotes)  |
[English](javascript:void(false);)

[Русский](/ru/code/7534) [中文](/zh/code/7534) [Español](/es/code/7534) [Deutsch](/de/code/7534) [日本語](/ja/code/7534) [Português](/pt/code/7534) [한국어](/ko/code/7534) [Français](/fr/code/7534) [Italiano](/it/code/7534) [Türkçe](/tr/code/7534)

Views:
:   92931

Rating:
:   (34)

Published:
:   29 November 2005, 11:54

Updated:
:   22 November 2016, 07:32
:   [Moving\_Averages.mq4](/en/code/download/7534/Moving_Averages.mq4 "Moving_Averages.mq4")
    (5.34 KB)
    [view](# "view")

    [moving-averages.gif](/en/code/download/7534/moving-averages.gif "moving-averages.gif")
    (10.94 KB)

    [Download as ZIP](/en/code/download/7534.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The Moving Average Technical Indicator shows the mean instrument price value for a certain period of time. When one calculates the moving average, one averages out the instrument price for this time period. As the price changes, its moving average either increases, or decreases.  
    There are four different types of moving averages: Simple (also referred to as Arithmetic), Exponential, Smoothed and Linear Weighted. Moving averages may be calculated for any sequential data set, including opening and closing prices, highest and lowest prices, trading volume or any other indicators. It is often the case when double moving averages are used.  
    The only thing where moving averages of different types diverge considerably from each other, is when weight coefficients, which are assigned to the latest data, are different. In case we are talking of  simple moving average, all prices of the time period in question, are equal in value. Exponential and Linear Weighted Moving Averages attach more value to the latest prices.

**Calculation**

    Simple Moving Average (SMA)  

    Simple, in other words, arithmetical moving average is calculated by summing up the prices of instrument closure over a certain number of single periods (for instance, 12 hours). This value is then divided by the number of such periods.

    SMA = SUM(CLOSE, N)/N  
  
    Where:  
N — is the number of calculation periods.

    Exponential Moving Average (EMA)  

    Exponentially smoothed moving average is calculated by adding the moving average of a certain share of the current closing price to the previous value. With exponentially smoothed moving averages, the latest prices are of more value. P-percent exponential moving average will look like:  
  
    EMA = (CLOSE(i)\*P)+(EMA(i-1)\*(100-P))  
  
     Where:  
CLOSE(i) — the price of the current period closure;  
EMA(i-1) — Exponentially Moving Average of the previous period closure;  
P — the percentage of using the price value.

    Smoothed Moving Average (SMMA)  

    The first value of this smoothed moving average is calculated as the simple moving average (SMA):  
  
    SUM1 = SUM(CLOSE, N)  
  
    SMMA1 = SUM1/N  
  
    The second and succeeding moving averages are calculated according to this formula:  
  
    SMMA(i) = (SUM1-SMMA1+CLOSE(i))/N

    Where:  
SUM1 — is the total sum of closing prices for N periods;  
SMMA1 — is the smoothed moving average of the first bar;  
SMMA(i) — is the smoothed moving average of the current bar (except for the first one);  
CLOSE(i) — is the current closing price;  
N — is the smoothing period.

    Linear Weighted Moving Average (LWMA)  

    In the case of weighted moving average, the latest data is of more value than more early data. Weighted moving average is calculated by multiplying each one of the closing prices within the considered series, by a certain weight coefficient.  
  
    LWMA = SUM(Close(i)\*i, N)/SUM(i, N)

    Where:  
SUM(i, N) — is the total sum of weight coefficients.

Moving averages may also be applied to indicators. That is where the interpretation of indicator moving averages is similar to the interpretation of price moving averages: if the indicator rises above its moving average, that means that the ascending indicator movement is likely to continue: if the indicator falls below its moving average, this means that it is likely to continue going downward.

    Here are the types of moving averages on the chart:

* Simple Moving Average (SMA)
* Exponential Moving Average (EMA)
* Smoothed Moving Average (SMMA)
* Linear Weighted Moving Average (LWMA)

**Technical Indicator Description**

Full description of MA is available in the [Technical analysis: Moving Averages](https://www.metatrader5.com/en/terminal/help/indicators/trend_indicators/ma)

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/7534](/ru/code/7534)

**Last comments |
[Go to discussion](/en/forum/24778)**
(4)

![Sameer](https://c.mql5.com/avatar/avatar_na2.png "Sameer")

**[Sameer](/en/users/t4fast)**
|
20 Feb 2008 at 23:59

One element is missing, "Price applied to".

![Nikolay Georgiev](https://c.mql5.com/avatar/2020/11/5FBEE6BE-DE2C.jpg "Nikolay Georgiev")

**[Nikolay Georgiev](/en/users/n.georgiev)**
|
11 Dec 2020 at 22:23

I needed this fix in another [project](https://www.mql5.com/en/articles/7863 "Article: Projects allow you to create profitable trading robots! But it is not exactly") so I changed a little the code and I decided to upload the result here. I know it is an old topic but still if someone needs this  "Price applied to" added

![Vinod Garg](https://c.mql5.com/avatar/2021/8/612BF5E3-5EFA.png "Vinod Garg")

**[Vinod Garg](/en/users/vinodgarg)**
|
5 Apr 2022 at 12:29

**Nikolay Georgiev [#](/en/forum/24778#comment_19698170):**  

I needed this fix in another [project](/en/articles/7863 "Article: Projects allow you to create profitable trading robots! But it is not exactly") so I changed a little the code and I decided to upload the result here. I know it is an old topic but still if someone needs this  "Price applied to" added

Thanks dear, just what I needed. I wanted median price in fact, but never mind I will add it myself to the function Price(int shift).

![xtemer](https://c.mql5.com/avatar/avatar_na2.png "xtemer")

**[xtemer](/en/users/xtemer)**
|
7 May 2022 at 11:21

**Nikolay Georgiev [#](/en/forum/24778#comment_19698170):**  

I needed this fix in another [project](/en/articles/7863 "Article: Projects allow you to create profitable trading robots! But it is not exactly") so I changed a little the code and I decided to upload the result here. I know it is an old topic but still if someone needs this  "Price applied to" added

There is a mistake in line 172, the "lsum-=Price(pos);" should be "lsum-=Price(i);" instead. This causes the LWMA doesn't show correctly.

Attached the fixed code. I also added the median price option.

Note: you need to click [Go to discussion](/en/forum/24778)link to see the attachment.

![Momentum](https://c.mql5.com/i/code/indicator.png)
[Momentum](/en/code/7880)

The Momentum indicator measures the amount that a security’s price has changed over a given time span.

![Moving Average Convergence Divergence, MACD](https://c.mql5.com/i/code/indicator.png)
[Moving Average Convergence Divergence, MACD](/en/code/7774)

Moving Average Convergence/Divergence (MACD) is the next trend-following dynamic indicator.

![Moving Average of Oscillator, OsMA](https://c.mql5.com/i/code/indicator.png)
[Moving Average of Oscillator, OsMA](/en/code/7785)

Moving Average of Oscillator is the difference between the oscillator and oscillator smoothing.

![Parabolic SAR, Parabolic](https://c.mql5.com/i/code/indicator.png)
[Parabolic SAR, Parabolic](/en/code/7892)

Parabolic SAR Indicator was developed for analyzing the trending markets.