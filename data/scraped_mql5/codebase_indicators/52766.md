# Script to extract Candlesticks data from all time frames to CSV. - script for MetaTrader 5

Source: https://www.mql5.com/en/code/52766

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/52766) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# Script to extract Candlesticks data from all time frames to CSV. - script for MetaTrader 5

[Mthandeni Mnyandu](/en/users/forex-world-dc)  |
[English](javascript:void(false);)

[Русский](/ru/code/52766) [中文](/zh/code/52766) [Español](/es/code/52766) [Deutsch](/de/code/52766) [日本語](/ja/code/52766) [Português](/pt/code/52766) [한국어](/ko/code/52766) [Français](/fr/code/52766) [Italiano](/it/code/52766) [Türkçe](/tr/code/52766)

Views:
:   6491

Rating:
:   (5)

Published:
:   15 October 2024, 05:29
:   [Candlesticks\_Data.mq5](/en/code/download/52766/candlesticks_data.mq5 "Candlesticks_Data.mq5")
    (7.13 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/52766.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

**Overview of the CandlesticksData Script**

The **CandlesticksData** script is designed for the MetaTrader 5 trading platform, allowing traders and developers to export detailed candlestick data into a CSV file for further analysis or record-keeping. This script is particularly useful for quantitative analysis, backtesting trading strategies, or for educational purposes, enabling users to examine historical price movements comprehensively.

**Purpose**

The primary purpose of the CandlesticksData script is to gather and organize candlestick data across various timeframes and save it in a structured format. This functionality assists traders in identifying market trends, patterns, and behaviors, making it easier to make informed trading decisions. By exporting this data, users can leverage external tools or software for more complex analyses, such as statistical assessments or machine learning applications.

**Functionality**

1. **Initialization and Inputs**: The script begins by defining properties and initializing necessary variables. It includes an enumeration for timeframes and prepares to capture data from the latest 21 candlesticks.
2. **Timeframe Selection**: The TimeFrameHandle function assigns specific timeframes based on the input index, allowing the user to choose from various candlestick intervals, including minutes, hours, daily, weekly, and monthly data.
3. **Data Collection**: Within the OnStart function, the script iterates through the defined timeframes and calls the CandlesticksData function for data collection. This function retrieves key data points for each candlestick, including:

   * **Open, High, Low, and Close Prices**: Essential indicators of price movement within each period.
   * **Tick Volume and Volume**: Measures of trading activity and liquidity.
   * **Spread**: The difference between bid and ask prices.
   * **Candlestick Characteristics**: This includes calculating the sizes of the candlestick body, wicks, and their types (bullish or bearish).
4. **Data Writing**: The script formats the collected data into a CSV file. It starts by writing a header row for clarity, followed by detailed entries for each candlestick. This includes the index, date, time, prices, volume metrics, and additional calculated values such as the previous close price and candle range differences.
5. **Error Handling**: The script includes error checks to ensure successful file creation and writing. If any issues arise, it outputs an error message to the console.
6. **Completion Notification**: Upon successfully saving the data, the script alerts the user about the file location, providing easy access to the exported data for further use.

**Conclusion**

The CandlesticksData script serves as a valuable tool for traders seeking to analyze historical market data efficiently. By automating the data extraction process and organizing it in a user-friendly format, the script enables enhanced trading strategy development and evaluation.

**Last comments |
[Go to discussion](/en/forum/474696)**
(2)

![Wizard_H](https://c.mql5.com/avatar/avatar_na2.png "Wizard_H")

**[Wizard\_H](/en/users/wizard_h)**
|
27 Nov 2024 at 00:53

**Automated-Trading:**  

[Script to extract Candlesticks data from all time frames to CSV.](/en/code/52766):

Author: [Mthandeni Mnyandu](/en/users/Forex-World-DC "Forex-World-DC")

one cant see the output folder can this be customised to a specific user selected folder

![Mthandeni Mnyandu](https://c.mql5.com/avatar/2024/11/67438610-26c4.jpg "Mthandeni Mnyandu")

**[Mthandeni Mnyandu](/en/users/forex-world-dc)**
|
27 Nov 2024 at 02:39

**Wizard\_H [#](/en/forum/474696#comment_55233260):**  
 one cant see the output folder can this be customised to a specific user selected folder

Open data folder and go on common folder you will found the CSV file inside . WhatsApp me( 081 363 7423 i will send you a short screen video show where to found the output file

![Simplest Logger class for MetaTrader 5](https://c.mql5.com/i/code/library.png)
[Simplest Logger class for MetaTrader 5](/en/code/52741)

The simplest class for logging in MetaTrader 5 with support for levels, message format, include and exclude filters on substrings.

![TimeServerDaylightSavings](https://c.mql5.com/i/code/script.png)
[TimeServerDaylightSavings](/en/code/52557)

Time-related functions for empirical detection of server time zone and daylight savings mode (DST) from history of quotes

![Push Notification for Opened / Closed Trades (Netting)](https://c.mql5.com/i/code/library.png)
[Push Notification for Opened / Closed Trades (Netting)](/en/code/52899)

This code provides a simple function for sending push notifications to your mobile device whenever trades are opened or closed in MetaTrader 5. It's designed for netting accounts (where only one position per symbol is allowed).

![Economic Calendar CSV](https://c.mql5.com/i/code/script.png)
[Economic Calendar CSV](/en/code/52977)

This script saves a predefined set of economic events from the MetaTrader's built-in economic calendar into CSV file.