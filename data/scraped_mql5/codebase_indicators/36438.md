# ATR with Smoothing - indicator for MetaTrader 4

Source: https://www.mql5.com/en/code/36438

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/36438) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# ATR with Smoothing - indicator for MetaTrader 4

[Vitor Palmeira Abbehusen](/en/users/nocerahargreave)

Views:
:   18015

Rating:
:   (12)

Published:
:   14 September 2021, 17:15

Updated:
:   28 September 2021, 22:41
:   [ATR-with-smoothing.mq4](/en/code/download/36438/atr-with-smoothing.mq4 "ATR-with-smoothing.mq4")
    (4.46 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/36438.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

This Indicator is based on the True Range which is the maximum of (High - Low), Abs(High - Close[1]) and Abs(Low - Close[1]), with Abs being mathematical absolute.  
In order to get the first data, it calculates the true range value for a number of bars (which is the input Length) and then calculates the SMA of these values (which is the sum of all these values by the Length - a simple average). This average is set as the first ATR value.  
  
Smoothing methods:

**Example: XAUUSD, H1**

* RMA

> > [![ATR with RMA smoothing](https://c.mql5.com/18/100/RMA__1.png "ATR with RMA smoothing")](https://c.mql5.com/18/100/RMA.png "https://c.mql5.com/18/100/RMA.png")

* EMA

> > [![ATR with EMA smoothing](https://c.mql5.com/18/100/EMA__1.png "ATR with EMA smoothing")](https://c.mql5.com/18/100/EMA.png "https://c.mql5.com/18/100/EMA.png")

* SMA

> > [![ATR with SMA smoothing](https://c.mql5.com/18/100/SMA__1.png "ATR with SMA smoothing")](https://c.mql5.com/18/100/SMA.png "https://c.mql5.com/18/100/SMA.png")

* WMA

> > [![ATR with WMA smoothing](https://c.mql5.com/18/100/WMA__1.png "ATR with WMA smoothing")](https://c.mql5.com/18/100/WMA.png "https://c.mql5.com/18/100/WMA.png")

**Last comments |
[Go to discussion](/en/forum/377677)**
(13)

![Dhanush97](https://c.mql5.com/avatar/avatar_na2.png "Dhanush97")

**[Dhanush97](/en/users/dhanush97)**
|
30 Aug 2022 at 15:50

Hi Vitor,

Thanks for this indicator which I was looking for. I'm having an issue. The value of ATR RMA in Trading view and this indicators RMA values doesn't match. Can you please help?

Thanks

![dzeeju](https://c.mql5.com/avatar/avatar_na2.png "dzeeju")

**[dzeeju](/en/users/dzeeju)**
|
27 Sep 2022 at 18:27

Hello Victor,

I have a question about your script. Current value of ATR is the same no matter of which [smoothing method](https://www.mql5.com/en/docs/constants/indicatorconstants/enum_ma_method "MQL5 documentation: Smoothing Methods") I choosed. Whats more it equals the value of built-in ATR indicator for MQL4.

I have a problem wtih different values of ATR in Trading View (which is based on RMA) and MT4, so your custom indicator looks like the answer :)

Thanks in advance for any tips / suggestion.

![rockychiew](https://c.mql5.com/avatar/avatar_na2.png "rockychiew")

**[rockychiew](/en/users/rockychiew)**
|
23 Mar 2023 at 02:50

**Automated-Trading:**  

[ATR with Smoothing](/en/code/36438):

Author: [Vitor Palmeira Abbehusen](https://www.mql5.com/en/users/NoceraHargreave "NoceraHargreave")

Hi Vitor,

May I know how you add-in the smoothing options?

Thank you.

![Vitor Palmeira Abbehusen](https://c.mql5.com/avatar/2021/10/617D8664-F5C6.png "Vitor Palmeira Abbehusen")

**[Vitor Palmeira Abbehusen](/en/users/nocerahargreave)**
|
31 May 2023 at 15:14

**rockychiew [#](/en/forum/377677/page2#comment_45802761):**  
 Hi Vitor,

May I know how you add-in the smoothing options?

Thank you.

Hi,

sorry for the late response. what do you mean? you can choose the method and the length

![adamlim96](https://c.mql5.com/avatar/avatar_na2.png "adamlim96")

**[adamlim96](/en/users/adamlim96)**
|
4 Jan 2024 at 05:02

Hi Vitor,

Do you have MQ5 version of this indicator?

Thank you.

![Timeframe Flow](https://c.mql5.com/i/code/indicator.png)
[Timeframe Flow](/en/code/36346)

Sharing this trend indicator made by me. Called "Timeframe Flow".
It will draw a user defined higher time-frame candle on every shift on your current time-frame.
Meaning you can have H4, H12 or D1 candles on every shift of your H1 Charts.
Or you can have D2, D3 or D5 candles on every shift of your Daily Charts.
Combined with the current time-frame ATR Bands, you have a trend indicator with some filter.
You may also use the Mid Line crosses as exit( Calculated using Higher timeframe candles displayed in the indicator(Close + Open)/2 ).

![Tops and bottoms in trend](https://c.mql5.com/i/code/expert.png)
[Tops and bottoms in trend](/en/code/36244)

with rsi .

![Trailing stop MT4](https://c.mql5.com/i/code/expert.png)
[Trailing stop MT4](/en/code/36559)

Use trailing stop point with MT4

![G channel](https://c.mql5.com/i/code/indicator.png)
[G channel](/en/code/36719)

G channel is a channel indicator with 3 lines- a middle line representing a central tendency and 2 Upper and Lower boundaries calculated based on the past values of same indicator. Its based on the paper "Recursive Bands - A New Indicator For Technical Analysis" by Alex Grover and is a code conversion from TradingView.
The channel breakout of Upper or Lower boundaries represent a new trend or trend continuation while narrowing of bands represents ranging or low volatility conditions. The channel can prove to be a good indicator of a trend direction and also a guide for trailing of stop loss.
It has only 2 variables.
Channel period - default set to 100.
Price type.