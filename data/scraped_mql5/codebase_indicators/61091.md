# Weekly VWAP - indicator for MetaTrader 5

Source: https://www.mql5.com/en/code/61091

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/61091) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# Weekly VWAP - indicator for MetaTrader 5

[Guillermo Pineda](/en/users/syllyon)  |
[English](javascript:void(false);)

[Русский](/ru/code/61091) [中文](/zh/code/61091) [Español](/es/code/61091) [Deutsch](/de/code/61091) [日本語](/ja/code/61091) [Português](/pt/code/61091) [한국어](/ko/code/61091) [Français](/fr/code/61091) [Italiano](/it/code/61091) [Türkçe](/tr/code/61091)

Views:
:   2922

Rating:
:   (4)

Published:
:   3 July 2025, 16:28
:   [Weekly VWAP.mq5](/en/code/download/61091/weekly_vwap.mq5 "Weekly VWAP.mq5")
    (9.06 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/61091.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

## **Weekly VWAP: Your Foundation for Weekly Market Analysis**

The **Weekly VWAP (Volume Weighted Average Price)** is a robust custom indicator meticulously designed to provide traders with a vital long-term perspective on market activity: the volume-weighted average price, reset at the start of each new trading week. Unlike simpler moving averages, VWAP integrates volume directly into its calculation, giving greater significance to price levels where substantial trading occurred. This makes it an exceptionally valuable tool for discerning the true fair value of an asset over the entire trading week.

This indicator precisely calculates the cumulative sum of (Price \* Volume) divided by the cumulative volume for each week, automatically resetting with the commencement of every new weekly trading session. It plots a distinct line directly on your chart, offering an effortless visual representation of where the majority of the week's trading volume has transpired relative to price.

**Why incorporate Weekly VWAP into your strategy?**

* **Identify Weekly Fair Value:** Gain insights into the average price at which an asset has traded, adjusted for volume, providing a clear benchmark for overarching sentiment across the week.
* **Strategic Positional Analysis:** Many professional traders utilize VWAP as a key reference point for higher-timeframe positions. Price consistently trading above Weekly VWAP can signal sustained bullish momentum, while price below may suggest persistent bearish control. This offers critical insights for strategic entry, exit, and position management.
* **Trend Strength Confirmation:** Use Weekly VWAP to confirm the underlying strength of a weekly trend. A robust trend often sees price maintaining its trajectory relative to the Weekly VWAP.
* **Clear Visual Representation:** Despite its sophisticated calculation, the Weekly VWAP is displayed as a single, unambiguous line on your chart, ensuring your analysis remains clean and focused.

**Key Features of this Source Code:**

* **Weekly Reset:** The VWAP calculation automatically resets at the beginning of each new trading week, providing a fresh and relevant perspective on weekly market activity.
* **Accurate Calculation:** Employs standard MQL5 functions for the precise computation of typical price and volume, ensuring reliable data.
* **Clean Chart Plotting:** Presents a clear line on your chart for immediate visual understanding.
* **Open Source:** The full MQL5 source code is provided, promoting transparency, fostering learning, and allowing for further customization by the trading community.

![BTCUSD H1](https://c.mql5.com/18/164/BTCUSDH1_p1o.png "BTCUSD H1")

**Last comments |
[Go to discussion](/en/forum/490306)**
(1)

![FourSeasons](https://c.mql5.com/avatar/2024/12/67731b2a-599c.jpg "FourSeasons")

**[FourSeasons](/en/users/hoannd37)**
|
20 Aug 2025 at 19:51

I think: ENUM\_TIMEFRAMES LastTimePeriod = PERIOD\_MN1; is not true. It could be: ENUM\_TIMEFRAMES LastTimePeriod = PERIOD\_W1;

![Daily VWAP](https://c.mql5.com/i/code/indicator.png)
[Daily VWAP](/en/code/61090)

Daily VWAP (Volume Weighted Average Price) is a simple yet powerful indicator that calculates and displays the Volume Weighted Average Price for each trading day. Ideal for identifying intraday fair value and supporting your daily trading decisions.

![Watermark](https://c.mql5.com/i/code/indicator.png)
[Watermark](/en/code/59930)

The Watermark indicator is lightweight and efficient, designed to display an informative watermark over the main MetaTrader 5 chart. It automatically shows the current symbol, chart time and asset description, allowing traders to customise their interface with style and convenience.

![Monthly VWAP](https://c.mql5.com/i/code/indicator.png)
[Monthly VWAP](/en/code/61098)

Monthly VWAP (Volume Weighted Average Price) is an essential MQL5 indicator that calculates and displays the Volume Weighted Average Price for each trading month. It's a powerful tool for understanding long-term market sentiment, identifying key monthly fair value, and informing strategic decisions.

![Auto Tp](https://c.mql5.com/i/code/expert.png)
[Auto Tp](/en/code/61119)

Set Auto TP and SL:
The “Set Auto TP and SL” (Take Profit and Stop Loss) feature is a crucial tool in any trading strategy, designed to automate risk and reward management. It allows traders to define fixed price levels where a trade should be automatically closed to either secure profits (TP) or limit losses (SL), removing the need for constant manual monitoring.
When this feature is enabled, each position you open will automatically include a predefined Take Profit and Stop Loss level based on your custom parameters, such as a specific number of pips, percentage of balance, or technical levels. This not only saves time but also ensures that your trades are protected from sudden market movements and emotional decision-making.