# Fractal - indicator for MetaTrader 4

Source: https://www.mql5.com/en/code/35575

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Facebook](https://www.facebook.com/mql5.community/)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/35575) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# Fractal - indicator for MetaTrader 4

[Hosein Rahnama](/en/users/hosein.rahnama)

Views:
:   33191

Rating:
:   (36)

Published:
:   16 July 2021, 06:28

Updated:
:   9 May 2024, 11:53
:   \MQL4\Include\

    [Fractal-Utilities.mqh](/en/code/download/35575/fractal-utilities.mqh "Fractal-Utilities.mqh")
    (3.74 KB)
    [view](# "view")

    [Fractal-STF.mq4](/en/code/download/35575/fractal-stf.mq4 "Fractal-STF.mq4")
    (6.18 KB)
    [view](# "view")

    [Fractal-MTF.mq4](/en/code/download/35575/fractal-mtf.mq4 "Fractal-MTF.mq4")
    (7.31 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/35575.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

### 

### 

### 

### 

### Support and Contribution

If you find this indicator useful, you can show your support by giving a star to its [GitHub repository](/go?link=https://github.com/Hosein-Rahnama/Fractal "https://github.com/Hosein-Rahnama/Fractal") and this post. You are more than welcome to comment below this post for reporting bugs, or suggesting any further improvements that you may find useful. You can do the same by opening an issue on the GitHub repository. You can also contribute to the source code by making a pull request on the GitHub repository.

### Installation

Run MetaTrader and navigate to your MetaTrader data folder through the menu bar by selecting File -> Open Data Folder . Copy *Fractal-Utilities.mqh* into *MQL4\Include* folder, and copy *Fractal-STF.mq4* and *Fractal-MTF.mq4* into *MQL4\Indicators* folder. The final step is to compile *Fractal-STF.mq4* and *Fractal-MTF.mq4* via **MetaEditor** to create *Fractal-STF.ex4* and *Fractal-MTF.ex4* , respectively. Now, you should be able to use the Fractal-STF and Fractal-MTF indicators within MetaTrader terminal. The only requirement for installation is to put both *Fractal-STF.mq4* and *Fractal-MTF.mq4* into the same directory, which can be any subdirectory of *MQL4\Indicators* like *MQL4\Indicators\Developed* . Note that whenever you relocate the compiled files to another directory, you should recompile them in that directory to get them working.

### 

### Terminology

STF is an abbreviation for Single Time Frame. MTF is an abbreviation for Multi Time Frame. So, Fractal-STF is an indicator whose calculations only involves a single time frame, while Fractal-MTF uses multiple time frames for its calculations. Due to this fact, Fractal-STF is a little bit faster than Fractal-MTF as it has to do less computations. You can notice this fact while you want to switch between different time frames. For the current version, the algorithm used for Fractal-MTF is not optimized and I try to improve it in future updates to gain better performance. If you find the delay in Fractal-MTF annoying and you do not use the multi time frame feature too much, then it is wise to just use Fractal-STF.

### 

### 

### Description

There is a built-in fractal indicator in MT4/MT5, whose origins goes back to the famous Bill Williams. The main purpose of this indicator is to identify a local extremum by comparing a candle's high/low with that of its neighboring candles to justify it as an up-fractal/down-fractal, a term coined by Williams instead of local maximum/minimum. Some other equivalent terms are swing high/low and top/bottom, which are used among traders interchangeably.

This indicator has the following advantages over its built-in MT4/MT5  counterpart:

> 1. Williams believed that like our middle finger, which is a fractal compared with its two neighboring ones, the radius of the comparison should be chosen as two, which is the default value for the built-in fractal indicator in MT4/MT5. In this indicator, the user can choose this neighborhood radius to his/her will. This has the benefit of distinguishing extrema of different degrees at the same time on the chart as shown in **Figure 1**.
>
> 2. User can also choose the shape of symbols pointing to these extrema, enabling him/her to associate with extrema of each degree a unique symbol for better visualization.
>
> 3. User can specify the vertical distance of the arrows from the high/low of the candles to avoid overlapping of symbols corresponding to extrema of different degrees. The idea for dynamic adjustment of the vertical distance was mainly inspired by the answers of tdbarnard in [here](/go?link=https://www.forexfactory.com/thread/456946-perfect-placing-of-arrows-on-the-chart "https://www.forexfactory.com/thread/456946-perfect-placing-of-arrows-on-the-chart"). The main point to consider is that we want the **pixel distance** of an arrow (arrow offset) to be a constant value away from a candle's high/low. However, this does not mean that the equivalent **price distance** should be constant too. Indeed, as the chart's scale is changed, the price distance corresponding to a fixed pixel distance will also change, which requires a dynamic distance adjustment. You can see the detailed implementation of this idea in the code.
>
> 4. User can view higher time frame fractals in a lower time frame, making this a multi time frame (MTF) indicator. For example, user can set the indicator time frame as D1 and choose a radius of 2 for the fractals. Next, if user switches to M15 time frame, Fractal-MTF marks those M15 bars whose high/low coincides with that of their corresponding fractals in D1 time frame. Note that the indicator time frame should be greater than or equal to the chart time frame, which is attached to it. If the user chooses an indicator time frame smaller than the chart time frame, then the indicator uses the chart time frame by default.

[![Fractals with neighborhood radius of 2 and 5](https://c.mql5.com/18/104/Chart__1.png "Fractals with neighborhood radius of 2 and 5")](https://c.mql5.com/18/104/Chart.png "https://c.mql5.com/18/104/Chart.png")

**Figure 1**. Fractals with neighborhood radius of 2 and 5.

[![Inputs of the Fractal-MTF indicator](https://c.mql5.com/18/104/Inputs__1.png "Inputs of the Fractal-MTF indicator")](https://c.mql5.com/18/104/Inputs.png "https://c.mql5.com/18/104/Inputs.png")

**Figure 2.** Inputs of the Fractal-MTF indicator.

**Last comments |
[Go to discussion](/en/forum/373439)**
(10)

![Jacryptoking](https://c.mql5.com/avatar/avatar_na2.png "Jacryptoking")

**[Jacryptoking](/en/users/jacryptoking)**
|
18 Dec 2022 at 14:54

I can you have a feature where strong and weak fractal swings are identified? Base on color change ?

A strong fractal swing high the fractal candle is a down close candle

A strong fractal swing low the fractal candle is a Up close candle.

Otherwise it is a weak fractal swing.

Have alert features to give notification and [alert base](https://www.mql5.com/en/docs/common/alert "MQL5 documentation: Alert function") on the fractal swing that formed .

![Ismail Hassan Lemin](https://c.mql5.com/avatar/2021/5/60A18913-8A37.png "Ismail Hassan Lemin")

**[Ismail Hassan Lemin](/en/users/lemin-ismail)**
|
19 Dec 2022 at 04:42

Hello Hussein just checked the source code of your Indicator on Github. I need to ask what is delay period for fractal arrow formation. Mostly with other fractals indicators it takes upto 3 bars for the arrows to draw. That is usually very late and not ideal. Also csn there be an alert or [SendNotification](https://www.mql5.com/en/docs/network/sendnotification "MQL5 documentation: SendNotification function") option?

![Hosein Rahnama](https://c.mql5.com/avatar/2021/2/601E9E26-3FC7.JPG "Hosein Rahnama")

**[Hosein Rahnama](/en/users/hosein.rahnama)**
|
25 Dec 2022 at 18:48

**Jacryptoking [#](/en/forum/373439#comment_43854465):**  
 I can you have a feature where strong and weak fractal swings are identified? Base on color change ?

A strong fractal swing high the fractal candle is a down close candle

A strong fractal swing low the fractal candle is a Up close candle.

Otherwise it is a weak fractal swing.

Have alert features to give notification and [alert base](/en/docs/common/alert "MQL5 documentation: Alert function") on the fractal swing that formed .

Dear **Jacryptoking**, the larger the neighborhood radius and the higher the indicator time frame are chosen, the stronger the fractal is. You can attach multiple Fractal-STF or Fractal-MTF with different radii or time frame to the chart as is shown in **Figure1** to observe Fractals of different strength. However, you should notice that any Fractal indicator is inherently a lagging indicator and the larger these parameters are, the more candles should be revealed to form such a strong fractal. Unfortunately, I don't have much free time right now but I will put the notification feature on the list.

![Hosein Rahnama](https://c.mql5.com/avatar/2021/2/601E9E26-3FC7.JPG "Hosein Rahnama")

**[Hosein Rahnama](/en/users/hosein.rahnama)**
|
25 Dec 2022 at 18:50

**Ismail Lemin [#](/en/forum/373439#comment_43861246):**  
 Hello Hussein just checked the source code of your Indicator on Github. I need to ask what is delay period for fractal arrow formation. Mostly with other fractals indicators it takes upto 3 bars for the arrows to draw. That is usually very late and not ideal. Also csn there be an alert or [SendNotification](/en/docs/network/sendnotification "MQL5 documentation: SendNotification function") option?

Dear **Ismail**, I think that your question is much similar to that of [Jacryptoking](/en/users/jacryptoking), so please check out my answer to that question.

![vvm-55](https://c.mql5.com/avatar/avatar_na2.png "vvm-55")

**[vvm-55](/en/users/vvm-55)**
|
6 May 2024 at 17:31

I like Ur Indicator, It can show the Legs.
It is OK, sometimes it makes small Mistakes... for Examle EURODOLLAR H4 06.05.24 04:00 London Time:
It did [not draw](https://www.mql5.com/en/docs/constants/indicatorconstants/drawstyles#enum_plot_property_double "MQL5 documentation: Drawing Styles") the Wing above this Candle All the best and Thank U for a great Job
vvm

![Alligator trend cross](https://c.mql5.com/i/code/expert.png)
[Alligator trend cross](/en/code/35635)

Candle cross either of three lines.

![More Trade After Break Even](https://c.mql5.com/i/code/expert.png)
[More Trade After Break Even](/en/code/35609)

Have you ever wanted to add another trade only after the previous has been modified by either trailing stop or even break even , This code will help you to be able to implement that

![Zone Recovery Hedge EA](https://c.mql5.com/i/code/expert.png)
[Zone Recovery Hedge EA](/en/code/35784)

Turn your losing trade into winning trade with Zone Recovery Hedge

![Directional volatility & volume oscillator](https://c.mql5.com/i/code/indicator.png)
[Directional volatility & volume oscillator](/en/code/35865)

Displays direction of volatility and volume