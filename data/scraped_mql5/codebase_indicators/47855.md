# Calculate unrealized profit(s) at a specific time in history - script for MetaTrader 5

Source: https://www.mql5.com/en/code/47855

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Twitter](https://x.com/mql5com)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/47855) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Scripts](https://c.mql5.com/i/code/script.png)

# Calculate unrealized profit(s) at a specific time in history - script for MetaTrader 5

[Yashar Seyyedin](/en/users/yashar.seyyedin)

Views:
:   3768

Rating:
:   (4)

Published:
:   9 January 2024, 09:26

Updated:
:   29 April 2024, 09:19
:   [PnLAt.mq5](/en/code/download/47855/pnlat.mq5 "PnLAt.mq5")
    (4.92 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/47855.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

Once you execute you will see detailed information about trades that were open at the inputted time.

[![](https://c.mql5.com/18/153/5623895356764__1.png)](https://c.mql5.com/18/153/5623895356764.png "https://c.mql5.com/18/153/5623895356764.png")

**Last comments |
[Go to discussion](/en/forum/460241)**
(1)

![Michael Charles Schefe](https://c.mql5.com/avatar/2021/5/60ADC6A5-6810.gif "Michael Charles Schefe")

**[Michael Charles Schefe](/en/users/ausimike)**
|
9 Jan 2024 at 13:29

**Automated-Trading:**  

[Calculate unrealized profit(s) at a specific time in history](/en/code/47855):

Author: [Yashar Seyyedin](/en/users/yashar.seyyedin "yashar.seyyedin")

nice.

![SymbolSyncEA](https://c.mql5.com/i/code/expert.png)
[SymbolSyncEA](/en/code/47852)

Syncs all chart symbols to symbol of the chart the EA is attached to

![wd.Multi_ClockPrice lite!](https://c.mql5.com/i/code/indicator.png)
[wd.Multi\_ClockPrice lite!](/en/code/47847)

The 'wd.Multi\_ClockPrice lite!' is the lite version of 'wd.Multi\_ClockPrice', providing a visual representation of server time and bid prices on the chart.
It synchronizes with PC clock every seconds, allowing seamless updates even when MT5 is offline.
Real-time bid prices are displayed, efficiently meeting the need for price information.
Place informational labels in the specified sub-window, adjusting positions as needed.

![Open Trade](https://c.mql5.com/i/code/script.png)
[Open Trade](/en/code/47862)

This function performs the main logic of opening a trade.
Calculates the opening price, take profit levels and stop loss based on symbol information and parameters provided by the user.
Prepare a trade request (MqlTradeRequest) with the necessary information, such as symbol, volume, order type, deviation, comment, magic number, etc.
Call the OrderSend function to send the operation request and get the result.
SetTypeFillingBySymbol function:
Determines the order fill type (Fill or Kill, Immediate or Cancel, or Return) based on the symbol's filling policy.
GetMinTradeLevel function:
Calculates the minimum operating level based on the freeze level and the symbol stops level.
Adjusts the minimum level to make sure it is within certain limits and returns the result.

![Sec-WebSocket-Key Generator](https://c.mql5.com/i/code/script.png)
[Sec-WebSocket-Key Generator](/en/code/47982)

Sec-WebSocket-Key Generator