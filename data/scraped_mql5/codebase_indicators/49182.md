# Correlation Coefficient - indicator for MetaTrader 5

Source: https://www.mql5.com/en/code/49182

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

Watch [how to download](https://youtu.be/rloNyFVtHuA?list=PLltlMLQ7OLeKwyQwC8FhiKwjl9syKhOCK) trading robots for free

Find us on [Telegram](https://t.me/mql5dev)!  
 Join our fan page

Interesting script?  
So post a [link](/en/code/49182) to it -  
let others appraise it

You liked the script? Try it in the [MetaTrader 5](https://download.mql5.com/cdn/web/metaquotes.ltd/mt5/mt5setup.exe?utm_source=www.mql5.com&utm_campaign=download) terminal

[to pocket](#pocket "Pocket allows you to insert a complete content description to the appropriate comment")

![Indicators](https://c.mql5.com/i/code/indicator.png)

# Correlation Coefficient - indicator for MetaTrader 5

[Artyom Trishkin](/en/users/artmedia70)  |
[English](javascript:void(false);)

[Русский](/ru/code/49182) [中文](/zh/code/49182) [Español](/es/code/49182) [Deutsch](/de/code/49182) [日本語](/ja/code/49182) [Português](/pt/code/49182) [한국어](/ko/code/49182) [Français](/fr/code/49182) [Italiano](/it/code/49182) [Türkçe](/tr/code/49182)

Views:
:   3066

Rating:
:   (5)

Published:
:   17 April 2025, 08:43
:   [CorrelationCoefficient.mq5](/en/code/download/49182/correlationcoefficient.mq5 "CorrelationCoefficient.mq5")
    (5.79 KB)
    [view](# "view")

    [Download as ZIP](/en/code/download/49182.zip "Download all attachments in the single ZIP archive") [How to download code from MetaEditor](https://www.metatrader5.com/en/metaeditor/help/workspace/toolbox#codebase)

    ![MQL5 - Language of trade strategies built-in the MetaTrader 5 client terminal](https://c.mql5.com/i/registerlandings/logo-2.png)

    You are missing trading opportunities:

    * Free trading apps
    * Over 8,000 signals for copying
    * Economic news for exploring financial markets

    Registration
    Log in

    latin characters without spaces

    a password will be sent to this email

    An error occurred

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup&amp;reg=1)

    You agree to [website policy](/en/about/privacy) and [terms of use](/en/about/terms)

    If you do not have an account, please [register](https://www.mql5.com/en/auth_register)

    Allow the use of cookies to log in to the MQL5.com website.

    Please enable the necessary setting in your browser, otherwise you will not be able to log in.

     

    [Forgot your login/password?](https://www.mql5.com/en/auth_forgotten?return=popup)

    * [Log in With Google](https://www.mql5.com/en/auth_oauth2?provider=Google&amp;return=popup)
:   ![MQL5 Freelance](https://c.mql5.com/i/code/icon_freelance.svg)
    Need a robot or indicator based on this code? Order it on Freelance
    [Go to Freelance](/en/job/new "Go to Freelance")

The correlation coefficient (CC) is used in statistics to measure the correlation between two sets of data. In the world of trading, data sets can be any financial instrument. Simply put, the correlation between two financial instruments is the degree to which they are related. Correlation is based on a scale of 1 to -1. The closer the correlation coefficient is to 1, the higher the positive correlation between the two instruments, which will move up and down at the same time. The closer the correlation is to -1, the stronger the instruments move in opposite directions. A value of 0 indicates no correlation.  
  
 The indicator values fluctuate between positive and negative correlation, which indicates how synchronously the prices of two instruments move. A correlation coefficient of +1 is a perfect positive correlation and prices are moving in perfect synchronisation. A correlation coefficient of -1 represents a perfect negative correlation, where prices move in exactly opposite directions. Both of these extremes are rare, and the correlation coefficient often fluctuates somewhere between the maximum values. A correlation coefficient of 0 is the midpoint indicating that there is no correlation between two instruments.

> The correlation coefficient between EURUSD and USDCAD:

![](https://c.mql5.com/18/161/terminal64_JO1zRxei64.png)

> USDCAD chart overlaid on the EURUSD chart and their correlation coefficient:

![](https://c.mql5.com/18/161/terminal64_odm4RYG2vt.png)

Unlike many technical analysis indicators, the correlation coefficient is ideal for long-term investing. If an investor is going to build a truly diversified portfolio, the correlation coefficient can be very useful. It can help determine how much the assets in the portfolio differ from each other. In other words, by having instruments with low correlation, unnecessary duplicated risk can be avoided.

The indicator has three customisable parameters:

* **Symbol** - indicates the symbol name of the second instrument. The first symbol is the symbol on which the indicator is launched;
* **Source** - source of prices. It defines at what prices the correlation of two instruments will be calculated;
* **Length** - calculation period. It indicates the number of bars for which the correlation coefficient will be calculated.

As mentioned earlier, the correlation coefficient can be a useful tool when compiling a diverse portfolio. However, one thing to always keep in mind is that the correlation between two instruments can and does change from time to time. This indicator will help a trader to be aware of such changes and modify their investments accordingly.

Translated from Russian by MetaQuotes Ltd.   
Original code: [https://www.mql5.com/ru/code/49182](/ru/code/49182)

**Last comments |
[Go to discussion](/en/forum/485014)**
(5)

![fxsaber](https://c.mql5.com/avatar/2019/8/5D67260D-44C9.png "fxsaber")

**[fxsaber](/en/users/fxsaber)**
|
12 Apr 2024 at 12:00

```mql5
//--- correlation coefficient calculation
   double array_a[];
   double array_b[];
   vector a;
   vector b;

   for(int i=limit; i>=0; i--)
     {
      int count=ExtPeriod;
      if(limit>1 && i+count>limit)
         count=limit-i+1;

      if(ArrayCopy(array_a,ExtBufferMA1,0,i,count)!=count || ArrayCopy(array_b,ExtBufferMA2,0,i,count)!=count)
         continue;
      a.Swap(array_a);
      b.Swap(array_b);
      ExtBufferCorrelation[i]=a.CorrCoef(b);
     }
```

It's very expensive.

![Artyom Trishkin](https://c.mql5.com/avatar/2022/7/62C4775C-ABD6.jpg "Artyom Trishkin")

**[Artyom Trishkin](/en/users/artmedia70)**
|
12 Apr 2024 at 12:28

**fxsaber [#](/ru/forum/465537#comment_53032704):**  
 It's very expensive.

I guess. The goal was not to make a rocket. The goal was logical simplicity.

Can you show me your options? Simple and straightforward. I'd be happy to explore.

![fxsaber](https://c.mql5.com/avatar/2019/8/5D67260D-44C9.png "fxsaber")

**[fxsaber](/en/users/fxsaber)**
|
12 Apr 2024 at 12:42

**Artyom Trishkin [#](/ru/forum/465537#comment_53032897):**  

Can you show me your options?

I don't have any. Just seen iterative implementations.

![Artyom Trishkin](https://c.mql5.com/avatar/2022/7/62C4775C-ABD6.jpg "Artyom Trishkin")

**[Artyom Trishkin](/en/users/artmedia70)**
|
12 Apr 2024 at 12:58

**fxsaber [#](/ru/forum/465537#comment_53032962):**  

I don't have any. Just seen iterative implementations.

I see. I didn't bother for the sake of simplicity

![Konstantin Seredkin](https://c.mql5.com/avatar/2017/3/58BD719C-0537.png "Konstantin Seredkin")

**[Konstantin Seredkin](/en/users/tramloyr)**
|
17 Nov 2024 at 03:59

I can't understand what the reason is  
 If you run the indicator on the visual test on the gold futures and compare it with XAUUSD, the indicator line and calculations in the robot are normal.

But if after the test to look at the chart that is displayed according to the results of testing or throw the indicator with the test parameters separately, then these lines are not clear on what criteria make their calculations.

Visual testing

[![](https://c.mql5.com/3/448/2024-11-17_12h54_34__1.png)](https://c.mql5.com/3/448/2024-11-17_12h54_34.png "https://c.mql5.com/3/448/2024-11-17_12h54_34.png")

And this appears after the test, the same thing happens if you add an indicator separately.

[![](https://c.mql5.com/3/448/2024-11-17_12h55_16__1.png)](https://c.mql5.com/3/448/2024-11-17_12h55_16.png "https://c.mql5.com/3/448/2024-11-17_12h55_16.png")

What can be the problem ?

![Chaikin Money Flow](https://c.mql5.com/i/code/indicator.png)
[Chaikin Money Flow](/en/code/49029)

Chaykin Money Flow (CMF)" indicator

![ColorXMA_Ishimoku_StDev - indicator for MetaTrader 5](https://c.mql5.com/i/code/indicator.png)
[ColorXMA\_Ishimoku\_StDev - indicator for MetaTrader 5](/en/code/58257)

The XMA\_Ishimoku indicator with additional trend strength indication using colored dots based on the standard deviation algorithm.
The original code in the attached link had plotting problems.

![Know Sure Thing](https://c.mql5.com/i/code/indicator.png)
[Know Sure Thing](/en/code/49265)

Know Sure Thing (KST) oscillator indicator based on the rate of price change (ROC)

![Net Volume](https://c.mql5.com/i/code/indicator.png)
[Net Volume](/en/code/49334)

The "Net Volume" indicator shows the volume taking into account the pressure of sellers and buyers