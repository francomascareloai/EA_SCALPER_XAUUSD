# Report by Magic and currency MT5 indicator for account PNL and trade statistics exported to CSV - script for MetaTrader 5

Source: https://www.mql5.com/en/code/66158

MetaTrader 5 /
Scripts

* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 5](/en/code/mt5)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt5/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt5/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt5/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt5/libraries)
* [![](https://c.mql5.com/i/sidebar/mt.svg)MetaTrader 4](/en/code/mt4)
  + [![](https://c.mql5.com/i/sidebar/expert.svg)Experts](/en/code/mt4/experts)
  + [![](https://c.mql5.com/i/sidebar/indicator.svg)Indicators](/en/code/mt4/indicators)
  + [![](https://c.mql5.com/i/sidebar/scripts.svg)Scripts](/en/code/mt4/scripts)
  + [![](https://c.mql5.com/i/sidebar/library.svg)Libraries](/en/code/mt4/libraries)

* [![](https://c.mql5.com/i/sidebar/storage.svg)Storage](/en/code/storage)

# Report by Magic and currency MT5 indicator for account PNL and trade statistics exported to CSV - script for MetaTrader 5

[Marco](/en/users/marcopolo777)

852

(3)

**The report groups by magic number and currency, specially useful when testing several EAs or strategies in a single account.**

* **Total P&L** - Including profit, swap, and commission
* **Win Rate %** - Percentage of winning trades
* **Net Position Size** - Current net position from history
* **Current Exposure** - Open position exposure
* **Gross Profit/Loss** - Separate win/loss totals
* **Profit Factor** - Risk/reward metric
* **Total Volume** - Cumulative lot size

* Automatically includes ALL magic numbers (including 0)
* Aggregates all symbols per magic number
* Shows combined symbol list in the Symbol column for each magic
* Exports everything to a single TradingStats.csv file

Just drag and drop on any chart - no inputs required, the report will be saved to **MQL5/Files/**folder

```mql5
=== STATISTICS BY MAGIC NUMBER ===
Magic Number | Symbol(s) | Total P&L | Total Trades | Win Rate % | ...
0 (Manual)   | EURUSD+GBPUSD | 1234.56 | 45 | 60.00 | ...
12345        | USDJPY | 567.89 | 30 | 55.00 | ...

=== STATISTICS BY CURRENCY ===
Currency | Total P&L | Total Trades | Win Rate % | ...
EUR      | 2345.67   | 89          | 58.43      | ...
GBP      | 1234.56   | 56          | 62.50      | ...
```

[![](https://c.mql5.com/18/171/csv__2.jpg)](https://c.mql5.com/18/171/csv__1.jpg "https://c.mql5.com/18/171/csv__1.jpg")

Shaun Van Wyk:

Hi bro very good work thank you very much. Will it be possible to include dates also. That would be wonderfull

[Read more comments and leave your own ones >>](/en/forum/500244)