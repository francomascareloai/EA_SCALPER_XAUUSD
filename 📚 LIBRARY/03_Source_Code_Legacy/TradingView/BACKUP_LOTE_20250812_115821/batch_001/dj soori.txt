//@version=4
study(title="EMA-WMA ADX Trading Strategy with RSI Reversals", shorttitle="DJ Soori", overlay=true)

// Inputs for EMA-WMA ADX Trading Strategy
emaLength = input(9, title="EMA Length")
wmaLength = input(30, title="WMA Length")
adxLength = input(14, title="ADX Length")
adxThreshold = input(20, title="ADX Threshold")

// Calculate EMA and WMA
emaValue = ema(close, emaLength)
wmaValue = wma(close, wmaLength)

// Calculate +DM and -DM
upMove = change(high)
downMove = -change(low)
plusDM = na(upMove) ? na : (upMove > downMove and upMove > 0 ? upMove : 0)
minusDM = na(downMove) ? na : (downMove > upMove and downMove > 0 ? downMove : 0)

// Calculate True Range (TR)
trValue = rma(tr(true), 14)

// Calculate +DI and -DI
plusDI = rma(100 * plusDM / trValue, 14)
minusDI = rma(100 * minusDM / trValue, 14)

// Calculate ADX
dx = 100 * rma(abs(plusDI - minusDI) / (plusDI + minusDI), adxLength)
adxValue = rma(dx, adxLength)

// Determine buy and sell signals for EMA-WMA ADX Strategy
buySignalStrong = crossover(emaValue, wmaValue) and adxValue > adxThreshold and rising(adxValue, 1) 
buySignalWeak = crossover(emaValue, wmaValue) and adxValue > adxThreshold and falling(adxValue, 1) 
sellSignalStrong = crossunder(emaValue, wmaValue) and adxValue > adxThreshold and rising(adxValue, 1) 
sellSignalWeak = crossunder(emaValue, wmaValue) and adxValue > adxThreshold and falling(adxValue, 1) 

// Inputs for RSI Reversals
rsiLength = input(14, minval=1, title="RSI Length")
bullishLevel = input(30, minval=0, title="Bullish Level")
bearishLevel = input(70, minval=0, title="Bearish Level")
rsiSlopePeriods = input(3, minval=1, title="RSI Slope Periods")

// Calculate RSI
rsiValue = rsi(close, rsiLength)

// Calculate RSI Slope
rsiSlope = rsiValue - rsiValue[rsiSlopePeriods]

// Determine bullish and bearish reversals for RSI
bullishReversalConfirmed = crossover(rsiValue, bullishLevel) and rsiSlope > 0
bearishReversalConfirmed = crossunder(rsiValue, bearishLevel) and rsiSlope < 0

// Plotting the EMA and WMA
plot(emaValue, color=color.blue, title="EMA")
plot(wmaValue, color=color.red, title="WMA")

// Displaying buy and sell signals for EMA-WMA ADX Strategy
plotshape(buySignalStrong, title="Buy Signal (Strong)", location=location.belowbar, color=color.green, style=shape.labelup, text="Buy (Strong)", offset=-1, textcolor=color.black)
plotshape(buySignalWeak, title="Buy Signal (Weak)", location=location.belowbar, color=color.green, style=shape.labelup, text="Buy (Weak)", offset=-1, textcolor=color.black)
plotshape(sellSignalStrong, title="Sell Signal (Strong)", location=location.abovebar, color=color.red, style=shape.labeldown, text="Sell (Strong)", offset=-1, textcolor=color.black)
plotshape(sellSignalWeak, title="Sell Signal (Weak)", location=location.abovebar, color=color.red, style=shape.labeldown, text="Sell (Weak)", offset=-1, textcolor=color.black)

// Displaying bullish and bearish reversals for RSI
plotshape(bullishReversalConfirmed, title="Bullish Reversal", location=location.belowbar, text="Reversal", offset=-1, textcolor=color.rgb(86, 243, 75))
plotshape(bearishReversalConfirmed, title="Bearish Reversal", location=location.abovebar, text="Reversal", offset=-1, textcolor=color.rgb(244, 73, 73))