//@version=5
indicator("Example Exit Alert", overlay=true)

// Input parameters
takeProfitPerc = input.float(1.0, "Take Profit %", minval=0.1, maxval=10.0)
stopLossPerc = input.float(0.5, "Stop Loss %", minval=0.1, maxval=5.0)

// Track entry prices
var float longEntryPrice = na
var float shortEntryPrice = na

// Simulate entry conditions (in real scenario, these would come from strategy)
if (ta.crossover(close, ta.ema(close, 20)))
    longEntryPrice := close
    
if (ta.crossunder(close, ta.ema(close, 20)))
    shortEntryPrice := close

// Calculate take profit and stop loss levels
longTakeProfit = longEntryPrice * (1 + takeProfitPerc / 100)
longStopLoss = longEntryPrice * (1 - stopLossPerc / 100)
shortTakeProfit = shortEntryPrice * (1 - takeProfitPerc / 100)
shortStopLoss = shortEntryPrice * (1 + stopLossPerc / 100)

// Exit conditions
longTakeProfitHit = not na(longEntryPrice) and high >= longTakeProfit
longStopLossHit = not na(longEntryPrice) and low <= longStopLoss
shortTakeProfitHit = not na(shortEntryPrice) and low <= shortTakeProfit
shortStopLossHit = not na(shortEntryPrice) and high >= shortStopLoss

// Reset entry prices after exit
if (longTakeProfitHit or longStopLossHit)
    longEntryPrice := na
    
if (shortTakeProfitHit or shortStopLossHit)
    shortEntryPrice := na

// Plot exit signals
plotshape(longTakeProfitHit, "Long Take Profit", shape.square, location.abovebar, color.green, size=size.small)
plotshape(longStopLossHit, "Long Stop Loss", shape.square, location.belowbar, color.red, size=size.small)
plotshape(shortTakeProfitHit, "Short Take Profit", shape.square, location.belowbar, color.green, size=size.small)
plotshape(shortStopLossHit, "Short Stop Loss", shape.square, location.abovebar, color.red, size=size.small)

// Alert conditions
alertcondition(longTakeProfitHit, "Long Take Profit Hit", "Long position take profit target reached")
alertcondition(longStopLossHit, "Long Stop Loss Hit", "Long position stop loss triggered")
alertcondition(shortTakeProfitHit, "Short Take Profit Hit", "Short position take profit target reached")
alertcondition(shortStopLossHit, "Short Stop Loss Hit", "Short position stop loss triggered")